0: Evaluating the following times: (2099,)
0: Running global_forecast for 2015-02-08 21:00 ...
0: Wandb run: atmorep-1yg8r1kf-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 1yg8r1kf
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 8, 21]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.318, max = -0.221, mean = -0.822
0:          sample (first 20): tensor([-0.4969, -0.5443, -0.5460, -0.5846, -0.5410, -0.5558, -0.6022, -0.5875, -0.5628, -0.5485, -0.5557, -0.6291,
0:         -0.5304, -0.5486, -0.6107, -0.5781, -0.6347, -0.5964, -0.6297, -0.6612])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008715467411093414
0: validation loss for velocity_v : 0.0003568206448107958
0: validation loss for specific_humidity : 1.3055839190201368e-05
0: validation loss for velocity_z : 0.0012804362922906876
0: validation loss for temperature : 45257.30078125
0: validation loss for total_precip : 0.00023324420908465981
0: validation loss for t2m : 81134.96875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 381.05 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_000848-1yg8r1kf[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_000848-1yg8r1kf/logs[0m
0: Running global_forecast for 2015-02-08 22:00 ...
0: Wandb run: atmorep-okp52439-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : okp52439
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 8, 22]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.333, max = -0.221, mean = -0.824
0:          sample (first 20): tensor([-0.4972, -0.5443, -0.5466, -0.5844, -0.5412, -0.5557, -0.6028, -0.5872, -0.5630, -0.5490, -0.5560, -0.6295,
0:         -0.5311, -0.5490, -0.6110, -0.5780, -0.6349, -0.5967, -0.6296, -0.6615])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008159377612173557
0: validation loss for velocity_v : 0.0003619425115175545
0: validation loss for specific_humidity : 1.3044582374277525e-05
0: validation loss for velocity_z : 0.0012625899398699403
0: validation loss for temperature : 45251.65625
0: validation loss for total_precip : 0.00022821589664090425
0: validation loss for t2m : 81134.9375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 383.54 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_001520-okp52439[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_001520-okp52439/logs[0m
0: Running global_forecast for 2015-02-08 23:00 ...
0: Wandb run: atmorep-cbt5ovx4-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : cbt5ovx4
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 8, 23]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.342, max = -0.220, mean = -0.826
0:          sample (first 20): tensor([-0.4975, -0.5446, -0.5473, -0.5853, -0.5414, -0.5563, -0.6036, -0.5873, -0.5636, -0.5496, -0.5563, -0.6302,
0:         -0.5316, -0.5493, -0.6114, -0.5785, -0.6355, -0.5976, -0.6301, -0.6621])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007667617755942047
0: validation loss for velocity_v : 0.00036739272763952613
0: validation loss for specific_humidity : 1.3040969861322083e-05
0: validation loss for velocity_z : 0.0012452681548893452
0: validation loss for temperature : 45246.0859375
0: validation loss for total_precip : 0.00022326390899252146
0: validation loss for t2m : 81134.875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 356.15 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_002158-cbt5ovx4[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_002158-cbt5ovx4/logs[0m
0: Running global_forecast for 2015-02-09 00:00 ...
0: Wandb run: atmorep-0l1609w8-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 0l1609w8
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 0]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.081, max = -0.225, mean = -0.783
0:          sample (first 20): tensor([-0.4919, -0.5359, -0.5392, -0.5789, -0.5349, -0.5504, -0.5937, -0.5798, -0.5570, -0.5403, -0.5489, -0.6221,
0:         -0.5226, -0.5422, -0.6045, -0.5706, -0.6266, -0.5871, -0.6219, -0.6540])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0015983552439138293
0: validation loss for velocity_v : 0.00035722702159546316
0: validation loss for specific_humidity : 1.264625370822614e-05
0: validation loss for velocity_z : 0.0015094925183802843
0: validation loss for temperature : 45341.24609375
0: validation loss for total_precip : 0.00026647199410945177
0: validation loss for t2m : 81136.0859375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 376.12 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_002807-0l1609w8[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_002807-0l1609w8/logs[0m
0: Running global_forecast for 2015-02-09 01:00 ...
0: Wandb run: atmorep-tu8woiv8-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : tu8woiv8
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 1]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.094, max = -0.224, mean = -0.785
0:          sample (first 20): tensor([-0.4919, -0.5361, -0.5397, -0.5790, -0.5352, -0.5506, -0.5946, -0.5800, -0.5575, -0.5408, -0.5490, -0.6224,
0:         -0.5235, -0.5424, -0.6046, -0.5708, -0.6272, -0.5875, -0.6220, -0.6543])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0014965110458433628
0: validation loss for velocity_v : 0.0003618218470364809
0: validation loss for specific_humidity : 1.2577884263009764e-05
0: validation loss for velocity_z : 0.0014888352015987039
0: validation loss for temperature : 45333.90625
0: validation loss for total_precip : 0.00026046723360195756
0: validation loss for t2m : 81136.0390625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 363.67 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_003435-tu8woiv8[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_003435-tu8woiv8/logs[0m
0: Running global_forecast for 2015-02-09 02:00 ...
0: Wandb run: atmorep-pf3cwn81-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : pf3cwn81
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 2]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.104, max = -0.223, mean = -0.787
0:          sample (first 20): tensor([-0.4923, -0.5360, -0.5406, -0.5796, -0.5355, -0.5508, -0.5952, -0.5799, -0.5577, -0.5412, -0.5491, -0.6227,
0:         -0.5241, -0.5428, -0.6052, -0.5712, -0.6278, -0.5879, -0.6222, -0.6548])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0014009529259055853
0: validation loss for velocity_v : 0.00036677284515462816
0: validation loss for specific_humidity : 1.2525948477559723e-05
0: validation loss for velocity_z : 0.001468223868869245
0: validation loss for temperature : 45326.9375
0: validation loss for total_precip : 0.00025445097708143294
0: validation loss for t2m : 81135.984375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 361.73 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_004045-pf3cwn81[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_004045-pf3cwn81/logs[0m
0: Running global_forecast for 2015-02-09 03:00 ...
0: Wandb run: atmorep-28yk1a2g-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 28yk1a2g
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 3]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.113, max = -0.223, mean = -0.789
0:          sample (first 20): tensor([-0.4930, -0.5379, -0.5408, -0.5803, -0.5363, -0.5519, -0.5955, -0.5813, -0.5584, -0.5421, -0.5505, -0.6241,
0:         -0.5247, -0.5438, -0.6063, -0.5723, -0.6291, -0.5896, -0.6239, -0.6559])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008215482230298221
0: validation loss for velocity_v : 0.0003585099766496569
0: validation loss for specific_humidity : 1.3109191968396772e-05
0: validation loss for velocity_z : 0.001359004294499755
0: validation loss for temperature : 45325.4296875
0: validation loss for total_precip : 0.00022601430828217417
0: validation loss for t2m : 81135.9453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 271.20 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_004658-28yk1a2g[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_004658-28yk1a2g/logs[0m
0: Running global_forecast for 2015-02-09 04:00 ...
0: Wandb run: atmorep-5efyxkvi-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 5efyxkvi
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 4]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.133, max = -0.224, mean = -0.791
0:          sample (first 20): tensor([-0.4926, -0.5372, -0.5404, -0.5798, -0.5357, -0.5510, -0.5955, -0.5808, -0.5575, -0.5419, -0.5498, -0.6234,
0:         -0.5242, -0.5434, -0.6058, -0.5718, -0.6287, -0.5890, -0.6230, -0.6553])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007728991331532598
0: validation loss for velocity_v : 0.00036401310353539884
0: validation loss for specific_humidity : 1.306140620727092e-05
0: validation loss for velocity_z : 0.0013405537465587258
0: validation loss for temperature : 45318.46875
0: validation loss for total_precip : 0.00022090342827141285
0: validation loss for t2m : 81135.90625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 352.57 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_005137-5efyxkvi[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_005137-5efyxkvi/logs[0m
0: Running global_forecast for 2015-02-09 05:00 ...
0: Wandb run: atmorep-uhy7k9io-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : uhy7k9io
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 5]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.138, max = -0.223, mean = -0.792
0:          sample (first 20): tensor([-0.4938, -0.5382, -0.5423, -0.5807, -0.5368, -0.5522, -0.5970, -0.5817, -0.5592, -0.5430, -0.5509, -0.6248,
0:         -0.5257, -0.5447, -0.6070, -0.5726, -0.6300, -0.5901, -0.6244, -0.6571])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007290189969353378
0: validation loss for velocity_v : 0.00036970648216083646
0: validation loss for specific_humidity : 1.3024328836763743e-05
0: validation loss for velocity_z : 0.0013225387083366513
0: validation loss for temperature : 45311.6796875
0: validation loss for total_precip : 0.0002159120631404221
0: validation loss for t2m : 81135.859375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 364.17 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_005737-uhy7k9io[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_005737-uhy7k9io/logs[0m
0: Running global_forecast for 2015-02-09 06:00 ...
0: Wandb run: atmorep-1k78uw9r-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 1k78uw9r
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 6]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.157, max = -0.223, mean = -0.795
0:          sample (first 20): tensor([-0.4933, -0.5384, -0.5414, -0.5808, -0.5372, -0.5524, -0.5962, -0.5824, -0.5590, -0.5430, -0.5516, -0.6247,
0:         -0.5253, -0.5448, -0.6069, -0.5729, -0.6298, -0.5906, -0.6247, -0.6568])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000789691461250186
0: validation loss for velocity_v : 0.00035496774944476783
0: validation loss for specific_humidity : 1.3083191333862487e-05
0: validation loss for velocity_z : 0.0013425603974610567
0: validation loss for temperature : 45313.1328125
0: validation loss for total_precip : 0.00022907392121851444
0: validation loss for t2m : 81135.8125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 382.93 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_010348-1k78uw9r[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_010348-1k78uw9r/logs[0m
0: Running global_forecast for 2015-02-09 07:00 ...
0: Wandb run: atmorep-jhqixaz4-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : jhqixaz4
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 7]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.169, max = -0.223, mean = -0.797
0:          sample (first 20): tensor([-0.4940, -0.5394, -0.5422, -0.5811, -0.5378, -0.5531, -0.5973, -0.5833, -0.5595, -0.5438, -0.5519, -0.6256,
0:         -0.5265, -0.5457, -0.6076, -0.5738, -0.6307, -0.5913, -0.6253, -0.6576])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007428317912854254
0: validation loss for velocity_v : 0.00036059581907466054
0: validation loss for specific_humidity : 1.302679993386846e-05
0: validation loss for velocity_z : 0.0013244375586509705
0: validation loss for temperature : 45306.52734375
0: validation loss for total_precip : 0.00022397912107408047
0: validation loss for t2m : 81135.765625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 359.67 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_011026-jhqixaz4[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_011026-jhqixaz4/logs[0m
0: Running global_forecast for 2015-02-09 08:00 ...
0: Wandb run: atmorep-pik9dxfe-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : pik9dxfe
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 8]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.175, max = -0.222, mean = -0.799
0:          sample (first 20): tensor([-0.4950, -0.5399, -0.5434, -0.5820, -0.5381, -0.5535, -0.5986, -0.5835, -0.5603, -0.5448, -0.5527, -0.6262,
0:         -0.5274, -0.5462, -0.6084, -0.5742, -0.6317, -0.5920, -0.6260, -0.6581])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007008903194218874
0: validation loss for velocity_v : 0.0003666045668069273
0: validation loss for specific_humidity : 1.2996263649256434e-05
0: validation loss for velocity_z : 0.0013062353245913982
0: validation loss for temperature : 45299.89453125
0: validation loss for total_precip : 0.00021898829436395317
0: validation loss for t2m : 81135.7265625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 367.79 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_011637-pik9dxfe[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_011637-pik9dxfe/logs[0m
0: Running global_forecast for 2015-02-09 09:00 ...
0: Wandb run: atmorep-mdmp3f42-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : mdmp3f42
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 9]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.186, max = -0.223, mean = -0.801
0:          sample (first 20): tensor([-0.4954, -0.5407, -0.5432, -0.5827, -0.5392, -0.5541, -0.5986, -0.5846, -0.5610, -0.5452, -0.5535, -0.6268,
0:         -0.5276, -0.5465, -0.6089, -0.5753, -0.6320, -0.5932, -0.6269, -0.6591])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008493934874422848
0: validation loss for velocity_v : 0.0003487516369204968
0: validation loss for specific_humidity : 1.2920027074869722e-05
0: validation loss for velocity_z : 0.0013203847920522094
0: validation loss for temperature : 45300.6171875
0: validation loss for total_precip : 0.00023463628895115107
0: validation loss for t2m : 81135.65625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 383.30 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_012257-mdmp3f42[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_012257-mdmp3f42/logs[0m
0: Running global_forecast for 2015-02-09 10:00 ...
0: Wandb run: atmorep-nlcaznbn-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : nlcaznbn
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 10]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.198, max = -0.222, mean = -0.802
0:          sample (first 20): tensor([-0.4943, -0.5397, -0.5426, -0.5816, -0.5380, -0.5529, -0.5981, -0.5833, -0.5600, -0.5442, -0.5524, -0.6259,
0:         -0.5268, -0.5457, -0.6077, -0.5739, -0.6312, -0.5924, -0.6256, -0.6580])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000797742570284754
0: validation loss for velocity_v : 0.0003539210883900523
0: validation loss for specific_humidity : 1.2866278666479047e-05
0: validation loss for velocity_z : 0.001302381046116352
0: validation loss for temperature : 45294.22265625
0: validation loss for total_precip : 0.00022964389063417912
0: validation loss for t2m : 81135.6328125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 372.04 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_012931-nlcaznbn[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_012931-nlcaznbn/logs[0m
0: Running global_forecast for 2015-02-09 11:00 ...
0: Wandb run: atmorep-mrmrghf2-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : mrmrghf2
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 11]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.210, max = -0.222, mean = -0.804
0:          sample (first 20): tensor([-0.4950, -0.5403, -0.5435, -0.5822, -0.5384, -0.5535, -0.5991, -0.5838, -0.5604, -0.5452, -0.5528, -0.6264,
0:         -0.5277, -0.5461, -0.6085, -0.5747, -0.6317, -0.5928, -0.6260, -0.6587])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000751973653677851
0: validation loss for velocity_v : 0.0003594306472223252
0: validation loss for specific_humidity : 1.2822050848626532e-05
0: validation loss for velocity_z : 0.0012843175791203976
0: validation loss for temperature : 45287.96875
0: validation loss for total_precip : 0.00022468333190772682
0: validation loss for t2m : 81135.546875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 284.12 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_013555-mrmrghf2[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_013555-mrmrghf2/logs[0m
0: Running global_forecast for 2015-02-09 12:00 ...
0: Wandb run: atmorep-x9gnedti-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : x9gnedti
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 12]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.212, max = -0.222, mean = -0.804
0:          sample (first 20): tensor([-0.4947, -0.5406, -0.5424, -0.5825, -0.5385, -0.5537, -0.5984, -0.5843, -0.5604, -0.5451, -0.5533, -0.6264,
0:         -0.5272, -0.5458, -0.6081, -0.5750, -0.6313, -0.5928, -0.6266, -0.6581])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0016718023689463735
0: validation loss for velocity_v : 0.00035627532633952796
0: validation loss for specific_humidity : 1.2470885849324986e-05
0: validation loss for velocity_z : 0.001333903637714684
0: validation loss for temperature : 45292.0859375
0: validation loss for total_precip : 0.0002376911579631269
0: validation loss for t2m : 81135.40625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 357.45 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_014051-x9gnedti[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_014051-x9gnedti/logs[0m
0: Running global_forecast for 2015-02-09 13:00 ...
0: Wandb run: atmorep-fu5jm6ep-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : fu5jm6ep
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 13]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.224, max = -0.222, mean = -0.806
0:          sample (first 20): tensor([-0.4955, -0.5411, -0.5435, -0.5827, -0.5389, -0.5541, -0.5994, -0.5848, -0.5611, -0.5460, -0.5534, -0.6267,
0:         -0.5280, -0.5466, -0.6089, -0.5755, -0.6320, -0.5934, -0.6272, -0.6588])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0015614436706528068
0: validation loss for velocity_v : 0.00036074547097086906
0: validation loss for specific_humidity : 1.248547687282553e-05
0: validation loss for velocity_z : 0.0013166585704311728
0: validation loss for temperature : 45285.90625
0: validation loss for total_precip : 0.00023253423569258302
0: validation loss for t2m : 81135.375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 344.79 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_014655-fu5jm6ep[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_014655-fu5jm6ep/logs[0m
0: Running global_forecast for 2015-02-09 14:00 ...
0: Wandb run: atmorep-ukz7gtg1-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : ukz7gtg1
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 14]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.237, max = -0.221, mean = -0.808
0:          sample (first 20): tensor([-0.4953, -0.5411, -0.5439, -0.5825, -0.5389, -0.5541, -0.6001, -0.5847, -0.5610, -0.5462, -0.5533, -0.6270,
0:         -0.5283, -0.5466, -0.6091, -0.5755, -0.6322, -0.5933, -0.6269, -0.6587])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.001458274433389306
0: validation loss for velocity_v : 0.00036547024501487613
0: validation loss for specific_humidity : 1.251243975275429e-05
0: validation loss for velocity_z : 0.0012995596043765545
0: validation loss for temperature : 45279.75
0: validation loss for total_precip : 0.00022740660642739385
0: validation loss for t2m : 81135.328125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 358.68 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_015246-ukz7gtg1[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_015246-ukz7gtg1/logs[0m
0: Running global_forecast for 2015-02-09 15:00 ...
0: Wandb run: atmorep-u0yxzgrq-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : u0yxzgrq
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 15]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.245, max = -0.222, mean = -0.810
0:          sample (first 20): tensor([-0.4957, -0.5420, -0.5442, -0.5832, -0.5398, -0.5546, -0.5999, -0.5853, -0.5619, -0.5468, -0.5540, -0.6275,
0:         -0.5286, -0.5470, -0.6094, -0.5761, -0.6328, -0.5948, -0.6275, -0.6595])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008892231271602213
0: validation loss for velocity_v : 0.0003587257524486631
0: validation loss for specific_humidity : 1.3187697732064407e-05
0: validation loss for velocity_z : 0.0013072896981611848
0: validation loss for temperature : 45278.9609375
0: validation loss for total_precip : 0.00023013877216726542
0: validation loss for t2m : 81135.2578125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 376.10 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_015858-u0yxzgrq[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_015858-u0yxzgrq/logs[0m
0: Running global_forecast for 2015-02-09 16:00 ...
0: Wandb run: atmorep-42r7h2rh-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 42r7h2rh
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 16]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.254, max = -0.221, mean = -0.811
0:          sample (first 20): tensor([-0.4963, -0.5429, -0.5451, -0.5838, -0.5403, -0.5553, -0.6012, -0.5858, -0.5620, -0.5473, -0.5548, -0.6283,
0:         -0.5296, -0.5476, -0.6103, -0.5767, -0.6335, -0.5955, -0.6280, -0.6602])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008332610595971346
0: validation loss for velocity_v : 0.00036375573836266994
0: validation loss for specific_humidity : 1.3155571650713682e-05
0: validation loss for velocity_z : 0.001289934734813869
0: validation loss for temperature : 45272.87890625
0: validation loss for total_precip : 0.00022519350750371814
0: validation loss for t2m : 81135.2265625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 369.94 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_020534-42r7h2rh[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_020534-42r7h2rh/logs[0m
0: Running global_forecast for 2015-02-09 17:00 ...
0: Wandb run: atmorep-m0l5tnzc-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : m0l5tnzc
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 17]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.264, max = -0.222, mean = -0.813
0:          sample (first 20): tensor([-0.4969, -0.5430, -0.5458, -0.5840, -0.5405, -0.5556, -0.6021, -0.5861, -0.5628, -0.5480, -0.5549, -0.6287,
0:         -0.5300, -0.5480, -0.6107, -0.5769, -0.6340, -0.5955, -0.6283, -0.6606])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007834178395569324
0: validation loss for velocity_v : 0.0003690820303745568
0: validation loss for specific_humidity : 1.3120267794874962e-05
0: validation loss for velocity_z : 0.0012726353015750647
0: validation loss for temperature : 45266.93359375
0: validation loss for total_precip : 0.00022027369413990527
0: validation loss for t2m : 81135.1796875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 363.65 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_021151-m0l5tnzc[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_021151-m0l5tnzc/logs[0m
0: Running global_forecast for 2015-02-09 18:00 ...
0: Wandb run: atmorep-e0u7cjn9-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : e0u7cjn9
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 18]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.280, max = -0.222, mean = -0.815
0:          sample (first 20): tensor([-0.4968, -0.5439, -0.5456, -0.5844, -0.5411, -0.5557, -0.6018, -0.5870, -0.5630, -0.5480, -0.5557, -0.6290,
0:         -0.5302, -0.5487, -0.6109, -0.5780, -0.6345, -0.5964, -0.6293, -0.6610])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008461251272819936
0: validation loss for velocity_v : 0.00035857479088008404
0: validation loss for specific_humidity : 1.3154326552466955e-05
0: validation loss for velocity_z : 0.0012882862938567996
0: validation loss for temperature : 45268.0703125
0: validation loss for total_precip : 0.0002325185196241364
0: validation loss for t2m : 81135.140625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 356.16 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_021801-e0u7cjn9[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_021801-e0u7cjn9/logs[0m
0: Running global_forecast for 2015-02-09 19:00 ...
0: Wandb run: atmorep-wx8qfhpt-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : wx8qfhpt
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 19]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.291, max = -0.221, mean = -0.818
0:          sample (first 20): tensor([-0.4972, -0.5442, -0.5462, -0.5845, -0.5410, -0.5560, -0.6024, -0.5870, -0.5632, -0.5485, -0.5557, -0.6292,
0:         -0.5308, -0.5487, -0.6109, -0.5780, -0.6346, -0.5964, -0.6293, -0.6611])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000792193110100925
0: validation loss for velocity_v : 0.00036390821333043277
0: validation loss for specific_humidity : 1.3138279427948873e-05
0: validation loss for velocity_z : 0.001270799431949854
0: validation loss for temperature : 45262.15625
0: validation loss for total_precip : 0.0002274128928547725
0: validation loss for t2m : 81135.1015625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 266.26 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_022405-wx8qfhpt[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_022405-wx8qfhpt/logs[0m
0: Running global_forecast for 2015-02-09 20:00 ...
0: Wandb run: atmorep-ofv8uu59-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : ofv8uu59
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 20]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.305, max = -0.220, mean = -0.820
0:          sample (first 20): tensor([-0.4982, -0.5447, -0.5475, -0.5854, -0.5420, -0.5568, -0.6039, -0.5880, -0.5639, -0.5496, -0.5567, -0.6306,
0:         -0.5319, -0.5500, -0.6119, -0.5790, -0.6360, -0.5976, -0.6302, -0.6622])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007438901229761541
0: validation loss for velocity_v : 0.00036946978070773184
0: validation loss for specific_humidity : 1.3124625183991157e-05
0: validation loss for velocity_z : 0.0012533755507320166
0: validation loss for temperature : 45256.296875
0: validation loss for total_precip : 0.00022242106206249446
0: validation loss for t2m : 81135.03125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 350.63 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_022842-ofv8uu59[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_022842-ofv8uu59/logs[0m
0: Running global_forecast for 2015-02-09 21:00 ...
0: Wandb run: atmorep-9kgg879x-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 9kgg879x
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 21]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.321, max = -0.221, mean = -0.822
0:          sample (first 20): tensor([-0.4977, -0.5452, -0.5469, -0.5854, -0.5420, -0.5566, -0.6032, -0.5883, -0.5637, -0.5492, -0.5566, -0.6303,
0:         -0.5314, -0.5494, -0.6117, -0.5789, -0.6357, -0.5975, -0.6307, -0.6620])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008716323063708842
0: validation loss for velocity_v : 0.00035681636654771864
0: validation loss for specific_humidity : 1.3054620467300992e-05
0: validation loss for velocity_z : 0.0012801468838006258
0: validation loss for temperature : 45257.25
0: validation loss for total_precip : 0.00023328083625528961
0: validation loss for t2m : 81134.96875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 355.21 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_023443-9kgg879x[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_023443-9kgg879x/logs[0m
0: Running global_forecast for 2015-02-09 22:00 ...
0: Wandb run: atmorep-h8syuuxj-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : h8syuuxj
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 22]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.334, max = -0.221, mean = -0.824
0:          sample (first 20): tensor([-0.4980, -0.5455, -0.5477, -0.5856, -0.5421, -0.5568, -0.6038, -0.5881, -0.5641, -0.5499, -0.5569, -0.6306,
0:         -0.5319, -0.5497, -0.6120, -0.5791, -0.6358, -0.5978, -0.6306, -0.6625])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008159789722412825
0: validation loss for velocity_v : 0.0003619446069933474
0: validation loss for specific_humidity : 1.3042566934018396e-05
0: validation loss for velocity_z : 0.0012625099625438452
0: validation loss for temperature : 45251.6171875
0: validation loss for total_precip : 0.00022825977066531777
0: validation loss for t2m : 81134.921875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 383.70 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_024049-h8syuuxj[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_024049-h8syuuxj/logs[0m
0: Running global_forecast for 2015-02-09 23:00 ...
0: Wandb run: atmorep-t97kobul-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : t97kobul
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 9, 23]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.341, max = -0.221, mean = -0.826
0:          sample (first 20): tensor([-0.4981, -0.5452, -0.5479, -0.5859, -0.5421, -0.5568, -0.6043, -0.5880, -0.5641, -0.5500, -0.5570, -0.6308,
0:         -0.5322, -0.5500, -0.6122, -0.5790, -0.6359, -0.5982, -0.6307, -0.6625])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007667217869311571
0: validation loss for velocity_v : 0.00036736729089170694
0: validation loss for specific_humidity : 1.3041914826317225e-05
0: validation loss for velocity_z : 0.0012450881768018007
0: validation loss for temperature : 45246.0703125
0: validation loss for total_precip : 0.00022325677855405957
0: validation loss for t2m : 81134.875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 377.83 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_024723-t97kobul[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_024723-t97kobul/logs[0m
0: Running global_forecast for 2015-02-10 00:00 ...
0: Wandb run: atmorep-zkx21jaf-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : zkx21jaf
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 0]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.083, max = -0.224, mean = -0.783
0:          sample (first 20): tensor([-0.4924, -0.5363, -0.5396, -0.5791, -0.5355, -0.5508, -0.5941, -0.5803, -0.5576, -0.5408, -0.5493, -0.6226,
0:         -0.5232, -0.5427, -0.6051, -0.5712, -0.6273, -0.5877, -0.6224, -0.6545])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.001598420087248087
0: validation loss for velocity_v : 0.00035720906453207135
0: validation loss for specific_humidity : 1.2646482900890987e-05
0: validation loss for velocity_z : 0.001509372377768159
0: validation loss for temperature : 45341.27734375
0: validation loss for total_precip : 0.0002665052015800029
0: validation loss for t2m : 81136.0859375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 373.74 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_025357-zkx21jaf[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_025357-zkx21jaf/logs[0m
0: Running global_forecast for 2015-02-10 01:00 ...
0: Wandb run: atmorep-n30paa45-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : n30paa45
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 1]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.095, max = -0.224, mean = -0.785
0:          sample (first 20): tensor([-0.4916, -0.5353, -0.5393, -0.5783, -0.5344, -0.5499, -0.5938, -0.5794, -0.5568, -0.5400, -0.5484, -0.6218,
0:         -0.5226, -0.5418, -0.6040, -0.5701, -0.6267, -0.5868, -0.6214, -0.6538])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0014966819435358047
0: validation loss for velocity_v : 0.00036180668394081295
0: validation loss for specific_humidity : 1.2577239431266207e-05
0: validation loss for velocity_z : 0.001488691195845604
0: validation loss for temperature : 45333.9296875
0: validation loss for total_precip : 0.0002604925539344549
0: validation loss for t2m : 81136.0234375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 377.52 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_030022-n30paa45[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_030022-n30paa45/logs[0m
0: Running global_forecast for 2015-02-10 02:00 ...
0: Wandb run: atmorep-ysr7n2hg-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : ysr7n2hg
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 2]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.105, max = -0.223, mean = -0.786
0:          sample (first 20): tensor([-0.4928, -0.5364, -0.5406, -0.5795, -0.5353, -0.5510, -0.5954, -0.5802, -0.5579, -0.5413, -0.5495, -0.6229,
0:         -0.5240, -0.5432, -0.6052, -0.5713, -0.6281, -0.5879, -0.6224, -0.6549])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0014010005397722125
0: validation loss for velocity_v : 0.0003668074496090412
0: validation loss for specific_humidity : 1.2525773854576983e-05
0: validation loss for velocity_z : 0.0014680764870718122
0: validation loss for temperature : 45326.921875
0: validation loss for total_precip : 0.0002545017923694104
0: validation loss for t2m : 81135.9765625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 372.39 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_030646-ysr7n2hg[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_030646-ysr7n2hg/logs[0m
0: Running global_forecast for 2015-02-10 03:00 ...
0: Wandb run: atmorep-yojg253p-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : yojg253p
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 3]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.116, max = -0.224, mean = -0.789
0:          sample (first 20): tensor([-0.4934, -0.5383, -0.5410, -0.5806, -0.5367, -0.5522, -0.5960, -0.5819, -0.5585, -0.5425, -0.5507, -0.6244,
0:         -0.5250, -0.5442, -0.6067, -0.5727, -0.6293, -0.5898, -0.6240, -0.6564])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000821498513687402
0: validation loss for velocity_v : 0.0003584780206438154
0: validation loss for specific_humidity : 1.3109410247125197e-05
0: validation loss for velocity_z : 0.0013589594746008515
0: validation loss for temperature : 45325.37890625
0: validation loss for total_precip : 0.00022605030972044915
0: validation loss for t2m : 81135.9453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 275.11 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_031311-yojg253p[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_031311-yojg253p/logs[0m
0: Running global_forecast for 2015-02-10 04:00 ...
0: Wandb run: atmorep-zhfnh3wl-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : zhfnh3wl
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 4]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.129, max = -0.223, mean = -0.791
0:          sample (first 20): tensor([-0.4927, -0.5372, -0.5406, -0.5797, -0.5357, -0.5512, -0.5953, -0.5809, -0.5578, -0.5418, -0.5496, -0.6237,
0:         -0.5243, -0.5432, -0.6058, -0.5716, -0.6287, -0.5889, -0.6229, -0.6557])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007729159551672637
0: validation loss for velocity_v : 0.0003639877832029015
0: validation loss for specific_humidity : 1.3062105608696584e-05
0: validation loss for velocity_z : 0.001340573886409402
0: validation loss for temperature : 45318.48828125
0: validation loss for total_precip : 0.00022091934806667268
0: validation loss for t2m : 81135.90625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 389.35 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_031758-zhfnh3wl[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_031758-zhfnh3wl/logs[0m
0: Running global_forecast for 2015-02-10 05:00 ...
0: Wandb run: atmorep-938651c7-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 938651c7
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 5]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.141, max = -0.222, mean = -0.793
0:          sample (first 20): tensor([-0.4934, -0.5378, -0.5419, -0.5803, -0.5364, -0.5517, -0.5967, -0.5812, -0.5586, -0.5429, -0.5505, -0.6245,
0:         -0.5253, -0.5442, -0.6064, -0.5725, -0.6297, -0.5897, -0.6240, -0.6567])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007290723151527345
0: validation loss for velocity_v : 0.00036973480018787086
0: validation loss for specific_humidity : 1.3026464330323506e-05
0: validation loss for velocity_z : 0.0013223006390035152
0: validation loss for temperature : 45311.68359375
0: validation loss for total_precip : 0.0002159236028091982
0: validation loss for t2m : 81135.859375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 336.68 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_032434-938651c7[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_032434-938651c7/logs[0m
0: Running global_forecast for 2015-02-10 06:00 ...
0: Wandb run: atmorep-doakwfv2-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : doakwfv2
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 6]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.150, max = -0.222, mean = -0.795
0:          sample (first 20): tensor([-0.4939, -0.5389, -0.5418, -0.5813, -0.5374, -0.5527, -0.5964, -0.5830, -0.5595, -0.5436, -0.5518, -0.6251,
0:         -0.5257, -0.5450, -0.6073, -0.5734, -0.6303, -0.5911, -0.6251, -0.6571])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007896763854660094
0: validation loss for velocity_v : 0.00035501373349688947
0: validation loss for specific_humidity : 1.3082570148981176e-05
0: validation loss for velocity_z : 0.0013424580683931708
0: validation loss for temperature : 45313.16796875
0: validation loss for total_precip : 0.00022907931997906417
0: validation loss for t2m : 81135.828125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 346.29 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_033017-doakwfv2[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_033017-doakwfv2/logs[0m
0: Running global_forecast for 2015-02-10 07:00 ...
0: Wandb run: atmorep-simqiw8l-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : simqiw8l
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 7]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.164, max = -0.223, mean = -0.797
0:          sample (first 20): tensor([-0.4944, -0.5397, -0.5426, -0.5819, -0.5382, -0.5533, -0.5976, -0.5834, -0.5602, -0.5441, -0.5524, -0.6260,
0:         -0.5267, -0.5459, -0.6079, -0.5741, -0.6310, -0.5918, -0.6258, -0.6579])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007428732933476567
0: validation loss for velocity_v : 0.00036062710569240153
0: validation loss for specific_humidity : 1.302828241023235e-05
0: validation loss for velocity_z : 0.0013242881977930665
0: validation loss for temperature : 45306.48828125
0: validation loss for total_precip : 0.0002240240719402209
0: validation loss for t2m : 81135.7734375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 345.24 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_033611-simqiw8l[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_033611-simqiw8l/logs[0m
0: Running global_forecast for 2015-02-10 08:00 ...
0: Wandb run: atmorep-j5hxlpzd-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : j5hxlpzd
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 8]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.174, max = -0.222, mean = -0.798
0:          sample (first 20): tensor([-0.4954, -0.5400, -0.5438, -0.5823, -0.5384, -0.5540, -0.5988, -0.5839, -0.5607, -0.5451, -0.5530, -0.6264,
0:         -0.5276, -0.5465, -0.6087, -0.5745, -0.6321, -0.5925, -0.6264, -0.6585])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007008739048615098
0: validation loss for velocity_v : 0.0003666027041617781
0: validation loss for specific_humidity : 1.2995229553780518e-05
0: validation loss for velocity_z : 0.0013061583740636706
0: validation loss for temperature : 45299.8984375
0: validation loss for total_precip : 0.0002189891238231212
0: validation loss for t2m : 81135.7109375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 359.01 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_034203-j5hxlpzd[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_034203-j5hxlpzd/logs[0m
0: Running global_forecast for 2015-02-10 09:00 ...
0: Wandb run: atmorep-1afxyrvq-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 1afxyrvq
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 9]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.181, max = -0.223, mean = -0.800
0:          sample (first 20): tensor([-0.4946, -0.5401, -0.5425, -0.5821, -0.5386, -0.5535, -0.5981, -0.5841, -0.5603, -0.5446, -0.5528, -0.6261,
0:         -0.5269, -0.5459, -0.6082, -0.5747, -0.6314, -0.5925, -0.6262, -0.6583])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008494130452163517
0: validation loss for velocity_v : 0.0003487548092380166
0: validation loss for specific_humidity : 1.2919855180371087e-05
0: validation loss for velocity_z : 0.0013204957358539104
0: validation loss for temperature : 45300.64453125
0: validation loss for total_precip : 0.00023465613776352257
0: validation loss for t2m : 81135.65625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 355.85 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_034810-1afxyrvq[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_034810-1afxyrvq/logs[0m
0: Running global_forecast for 2015-02-10 10:00 ...
0: Wandb run: atmorep-ax2per7k-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : ax2per7k
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 10]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.194, max = -0.223, mean = -0.802
0:          sample (first 20): tensor([-0.4948, -0.5399, -0.5429, -0.5820, -0.5381, -0.5535, -0.5981, -0.5837, -0.5603, -0.5448, -0.5526, -0.6263,
0:         -0.5270, -0.5458, -0.6081, -0.5743, -0.6314, -0.5927, -0.6259, -0.6582])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007977361092343926
0: validation loss for velocity_v : 0.00035391421988606453
0: validation loss for specific_humidity : 1.2865991266153287e-05
0: validation loss for velocity_z : 0.0013021924532949924
0: validation loss for temperature : 45294.23828125
0: validation loss for total_precip : 0.00022963645460549742
0: validation loss for t2m : 81135.625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 378.57 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_035413-ax2per7k[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_035413-ax2per7k/logs[0m
0: Running global_forecast for 2015-02-10 11:00 ...
0: Wandb run: atmorep-wkftmhb1-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : wkftmhb1
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 11]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.210, max = -0.222, mean = -0.804
0:          sample (first 20): tensor([-0.4947, -0.5400, -0.5432, -0.5819, -0.5384, -0.5536, -0.5985, -0.5837, -0.5601, -0.5450, -0.5527, -0.6260,
0:         -0.5271, -0.5459, -0.6083, -0.5742, -0.6313, -0.5924, -0.6258, -0.6583])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007520401850342751
0: validation loss for velocity_v : 0.0003593987494241446
0: validation loss for specific_humidity : 1.2821508789784275e-05
0: validation loss for velocity_z : 0.0012840237468481064
0: validation loss for temperature : 45287.96484375
0: validation loss for total_precip : 0.00022471716511063278
0: validation loss for t2m : 81135.5390625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 269.27 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_040041-wkftmhb1[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_040041-wkftmhb1/logs[0m
0: Running global_forecast for 2015-02-10 12:00 ...
0: Wandb run: atmorep-ux1ocakb-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : ux1ocakb
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 12]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.211, max = -0.222, mean = -0.804
0:          sample (first 20): tensor([-0.4949, -0.5406, -0.5427, -0.5826, -0.5388, -0.5537, -0.5986, -0.5847, -0.5607, -0.5454, -0.5534, -0.6265,
0:         -0.5276, -0.5460, -0.6085, -0.5752, -0.6315, -0.5931, -0.6268, -0.6584])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0016720369458198547
0: validation loss for velocity_v : 0.00035628702607937157
0: validation loss for specific_humidity : 1.2472562957555056e-05
0: validation loss for velocity_z : 0.001333829597570002
0: validation loss for temperature : 45292.1171875
0: validation loss for total_precip : 0.00023769450490362942
0: validation loss for t2m : 81135.40625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 358.13 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_040518-ux1ocakb[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_040518-ux1ocakb/logs[0m
0: Running global_forecast for 2015-02-10 13:00 ...
0: Wandb run: atmorep-sbuc0l6d-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : sbuc0l6d
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 13]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.221, max = -0.222, mean = -0.806
0:          sample (first 20): tensor([-0.4949, -0.5408, -0.5430, -0.5823, -0.5386, -0.5537, -0.5991, -0.5842, -0.5606, -0.5455, -0.5531, -0.6263,
0:         -0.5274, -0.5461, -0.6085, -0.5751, -0.6318, -0.5930, -0.6266, -0.6585])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.001561516197398305
0: validation loss for velocity_v : 0.00036073863157071173
0: validation loss for specific_humidity : 1.2483475074986927e-05
0: validation loss for velocity_z : 0.001316457986831665
0: validation loss for temperature : 45285.8203125
0: validation loss for total_precip : 0.0002326144021935761
0: validation loss for t2m : 81135.3828125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 360.61 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_041129-sbuc0l6d[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_041129-sbuc0l6d/logs[0m
0: Running global_forecast for 2015-02-10 14:00 ...
0: Wandb run: atmorep-azargge4-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : azargge4
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 14]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.237, max = -0.221, mean = -0.808
0:          sample (first 20): tensor([-0.4957, -0.5415, -0.5443, -0.5831, -0.5392, -0.5544, -0.6002, -0.5849, -0.5612, -0.5466, -0.5538, -0.6274,
0:         -0.5285, -0.5470, -0.6095, -0.5756, -0.6325, -0.5938, -0.6272, -0.6590])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0014582433504983783
0: validation loss for velocity_v : 0.00036546672345139086
0: validation loss for specific_humidity : 1.2510918168118224e-05
0: validation loss for velocity_z : 0.0012996114091947675
0: validation loss for temperature : 45279.703125
0: validation loss for total_precip : 0.00022742374858353287
0: validation loss for t2m : 81135.328125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 351.76 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_041742-azargge4[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_041742-azargge4/logs[0m
0: Running global_forecast for 2015-02-10 15:00 ...
0: Wandb run: atmorep-gex4aztu-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : gex4aztu
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 15]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.243, max = -0.223, mean = -0.809
0:          sample (first 20): tensor([-0.4962, -0.5425, -0.5445, -0.5835, -0.5402, -0.5550, -0.6003, -0.5860, -0.5622, -0.5471, -0.5544, -0.6281,
0:         -0.5292, -0.5475, -0.6100, -0.5765, -0.6333, -0.5954, -0.6282, -0.6599])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008893112535588443
0: validation loss for velocity_v : 0.00035871914587914944
0: validation loss for specific_humidity : 1.318853537668474e-05
0: validation loss for velocity_z : 0.001307266065850854
0: validation loss for temperature : 45278.953125
0: validation loss for total_precip : 0.00023018690990284085
0: validation loss for t2m : 81135.2578125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 359.09 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_042344-gex4aztu[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_042344-gex4aztu/logs[0m
0: Running global_forecast for 2015-02-10 16:00 ...
0: Wandb run: atmorep-h6ivadck-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : h6ivadck
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 16]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.253, max = -0.221, mean = -0.811
0:          sample (first 20): tensor([-0.4955, -0.5419, -0.5442, -0.5828, -0.5394, -0.5543, -0.6004, -0.5850, -0.5613, -0.5463, -0.5539, -0.6273,
0:         -0.5286, -0.5467, -0.6093, -0.5759, -0.6329, -0.5945, -0.6272, -0.6594])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008332654251717031
0: validation loss for velocity_v : 0.0003637355112005025
0: validation loss for specific_humidity : 1.3154716725694016e-05
0: validation loss for velocity_z : 0.0012899013236165047
0: validation loss for temperature : 45272.8984375
0: validation loss for total_precip : 0.3644883632659912
0: validation loss for t2m : 54090.30078125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 398.85 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_042954-h6ivadck[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_042954-h6ivadck/logs[0m
0: Running global_forecast for 2015-02-10 17:00 ...
0: Wandb run: atmorep-gl8wpq8c-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : gl8wpq8c
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 17]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.262, max = -0.222, mean = -0.813
0:          sample (first 20): tensor([-0.4971, -0.5432, -0.5459, -0.5840, -0.5407, -0.5557, -0.6021, -0.5862, -0.5629, -0.5479, -0.5550, -0.6288,
0:         -0.5301, -0.5483, -0.6108, -0.5771, -0.6341, -0.5957, -0.6286, -0.6609])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007834334392100573
0: validation loss for velocity_v : 0.0003690954181365669
0: validation loss for specific_humidity : 1.3121668416715693e-05
0: validation loss for velocity_z : 0.0012725439155474305
0: validation loss for temperature : 45266.87890625
0: validation loss for total_precip : 0.7393411993980408
0: validation loss for t2m : 27049.84765625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 410.47 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_043645-gl8wpq8c[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_043645-gl8wpq8c/logs[0m
0: Running global_forecast for 2015-02-10 18:00 ...
0: Wandb run: atmorep-v09jhdae-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : v09jhdae
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 18]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [250.58055 250.59135 250.59995 250.60928 250.61897 250.6285  250.63591
0:  250.63971 250.64206 250.64404 250.6463  250.6485  250.6561  250.67317
0:  250.692   250.7068  250.71964 250.7332  250.75    250.75   ]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -2.281, max = -0.222, mean = -0.815
0:          sample (first 20): tensor([-0.4969, -0.5439, -0.5455, -0.5846, -0.5412, -0.5559, -0.6019, -0.5872, -0.5631, -0.5481, -0.5560, -0.6290,
0:         -0.5302, -0.5486, -0.6109, -0.5780, -0.6345, -0.5964, -0.6292, -0.6609])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008462625555694103
0: validation loss for velocity_v : 0.00035856416798196733
0: validation loss for specific_humidity : 1.3151624443707988e-05
0: validation loss for velocity_z : 0.0012881653383374214
0: validation loss for temperature : 45268.08203125
0: validation loss for total_precip : 1.1270333528518677
0: validation loss for t2m : 9.66503620147705
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 400.78 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_044348-v09jhdae[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_044348-v09jhdae/logs[0m
0: Running global_forecast for 2015-02-10 19:00 ...
0: Wandb run: atmorep-wtflwwr7-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : wtflwwr7
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 19]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [251.34946 251.34962 251.34976 251.34988 251.3519  251.35612 251.3611
0:  251.3655  251.36992 251.375   251.37996 251.3845  251.38896 251.3939
0:  251.39862 251.40283 251.4068  251.40996 251.41333 251.41858]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.876, max = -0.203, mean = -0.718
0:          sample (first 20): tensor([-0.4437, -0.4924, -0.5050, -0.5328, -0.5051, -0.5109, -0.5443, -0.5524, -0.5099, -0.5016, -0.5000, -0.5744,
0:         -0.4788, -0.4979, -0.5723, -0.5203, -0.5863, -0.5423, -0.5730, -0.6139])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007922259974293411
0: validation loss for velocity_v : 0.0003639030328486115
0: validation loss for specific_humidity : 1.3135679182596505e-05
0: validation loss for velocity_z : 0.0012707123532891273
0: validation loss for temperature : 45262.11328125
0: validation loss for total_precip : 0.9904350638389587
0: validation loss for t2m : 4.493038177490234
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 308.90 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_045041-wtflwwr7[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_045041-wtflwwr7/logs[0m
0: Running global_forecast for 2015-02-10 20:00 ...
0: Wandb run: atmorep-0ye08soy-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 0ye08soy
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 20]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [252.0985  252.22757 252.24454 252.24611 252.24733 252.24821 252.24908
0:  252.24976 252.25    252.25    252.25    252.25    252.25    252.25
0:  252.25    252.25    252.25    252.25    252.25    252.25055]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.965, max = -0.123, mean = -0.689
0:          sample (first 20): tensor([-0.3878, -0.4336, -0.4620, -0.4833, -0.4534, -0.4596, -0.4806, -0.5109, -0.4587, -0.4539, -0.4526, -0.5361,
0:         -0.4279, -0.4534, -0.5228, -0.4687, -0.5421, -0.4933, -0.5171, -0.5684])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007439320906996727
0: validation loss for velocity_v : 0.00036945962347090244
0: validation loss for specific_humidity : 1.3122849850333296e-05
0: validation loss for velocity_z : 0.001253162743523717
0: validation loss for temperature : 45256.26953125
0: validation loss for total_precip : 0.9625289440155029
0: validation loss for t2m : 2.029297113418579
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 401.79 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_045600-0ye08soy[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_045600-0ye08soy/logs[0m
0: Running global_forecast for 2015-02-10 21:00 ...
0: Wandb run: atmorep-j7sqxq7p-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : j7sqxq7p
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 21]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [251.78577 251.79343 251.79742 251.80022 251.80287 251.80496 251.80597
0:  251.80638 251.80756 251.80812 251.8094  251.81125 251.8106  251.81035
0:  251.81018 251.8102  251.81195 251.8145  251.81616 251.81433]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -0.684, max = 0.503, mean = -0.207
0:          sample (first 20): tensor([0.0964, 0.0759, 0.0711, 0.0255, 0.0868, 0.0627, 0.0448, 0.0840, 0.0860, 0.0711, 0.0995, 0.0578, 0.0673, 0.1152,
0:         0.0592, 0.0685, 0.0233, 0.0464, 0.0125, 0.0331])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008715988951735198
0: validation loss for velocity_v : 0.0003567970416042954
0: validation loss for specific_humidity : 1.3053575457888655e-05
0: validation loss for velocity_z : 0.0012800927506759763
0: validation loss for temperature : 45257.25
0: validation loss for total_precip : 0.8674959540367126
0: validation loss for t2m : 8.876558303833008
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 386.61 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_050249-j7sqxq7p[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_050249-j7sqxq7p/logs[0m
0: Running global_forecast for 2015-02-10 22:00 ...
0: Wandb run: atmorep-3k6ms5rv-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 3k6ms5rv
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 22]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [252.75    252.74837 252.74445 252.73993 252.73735 252.73633 252.7344
0:  252.73041 252.72585 252.71797 252.71213 252.70868 252.70712 252.70575
0:  252.70357 252.7008  252.69814 252.69582 252.6934  252.69048]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -0.620, max = 0.498, mean = -0.188
0:          sample (first 20): tensor([ 0.0656,  0.0439,  0.0379, -0.0099,  0.0518,  0.0280,  0.0153,  0.0501,  0.0494,  0.0344,  0.0694,  0.0227,
0:          0.0329,  0.0829,  0.0207,  0.0277, -0.0158,  0.0053, -0.0297, -0.0064])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008160598226822913
0: validation loss for velocity_v : 0.0003619564522523433
0: validation loss for specific_humidity : 1.3042074897384737e-05
0: validation loss for velocity_z : 0.0012624006485566497
0: validation loss for temperature : 45251.6328125
0: validation loss for total_precip : 0.8176844716072083
0: validation loss for t2m : 6.194046974182129
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 378.46 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_050922-3k6ms5rv[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_050922-3k6ms5rv/logs[0m
0: Running global_forecast for 2015-02-10 23:00 ...
0: Wandb run: atmorep-k958yhxd-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : k958yhxd
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 10, 23]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [253.22995 253.24222 253.24861 253.25    253.25    253.25    253.25
0:  253.25    253.25    253.25    253.25102 253.2601  253.26892 253.27744
0:  253.28554 253.29288 253.29991 253.30728 253.31415 253.3211 ]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -0.636, max = 0.495, mean = -0.161
0:          sample (first 20): tensor([0.1302, 0.1125, 0.0921, 0.0532, 0.1113, 0.0900, 0.0808, 0.1040, 0.1059, 0.0974, 0.1331, 0.0765, 0.0981, 0.1385,
0:         0.0831, 0.0989, 0.0466, 0.0646, 0.0263, 0.0540])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007667256286367774
0: validation loss for velocity_v : 0.0003673737228382379
0: validation loss for specific_humidity : 1.3040933481534012e-05
0: validation loss for velocity_z : 0.0012450037756934762
0: validation loss for temperature : 45246.0703125
0: validation loss for total_precip : 0.7629057168960571
0: validation loss for t2m : 2.251894474029541
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 380.49 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_051548-k958yhxd[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_051548-k958yhxd/logs[0m
0: Running global_forecast for 2015-02-11 00:00 ...
0: Wandb run: atmorep-qtql6jj2-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : qtql6jj2
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 0]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [255.06438 255.06468 255.06488 255.06595 255.0677  255.06972 255.07173
0:  255.07373 255.07576 255.07785 255.08005 255.08318 255.08673 255.09044
0:  255.09422 255.09808 255.10207 255.10606 255.11012 255.1139 ]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -0.537, max = 0.683, mean = -0.145
0:          sample (first 20): tensor([0.1396, 0.1390, 0.1467, 0.1141, 0.1454, 0.1270, 0.1239, 0.1567, 0.1334, 0.1525, 0.1588, 0.1150, 0.1500, 0.1579,
0:         0.1379, 0.1344, 0.0922, 0.0907, 0.0750, 0.0949])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0015985366189852357
0: validation loss for velocity_v : 0.00035722777829505503
0: validation loss for specific_humidity : 1.2646537470573094e-05
0: validation loss for velocity_z : 0.0015093013644218445
0: validation loss for temperature : 45341.22265625
0: validation loss for total_precip : 0.6722020506858826
0: validation loss for t2m : 7.358013153076172
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 397.87 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_052216-qtql6jj2[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_052216-qtql6jj2/logs[0m
0: Running global_forecast for 2015-02-11 01:00 ...
0: Wandb run: atmorep-jxd1t0me-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : jxd1t0me
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 1]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [255.61176 255.61444 255.61215 255.60881 255.60548 255.6031  255.60143
0:  255.59967 255.59839 255.59653 255.59146 255.58492 255.57901 255.5738
0:  255.56824 255.56213 255.55844 255.56065 255.55672 255.55397]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -0.517, max = 0.545, mean = -0.147
0:          sample (first 20): tensor([0.2007, 0.2021, 0.2099, 0.1740, 0.2081, 0.1932, 0.1901, 0.2210, 0.2029, 0.2194, 0.2252, 0.1799, 0.2132, 0.2218,
0:         0.1998, 0.1980, 0.1524, 0.1514, 0.1327, 0.1580])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0014966933522373438
0: validation loss for velocity_v : 0.00036185336648486555
0: validation loss for specific_humidity : 1.2577294000948314e-05
0: validation loss for velocity_z : 0.0014886031858623028
0: validation loss for temperature : 45333.86328125
0: validation loss for total_precip : 0.6191732287406921
0: validation loss for t2m : 4.333800792694092
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 393.97 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_052902-jxd1t0me[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_052902-jxd1t0me/logs[0m
0: Running global_forecast for 2015-02-11 02:00 ...
0: Wandb run: atmorep-5462y3qb-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 5462y3qb
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 2]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [254.66473 254.65953 254.65518 254.65268 254.65099 254.65012 254.65
0:  254.65    254.65    254.65    254.65    254.65    254.65    254.65
0:  254.65    254.65    254.65    254.65    254.65    254.65   ]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -0.553, max = 0.548, mean = -0.139
0:          sample (first 20): tensor([0.2845, 0.2930, 0.2812, 0.2541, 0.2872, 0.2744, 0.2755, 0.2946, 0.2791, 0.3031, 0.3083, 0.2519, 0.2994, 0.3006,
0:         0.2855, 0.2847, 0.2333, 0.2316, 0.2110, 0.2385])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.00140108703635633
0: validation loss for velocity_v : 0.00036681900382973254
0: validation loss for specific_humidity : 1.2522701581474394e-05
0: validation loss for velocity_z : 0.0014679664745926857
0: validation loss for temperature : 45326.98046875
0: validation loss for total_precip : 0.6048382520675659
0: validation loss for t2m : 1.4916452169418335
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 393.84 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_053545-5462y3qb[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_053545-5462y3qb/logs[0m
0: Running global_forecast for 2015-02-11 03:00 ...
0: Wandb run: atmorep-g27m8azd-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : g27m8azd
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 3]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [253.89433 253.89362 253.89107 253.88498 253.87837 253.8707  253.86037
0:  253.85088 253.85031 253.8503  253.85027 253.85023 253.8502  253.85017
0:  253.85017 253.85016 253.85014 253.85014 253.85014 253.85014]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -0.858, max = 1.204, mean = -0.207
0:          sample (first 20): tensor([1.0364, 1.0584, 1.0602, 1.0226, 1.0688, 1.0460, 1.0453, 1.0864, 1.0444, 1.0922, 1.0702, 1.0414, 1.0790, 1.0718,
0:         1.0729, 1.0537, 1.0282, 0.9982, 0.9960, 1.0309])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008215169655159116
0: validation loss for velocity_v : 0.0003584694059100002
0: validation loss for specific_humidity : 1.3107115591992624e-05
0: validation loss for velocity_z : 0.001358793000690639
0: validation loss for temperature : 45325.3359375
0: validation loss for total_precip : 0.5758655071258545
0: validation loss for t2m : 5.576111316680908
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 295.02 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_054227-g27m8azd[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_054227-g27m8azd/logs[0m
0: Running global_forecast for 2015-02-11 04:00 ...
0: Wandb run: atmorep-al9pq9fa-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : al9pq9fa
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 4]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [253.15    253.02216 253.00668 253.00966 253.01389 253.01486 253.01237
0:  253.01045 253.01024 253.01056 253.01161 253.01343 253.01393 253.014
0:  253.01411 253.01433 253.01663 253.02243 253.01155 252.99686]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -0.811, max = 0.984, mean = -0.247
0:          sample (first 20): tensor([0.8694, 0.8986, 0.8941, 0.8569, 0.9031, 0.8860, 0.8748, 0.9256, 0.8853, 0.9238, 0.9060, 0.8712, 0.9103, 0.9065,
0:         0.9037, 0.8824, 0.8576, 0.8278, 0.8234, 0.8568])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007729557692073286
0: validation loss for velocity_v : 0.0003639782080426812
0: validation loss for specific_humidity : 1.3062617654213682e-05
0: validation loss for velocity_z : 0.0013404497876763344
0: validation loss for temperature : 45318.4140625
0: validation loss for total_precip : 0.5610827803611755
0: validation loss for t2m : 3.004725217819214
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 386.69 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_054729-al9pq9fa[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_054729-al9pq9fa/logs[0m
0: Running global_forecast for 2015-02-11 05:00 ...
0: Wandb run: atmorep-ha295587-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : ha295587
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 5]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [252.65    252.82169 252.82779 252.80989 252.79247 252.77544 252.75987
0:  252.75    252.75    252.75    252.75    252.75    252.75    252.75
0:  252.75    252.75    252.7496  252.74625 252.73062 252.71469]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -0.821, max = 0.918, mean = -0.287
0:          sample (first 20): tensor([0.7798, 0.8111, 0.8026, 0.7714, 0.8109, 0.7971, 0.7904, 0.8341, 0.7971, 0.8286, 0.8146, 0.7709, 0.8121, 0.8163,
0:         0.8149, 0.7885, 0.7699, 0.7358, 0.7277, 0.7578])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007290344219654799
0: validation loss for velocity_v : 0.00036970857763662934
0: validation loss for specific_humidity : 1.3024454347032588e-05
0: validation loss for velocity_z : 0.001322257681749761
0: validation loss for temperature : 45311.671875
0: validation loss for total_precip : 0.5615931749343872
0: validation loss for t2m : 0.969360888004303
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 377.47 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_055403-ha295587[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_055403-ha295587/logs[0m
0: Running global_forecast for 2015-02-11 06:00 ...
0: Wandb run: atmorep-h7jeu4kl-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : h7jeu4kl
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 6]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [252.04118 252.03784 252.01837 251.99547 251.97087 251.94868 251.92993
0:  251.91162 251.89415 251.88057 251.871   251.8612  251.8493  251.83275
0:  251.81454 251.79578 251.7773  251.76645 251.75801 251.75003]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.212, max = 1.387, mean = -0.436
0:          sample (first 20): tensor([1.2520, 1.2790, 1.2935, 1.2614, 1.2755, 1.2604, 1.2600, 1.3191, 1.2740, 1.3027, 1.2837, 1.2532, 1.2801, 1.2919,
0:         1.3096, 1.2574, 1.2557, 1.2082, 1.2136, 1.2427])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007896771421656013
0: validation loss for velocity_v : 0.00035500351805239916
0: validation loss for specific_humidity : 1.308332139160484e-05
0: validation loss for velocity_z : 0.0013422640040516853
0: validation loss for temperature : 45313.12109375
0: validation loss for total_precip : 0.5403201580047607
0: validation loss for t2m : 4.837348937988281
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 388.61 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_060028-h7jeu4kl[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_060028-h7jeu4kl/logs[0m
0: Running global_forecast for 2015-02-11 07:00 ...
0: Wandb run: atmorep-dx5iris6-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : dx5iris6
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 7]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [251.07057 251.0708  251.07028 251.06871 251.06676 251.06482 251.06305
0:  251.06184 251.06161 251.0618  251.05911 251.05638 251.05447 251.05267
0:  251.05096 251.05    251.05    251.05    251.05    251.05   ]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.238, max = 1.374, mean = -0.443
0:          sample (first 20): tensor([1.2893, 1.3069, 1.3207, 1.2904, 1.2979, 1.2970, 1.2955, 1.3396, 1.3154, 1.3367, 1.3229, 1.2884, 1.3127, 1.3191,
0:         1.3369, 1.2975, 1.2864, 1.2420, 1.2435, 1.2785])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007429131073877215
0: validation loss for velocity_v : 0.0003606325190048665
0: validation loss for specific_humidity : 1.3025713997194543e-05
0: validation loss for velocity_z : 0.001324108219705522
0: validation loss for temperature : 45306.46484375
0: validation loss for total_precip : 0.5256741046905518
0: validation loss for t2m : 2.541379451751709
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 387.81 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_060709-dx5iris6[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_060709-dx5iris6/logs[0m
0: Running global_forecast for 2015-02-11 08:00 ...
0: Wandb run: atmorep-fcecrrex-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : fcecrrex
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 8]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [250.85    250.85    250.85    250.85    250.85    250.85    250.85
0:  250.85    250.85    250.85    250.85    250.85    250.85    250.85
0:  250.85    250.85    250.85168 250.85909 250.87108 250.8782 ]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.259, max = 1.254, mean = -0.463
0:          sample (first 20): tensor([1.1836, 1.1943, 1.2092, 1.1804, 1.1917, 1.1855, 1.1867, 1.2272, 1.2093, 1.2184, 1.2082, 1.1705, 1.2041, 1.2049,
0:         1.2273, 1.1845, 1.1775, 1.1372, 1.1344, 1.1670])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007008843822404742
0: validation loss for velocity_v : 0.0003666078264359385
0: validation loss for specific_humidity : 1.2993577001907397e-05
0: validation loss for velocity_z : 0.0013060248456895351
0: validation loss for temperature : 45299.90234375
0: validation loss for total_precip : 0.5527330636978149
0: validation loss for t2m : 0.7104586362838745
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 409.56 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_061347-fcecrrex[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_061347-fcecrrex/logs[0m
0: Running global_forecast for 2015-02-11 09:00 ...
0: Wandb run: atmorep-5piyqkhh-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 5piyqkhh
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 9]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [250.27362 250.26889 250.26721 250.26285 250.25719 250.25238 250.25
0:  250.25    250.25    250.25    250.25    250.24911 250.24376 250.24088
0:  250.23985 250.23813 250.23589 250.23296 250.22935 250.23085]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.329, max = 1.207, mean = -0.486
0:          sample (first 20): tensor([1.1416, 1.1524, 1.1784, 1.1474, 1.1601, 1.1522, 1.1551, 1.1996, 1.1801, 1.1905, 1.1643, 1.1426, 1.1666, 1.1774,
0:         1.1950, 1.1521, 1.1501, 1.1112, 1.1122, 1.1408])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008494963985867798
0: validation loss for velocity_v : 0.0003487806534394622
0: validation loss for specific_humidity : 1.2918879292556085e-05
0: validation loss for velocity_z : 0.001320335897617042
0: validation loss for temperature : 45300.59765625
0: validation loss for total_precip : 0.574275016784668
0: validation loss for t2m : 3.675889015197754
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 405.92 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_062049-5piyqkhh[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_062049-5piyqkhh/logs[0m
0: Running global_forecast for 2015-02-11 10:00 ...
0: Wandb run: atmorep-vpa412o4-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : vpa412o4
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 10]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [250.68088 250.66391 250.65172 250.64795 250.64696 250.64609 250.64516
0:  250.64429 250.64366 250.64267 250.64099 250.63942 250.63803 250.63768
0:  250.63606 250.63188 250.62608 250.61888 250.61198 250.60487]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.185, max = 0.868, mean = -0.556
0:          sample (first 20): tensor([0.7984, 0.8062, 0.8342, 0.7950, 0.8053, 0.8066, 0.8122, 0.8418, 0.8400, 0.8359, 0.8242, 0.7911, 0.8195, 0.8312,
0:         0.8427, 0.7949, 0.7973, 0.7576, 0.7613, 0.7846])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007978666108101606
0: validation loss for velocity_v : 0.00035395199665799737
0: validation loss for specific_humidity : 1.286473070649663e-05
0: validation loss for velocity_z : 0.0013022018829360604
0: validation loss for temperature : 45294.1875
0: validation loss for total_precip : 0.5611499547958374
0: validation loss for t2m : 1.758388876914978
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 407.47 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_062747-vpa412o4[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_062747-vpa412o4/logs[0m
0: Running global_forecast for 2015-02-11 11:00 ...
0: Wandb run: atmorep-4mjc5ezx-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 4mjc5ezx
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 11]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [251.77994 251.77502 251.77095 251.76558 251.75931 251.75287 251.74628
0:  251.73906 251.7314  251.72398 251.71605 251.70633 251.69753 251.68996
0:  251.68253 251.67508 251.6674  251.65732 251.64955 251.64864]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.017, max = 0.832, mean = -0.497
0:          sample (first 20): tensor([0.7579, 0.7652, 0.7691, 0.7444, 0.7621, 0.7638, 0.7748, 0.7831, 0.7890, 0.7890, 0.7793, 0.7447, 0.7792, 0.7801,
0:         0.7977, 0.7605, 0.7456, 0.7147, 0.7207, 0.7398])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000751968938857317
0: validation loss for velocity_v : 0.0003594178706407547
0: validation loss for specific_humidity : 1.2821524251194205e-05
0: validation loss for velocity_z : 0.0012839853297919035
0: validation loss for temperature : 45287.89453125
0: validation loss for total_precip : 0.565933346748352
0: validation loss for t2m : 0.5509120225906372
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 312.19 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_063446-4mjc5ezx[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_063446-4mjc5ezx/logs[0m
0: Running global_forecast for 2015-02-11 12:00 ...
0: Wandb run: atmorep-tx9lkz38-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : tx9lkz38
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 12]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [252.04329 252.04327 252.0435  252.0435  252.04335 252.04318 252.04324
0:  252.0437  252.0442  252.04459 252.04465 252.0449  252.04477 252.04433
0:  252.04428 252.0444  252.04396 252.04347 252.04382 252.0442 ]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.083, max = 0.911, mean = -0.483
0:          sample (first 20): tensor([0.8490, 0.8458, 0.8617, 0.8370, 0.8471, 0.8506, 0.8681, 0.8794, 0.8638, 0.8894, 0.8671, 0.8480, 0.8702, 0.8756,
0:         0.8906, 0.8513, 0.8360, 0.8028, 0.8183, 0.8326])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0016719275154173374
0: validation loss for velocity_v : 0.00035632052458822727
0: validation loss for specific_humidity : 1.2472602065827232e-05
0: validation loss for velocity_z : 0.0013336747651919723
0: validation loss for temperature : 45292.08203125
0: validation loss for total_precip : 0.5446677803993225
0: validation loss for t2m : 2.782439947128296
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 381.09 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_064005-tx9lkz38[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_064005-tx9lkz38/logs[0m
0: Running global_forecast for 2015-02-11 13:00 ...
0: Wandb run: atmorep-mpwxylih-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : mpwxylih
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 13]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [252.4451  252.44565 252.44565 252.44571 252.44603 252.44637 252.44635
0:  252.4459  252.44536 252.44461 252.44402 252.44403 252.44403 252.44408
0:  252.44415 252.44415 252.44397 252.44342 252.44354 252.44363]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.150, max = 1.099, mean = -0.435
0:          sample (first 20): tensor([1.0461, 1.0364, 1.0626, 1.0347, 1.0401, 1.0453, 1.0606, 1.0785, 1.0637, 1.0854, 1.0654, 1.0524, 1.0691, 1.0688,
0:         1.0826, 1.0531, 1.0393, 0.9996, 1.0116, 1.0268])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.001561260549351573
0: validation loss for velocity_v : 0.00036074023228138685
0: validation loss for specific_humidity : 1.2484072613005992e-05
0: validation loss for velocity_z : 0.0013163924450054765
0: validation loss for temperature : 45285.84375
0: validation loss for total_precip : 0.5516059994697571
0: validation loss for t2m : 1.1742258071899414
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 381.22 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_064633-mpwxylih[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_064633-mpwxylih/logs[0m
0: Running global_forecast for 2015-02-11 14:00 ...
0: Wandb run: atmorep-dbjlbla1-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : dbjlbla1
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 14]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [252.71407 252.69862 252.67986 252.6701  252.66443 252.65903 252.65367
0:  252.65    252.65    252.65    252.64621 252.62569 252.60854 252.59271
0:  252.57707 252.56552 252.56032 252.55602 252.55084 252.54028]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.139, max = 1.280, mean = -0.416
0:          sample (first 20): tensor([1.1503, 1.1417, 1.1628, 1.1360, 1.1408, 1.1451, 1.1713, 1.1727, 1.1660, 1.1833, 1.1667, 1.1419, 1.1719, 1.1648,
0:         1.1896, 1.1541, 1.1438, 1.1041, 1.1186, 1.1237])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0014583221636712551
0: validation loss for velocity_v : 0.0003655264445114881
0: validation loss for specific_humidity : 1.2510266969911754e-05
0: validation loss for velocity_z : 0.0012994863791391253
0: validation loss for temperature : 45279.6796875
0: validation loss for total_precip : 0.5638850331306458
0: validation loss for t2m : 0.4503677487373352
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 382.25 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_065301-dbjlbla1[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_065301-dbjlbla1/logs[0m
0: Running global_forecast for 2015-02-11 15:00 ...
0: Wandb run: atmorep-0i7iyvaw-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : 0i7iyvaw
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 15]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [253.05942 253.38892 253.42964 253.42891 253.42741 253.42555 253.42386
0:  253.42232 253.4206  253.41951 253.41841 253.41681 253.41386 253.41087
0:  253.4086  253.407   253.40582 253.405   253.40384 253.40245]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.126, max = 1.429, mean = -0.396
0:          sample (first 20): tensor([1.3243, 1.3213, 1.3333, 1.3035, 1.3183, 1.3316, 1.3508, 1.3527, 1.3394, 1.3707, 1.3481, 1.3259, 1.3464, 1.3483,
0:         1.3733, 1.3416, 1.3229, 1.2964, 1.3087, 1.3155])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000889299379196018
0: validation loss for velocity_v : 0.000358689168933779
0: validation loss for specific_humidity : 1.3186725482228212e-05
0: validation loss for velocity_z : 0.0013070212444290519
0: validation loss for temperature : 45278.96484375
0: validation loss for total_precip : 0.5587117671966553
0: validation loss for t2m : 1.8497040271759033
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 390.07 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_065931-0i7iyvaw[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_065931-0i7iyvaw/logs[0m
0: Running global_forecast for 2015-02-11 16:00 ...
0: Wandb run: atmorep-jfoqhwd4-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : jfoqhwd4
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 16]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [254.34593 254.33945 254.33536 254.33037 254.32419 254.31723 254.31064
0:  254.30553 254.3016  254.29796 254.29465 254.29134 254.28842 254.28598
0:  254.28192 254.27644 254.27162 254.26659 254.26085 254.2558 ]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.105, max = 1.602, mean = -0.377
0:          sample (first 20): tensor([1.4692, 1.4607, 1.4750, 1.4445, 1.4538, 1.4741, 1.4918, 1.4905, 1.4870, 1.5153, 1.4984, 1.4750, 1.4903, 1.4910,
0:         1.5170, 1.4936, 1.4631, 1.4439, 1.4551, 1.4596])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008333172299899161
0: validation loss for velocity_v : 0.00036373757757246494
0: validation loss for specific_humidity : 1.3155576198187191e-05
0: validation loss for velocity_z : 0.0012897599954158068
0: validation loss for temperature : 45272.86328125
0: validation loss for total_precip : 0.5599751472473145
0: validation loss for t2m : 0.571379542350769
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 413.75 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_070613-jfoqhwd4[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_070613-jfoqhwd4/logs[0m
0: Running global_forecast for 2015-02-11 17:00 ...
0: Wandb run: atmorep-cwlkp7x8-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : cwlkp7x8
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 17]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [254.65    254.647   254.6408  254.63399 254.62778 254.62224 254.61679
0:  254.61113 254.60606 254.60051 254.59526 254.59125 254.58841 254.58585
0:  254.58284 254.57901 254.5746  254.57045 254.56708 254.56374]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.090, max = 1.763, mean = -0.344
0:          sample (first 20): tensor([1.6562, 1.6440, 1.6613, 1.6266, 1.6333, 1.6556, 1.6816, 1.6691, 1.6699, 1.7003, 1.6863, 1.6586, 1.6787, 1.6771,
0:         1.7022, 1.6810, 1.6470, 1.6343, 1.6458, 1.6382])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007835020078346133
0: validation loss for velocity_v : 0.00036906683817505836
0: validation loss for specific_humidity : 1.3122147720423527e-05
0: validation loss for velocity_z : 0.0012725082924589515
0: validation loss for temperature : 45266.8828125
0: validation loss for total_precip : 0.5867193341255188
0: validation loss for t2m : 0.2599033713340759
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 412.79 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_071318-cwlkp7x8[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_071318-cwlkp7x8/logs[0m
0: Running global_forecast for 2015-02-11 18:00 ...
0: Wandb run: atmorep-t4up5ntd-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : t4up5ntd
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 18]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [254.18903 254.1815  254.17429 254.16655 254.15619 254.15025 254.15024
0:  254.15022 254.1502  254.15018 254.15015 254.15013 254.15012 254.15009
0:  254.15009 254.15007 254.15005 254.15002 254.15001 254.14456]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.057, max = 1.983, mean = -0.270
0:          sample (first 20): tensor([1.8761, 1.8582, 1.8867, 1.8430, 1.8561, 1.8842, 1.8988, 1.8970, 1.8863, 1.9237, 1.9116, 1.9012, 1.9030, 1.9134,
0:         1.9329, 1.9195, 1.8732, 1.8720, 1.8782, 1.8802])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008462014957331121
0: validation loss for velocity_v : 0.0003585830272641033
0: validation loss for specific_humidity : 1.3153950931155123e-05
0: validation loss for velocity_z : 0.0012880733702331781
0: validation loss for temperature : 45268.01171875
0: validation loss for total_precip : 0.5906515121459961
0: validation loss for t2m : 1.0882563591003418
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 398.16 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_072017-t4up5ntd[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_072017-t4up5ntd/logs[0m
0: Running global_forecast for 2015-02-11 19:00 ...
0: Wandb run: atmorep-spwap5ln-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : spwap5ln
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 19]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [253.76947 253.76866 253.76778 253.76663 253.76544 253.76436 253.76338
0:  253.76248 253.7614  253.75987 253.75803 253.75635 253.75493 253.75342
0:  253.7519  253.75044 253.74861 253.74593 253.74348 253.74126]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.073, max = 2.007, mean = -0.222
0:          sample (first 20): tensor([1.9053, 1.8862, 1.9176, 1.8672, 1.8767, 1.9128, 1.9287, 1.9187, 1.9134, 1.9521, 1.9403, 1.9411, 1.9309, 1.9494,
0:         1.9624, 1.9535, 1.9048, 1.9084, 1.9100, 1.9153])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007922727963887155
0: validation loss for velocity_v : 0.0003639201167970896
0: validation loss for specific_humidity : 1.3135453627910465e-05
0: validation loss for velocity_z : 0.0012706057168543339
0: validation loss for temperature : 45262.09375
0: validation loss for total_precip : 0.6030938029289246
0: validation loss for t2m : 0.3193332254886627
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 292.80 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_072703-spwap5ln[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_072703-spwap5ln/logs[0m
0: Running global_forecast for 2015-02-11 20:00 ...
0: Wandb run: atmorep-w2v6qczr-19707372
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707372
0: wandb_id : w2v6qczr
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 2, 11, 20]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [ 1.5258789e-05  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00 -1.5258789e-05  0.0000000e+00  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00 -1.5258789e-05  0.0000000e+00
0:   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
0: Target values (first 20):
0: [253.45    253.45    253.45    253.45    253.45    253.447   253.44083
0:  253.43448 253.42838 253.42194 253.41527 253.4088  253.40373 253.39868
0:  253.39337 253.38773 253.38155 253.37547 253.36958 253.36407]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -1.081, max = 1.875, mean = -0.199
0:          sample (first 20): tensor([1.7809, 1.7541, 1.7923, 1.7409, 1.7542, 1.7855, 1.8141, 1.7854, 1.7842, 1.8130, 1.8091, 1.8179, 1.8037, 1.8270,
0:         1.8339, 1.8248, 1.7786, 1.7811, 1.7863, 1.7869])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007439290056936443
0: validation loss for velocity_v : 0.00036945383180864155
0: validation loss for specific_humidity : 1.3123368262313306e-05
0: validation loss for velocity_z : 0.0012530810199677944
0: validation loss for temperature : 45256.203125
0: validation loss for total_precip : 0.6119809150695801
0: validation loss for t2m : 0.18095867335796356
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 385.92 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_073202-w2v6qczr[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_073202-w2v6qczr/logs[0m
