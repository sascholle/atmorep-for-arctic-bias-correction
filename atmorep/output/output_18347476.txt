0: Wandb run: atmorep-a7ymav5q-18347476
0: l50048:2182986:2182986 [0] NCCL INFO Bootstrap : Using ib0:10.128.11.138<0>
0: l50048:2182986:2182986 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
0: l50048:2182986:2182986 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
0: l50048:2182986:2182986 [0] NCCL INFO NET/Plugin: Using internal network plugin.
0: l50048:2182986:2182986 [0] NCCL INFO cudaDriverVersion 12050
0: NCCL version 2.21.5+cuda12.4
1: l50051:3726393:3726393 [0] NCCL INFO cudaDriverVersion 12050
1: l50051:3726393:3726393 [0] NCCL INFO Bootstrap : Using ib0:10.128.11.140<0>
1: l50051:3726393:3726393 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
1: l50051:3726393:3726393 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
1: l50051:3726393:3726393 [0] NCCL INFO NET/Plugin: Using internal network plugin.
1: l50051:3726393:3726549 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib0:10.128.11.140<0>
1: l50051:3726393:3726549 [0] NCCL INFO Using non-device net plugin version 0
1: l50051:3726393:3726549 [0] NCCL INFO Using network IB
0: l50048:2182986:2183386 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib0:10.128.11.138<0>
0: l50048:2182986:2183386 [0] NCCL INFO Using non-device net plugin version 0
0: l50048:2182986:2183386 [0] NCCL INFO Using network IB
0: l50048:2182986:2183386 [0] NCCL INFO ncclCommInitRank comm 0x55555f291d70 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0x8fd50099746de927 - Init START
1: l50051:3726393:3726549 [0] NCCL INFO ncclCommInitRank comm 0x55555ee4d560 rank 1 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0x8fd50099746de927 - Init START
1: l50051:3726393:3726549 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
0: l50048:2182986:2183386 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
1: l50051:3726393:3726549 [0] NCCL INFO comm 0x55555ee4d560 rank 1 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
1: l50051:3726393:3726549 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] 0/-1/-1->1->-1 [3] 0/-1/-1->1->-1
1: l50051:3726393:3726549 [0] NCCL INFO P2P Chunksize set to 131072
0: l50048:2182986:2183386 [0] NCCL INFO comm 0x55555f291d70 rank 0 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
0: l50048:2182986:2183386 [0] NCCL INFO Channel 00/04 :    0   1
0: l50048:2182986:2183386 [0] NCCL INFO Channel 01/04 :    0   1
0: l50048:2182986:2183386 [0] NCCL INFO Channel 02/04 :    0   1
0: l50048:2182986:2183386 [0] NCCL INFO Channel 03/04 :    0   1
0: l50048:2182986:2183386 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] -1/-1/-1->0->1 [3] -1/-1/-1->0->1
0: l50048:2182986:2183386 [0] NCCL INFO P2P Chunksize set to 131072
1: l50051:3726393:3726549 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [receive] via NET/IB/0
1: l50051:3726393:3726549 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [receive] via NET/IB/1
0: l50048:2182986:2183386 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [receive] via NET/IB/0
0: l50048:2182986:2183386 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [receive] via NET/IB/1
1: l50051:3726393:3726549 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [receive] via NET/IB/0
1: l50051:3726393:3726549 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [receive] via NET/IB/1
1: l50051:3726393:3726549 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [send] via NET/IB/0
1: l50051:3726393:3726549 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [send] via NET/IB/1
1: l50051:3726393:3726549 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [send] via NET/IB/0
1: l50051:3726393:3726549 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [send] via NET/IB/1
0: l50048:2182986:2183386 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [receive] via NET/IB/0
0: l50048:2182986:2183386 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [receive] via NET/IB/1
0: l50048:2182986:2183386 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [send] via NET/IB/0
0: l50048:2182986:2183386 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [send] via NET/IB/1
0: l50048:2182986:2183386 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [send] via NET/IB/0
0: l50048:2182986:2183386 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [send] via NET/IB/1
0: l50048:2182986:2183389 [0] NCCL INFO NCCL_IB_TIMEOUT set by environment to 250.
0: l50048:2182986:2183389 [0] NCCL INFO NCCL_IB_RETRY_CNT set by environment to 50.
1: l50051:3726393:3726552 [0] NCCL INFO NCCL_IB_TIMEOUT set by environment to 250.
1: l50051:3726393:3726552 [0] NCCL INFO NCCL_IB_RETRY_CNT set by environment to 50.
0: l50048:2182986:2183386 [0] NCCL INFO Connected all rings
0: l50048:2182986:2183386 [0] NCCL INFO Connected all trees
1: l50051:3726393:3726549 [0] NCCL INFO Connected all rings
0: l50048:2182986:2183386 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
0: l50048:2182986:2183386 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
1: l50051:3726393:3726549 [0] NCCL INFO Connected all trees
1: l50051:3726393:3726549 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
1: l50051:3726393:3726549 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
1: l50051:3726393:3726549 [0] NCCL INFO TUNER/Plugin: Plugin load returned 11 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
1: l50051:3726393:3726549 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
1: l50051:3726393:3726549 [0] NCCL INFO ncclCommInitRank comm 0x55555ee4d560 rank 1 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0x8fd50099746de927 - Init COMPLETE
0: l50048:2182986:2183386 [0] NCCL INFO TUNER/Plugin: Plugin load returned 11 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
0: l50048:2182986:2183386 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
0: l50048:2182986:2183386 [0] NCCL INFO ncclCommInitRank comm 0x55555f291d70 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0x8fd50099746de927 - Init COMPLETE
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 2
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.3], ['velocity_v', 0.3], ['specific_humidity', 0.15], ['velocity_z', 0.025], ['temperature', 0.2], ['total_precip', 0.025]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : [[0.0, 360.0], [0.0, 360.0]]
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 96
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : BERT
0: forecast_num_tokens : 2
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 0
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 18347476
0: wandb_id : a7ymav5q
0: file_path : /scratch/a/a270277/era5_y2010_2020_with_t2m_res25.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : wc5e2i3t
0: sparse_target : False
0: sparse_target_field : total_precip
0: sparse_target_sparsity : 0.9
0: years_test : [2021]
1: > /work/ab1412/atmorep/atmorep/datasets/multifield_data_sampler.py(52)__init__()
1: -> assert os.path.exists(file_path), f"File path {file_path} does not exist"
1: (Pdb) 
0: > /work/ab1412/atmorep/atmorep/datasets/multifield_data_sampler.py(52)__init__()
0: -> assert os.path.exists(file_path), f"File path {file_path} does not exist"
0: (Pdb) 
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250714_122820-a7ymav5q[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250714_122820-a7ymav5q/logs[0m
0: l50048:2182986:2183389 [0] NCCL INFO [Service thread] Connection closed by localRank 0
1: l50051:3726393:3726552 [0] NCCL INFO [Service thread] Connection closed by localRank 0
1: l50051:3726393:3726557 [0] NCCL INFO comm 0x55555ee4d560 rank 1 nranks 2 cudaDev 0 busId 3000 - Abort COMPLETE
0: l50048:2182986:2183393 [0] NCCL INFO comm 0x55555f291d70 rank 0 nranks 2 cudaDev 0 busId 3000 - Abort COMPLETE
