0: Evaluating the following times: (2099,)
0: Running global_forecast for 2015-01-24 21:00 ...
0: Wandb run: atmorep-p1ewm4nx-19707116
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707116
0: wandb_id : p1ewm4nx
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 1, 24, 21]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [248.74706 248.74158 248.73637 248.73076 248.72563 248.72083 248.71606
0:  248.71144 248.70683 248.7025  248.69756 248.69221 248.68631 248.67981
0:  248.67313 248.6666  248.6604  248.65503 248.64958 248.64145]
0: Target values (first 20):
0: [243.33484 243.33565 243.33594 243.33662 243.33688 243.33798 243.34038
0:  243.34229 243.34244 243.34518 243.345   243.34387 243.34557 243.34848
0:  243.34935 243.34843 243.34818 243.34825 243.35    243.35   ]
0: validation forecast for strategy=global_forecast at epoch 0 : batch 0
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -0.792, max = 1.494, mean = 0.052
0:          sample (first 20): tensor([-0.1792, -0.2301, -0.1639, -0.2209, -0.1997, -0.2061, -0.1972, -0.1628, -0.1670, -0.1750, -0.1535, -0.1645,
0:         -0.1683, -0.1682, -0.1613, -0.1649, -0.1535, -0.1738, -0.1566, -0.1441])
0: validation forecast for strategy=global_forecast at epoch 0 : batch 1
0: validation forecast for strategy=global_forecast at epoch 0 : batch 2
0: validation forecast for strategy=global_forecast at epoch 0 : batch 3
0: validation forecast for strategy=global_forecast at epoch 0 : batch 4
0: validation forecast for strategy=global_forecast at epoch 0 : batch 5
0: validation forecast for strategy=global_forecast at epoch 0 : batch 6
0: validation forecast for strategy=global_forecast at epoch 0 : batch 7
0: validation forecast for strategy=global_forecast at epoch 0 : batch 8
0: validation forecast for strategy=global_forecast at epoch 0 : batch 9
0: validation forecast for strategy=global_forecast at epoch 0 : batch 10
0: validation forecast for strategy=global_forecast at epoch 0 : batch 11
0: validation forecast for strategy=global_forecast at epoch 0 : batch 12
0: validation forecast for strategy=global_forecast at epoch 0 : batch 13
0: validation forecast for strategy=global_forecast at epoch 0 : batch 14
0: validation forecast for strategy=global_forecast at epoch 0 : batch 15
0: validation forecast for strategy=global_forecast at epoch 0 : batch 16
0: validation forecast for strategy=global_forecast at epoch 0 : batch 17
0: validation forecast for strategy=global_forecast at epoch 0 : batch 18
0: validation forecast for strategy=global_forecast at epoch 0 : batch 19
0: validation forecast for strategy=global_forecast at epoch 0 : batch 20
0: validation forecast for strategy=global_forecast at epoch 0 : batch 21
0: validation forecast for strategy=global_forecast at epoch 0 : batch 22
0: validation forecast for strategy=global_forecast at epoch 0 : batch 23
0: validation forecast for strategy=global_forecast at epoch 0 : batch 24
0: validation forecast for strategy=global_forecast at epoch 0 : batch 25
0: validation forecast for strategy=global_forecast at epoch 0 : batch 26
0: validation forecast for strategy=global_forecast at epoch 0 : batch 27
0: validation forecast for strategy=global_forecast at epoch 0 : batch 28
0: validation forecast for strategy=global_forecast at epoch 0 : batch 29
0: validation forecast for strategy=global_forecast at epoch 0 : batch 30
0: validation forecast for strategy=global_forecast at epoch 0 : batch 31
0: validation forecast for strategy=global_forecast at epoch 0 : batch 32
0: validation forecast for strategy=global_forecast at epoch 0 : batch 33
0: validation forecast for strategy=global_forecast at epoch 0 : batch 34
0: validation forecast for strategy=global_forecast at epoch 0 : batch 35
0: validation forecast for strategy=global_forecast at epoch 0 : batch 36
0: validation forecast for strategy=global_forecast at epoch 0 : batch 37
0: validation forecast for strategy=global_forecast at epoch 0 : batch 38
0: validation forecast for strategy=global_forecast at epoch 0 : batch 39
0: validation forecast for strategy=global_forecast at epoch 0 : batch 40
0: validation forecast for strategy=global_forecast at epoch 0 : batch 41
0: validation forecast for strategy=global_forecast at epoch 0 : batch 42
0: validation forecast for strategy=global_forecast at epoch 0 : batch 43
0: validation forecast for strategy=global_forecast at epoch 0 : batch 44
0: validation forecast for strategy=global_forecast at epoch 0 : batch 45
0: validation forecast for strategy=global_forecast at epoch 0 : batch 46
0: validation forecast for strategy=global_forecast at epoch 0 : batch 47
0: validation forecast for strategy=global_forecast at epoch 0 : batch 48
0: validation forecast for strategy=global_forecast at epoch 0 : batch 49
0: validation forecast for strategy=global_forecast at epoch 0 : batch 50
0: validation forecast for strategy=global_forecast at epoch 0 : batch 51
0: validation forecast for strategy=global_forecast at epoch 0 : batch 52
0: validation forecast for strategy=global_forecast at epoch 0 : batch 53
0: validation forecast for strategy=global_forecast at epoch 0 : batch 54
0: validation forecast for strategy=global_forecast at epoch 0 : batch 55
0: validation forecast for strategy=global_forecast at epoch 0 : batch 56
0: validation forecast for strategy=global_forecast at epoch 0 : batch 57
0: validation forecast for strategy=global_forecast at epoch 0 : batch 58
0: validation forecast for strategy=global_forecast at epoch 0 : batch 59
0: validation forecast for strategy=global_forecast at epoch 0 : batch 60
0: validation forecast for strategy=global_forecast at epoch 0 : batch 61
0: validation forecast for strategy=global_forecast at epoch 0 : batch 62
0: validation forecast for strategy=global_forecast at epoch 0 : batch 63
0: validation forecast for strategy=global_forecast at epoch 0 : batch 64
0: validation forecast for strategy=global_forecast at epoch 0 : batch 65
0: validation forecast for strategy=global_forecast at epoch 0 : batch 66
0: validation forecast for strategy=global_forecast at epoch 0 : batch 67
0: validation forecast for strategy=global_forecast at epoch 0 : batch 68
0: validation forecast for strategy=global_forecast at epoch 0 : batch 69
0: validation forecast for strategy=global_forecast at epoch 0 : batch 70
0: validation forecast for strategy=global_forecast at epoch 0 : batch 71
0: validation forecast for strategy=global_forecast at epoch 0 : batch 72
0: validation forecast for strategy=global_forecast at epoch 0 : batch 73
0: validation forecast for strategy=global_forecast at epoch 0 : batch 74
0: validation forecast for strategy=global_forecast at epoch 0 : batch 75
0: validation forecast for strategy=global_forecast at epoch 0 : batch 76
0: validation forecast for strategy=global_forecast at epoch 0 : batch 77
0: validation forecast for strategy=global_forecast at epoch 0 : batch 78
0: validation forecast for strategy=global_forecast at epoch 0 : batch 79
0: validation forecast for strategy=global_forecast at epoch 0 : batch 80
0: validation forecast for strategy=global_forecast at epoch 0 : batch 81
0: validation forecast for strategy=global_forecast at epoch 0 : batch 82
0: validation forecast for strategy=global_forecast at epoch 0 : batch 83
0: validation forecast for strategy=global_forecast at epoch 0 : batch 84
0: validation forecast for strategy=global_forecast at epoch 0 : batch 85
0: validation forecast for strategy=global_forecast at epoch 0 : batch 86
0: validation forecast for strategy=global_forecast at epoch 0 : batch 87
0: validation forecast for strategy=global_forecast at epoch 0 : batch 88
0: validation forecast for strategy=global_forecast at epoch 0 : batch 89
0: validation forecast for strategy=global_forecast at epoch 0 : batch 90
0: validation forecast for strategy=global_forecast at epoch 0 : batch 91
0: validation forecast for strategy=global_forecast at epoch 0 : batch 92
0: validation forecast for strategy=global_forecast at epoch 0 : batch 93
0: validation forecast for strategy=global_forecast at epoch 0 : batch 94
0: validation forecast for strategy=global_forecast at epoch 0 : batch 95
0: validation forecast for strategy=global_forecast at epoch 0 : batch 96
0: validation forecast for strategy=global_forecast at epoch 0 : batch 97
0: validation forecast for strategy=global_forecast at epoch 0 : batch 98
0: validation forecast for strategy=global_forecast at epoch 0 : batch 99
0: validation forecast for strategy=global_forecast at epoch 0 : batch 100
0: validation forecast for strategy=global_forecast at epoch 0 : batch 101
0: validation forecast for strategy=global_forecast at epoch 0 : batch 102
0: validation forecast for strategy=global_forecast at epoch 0 : batch 103
0: validation forecast for strategy=global_forecast at epoch 0 : batch 104
0: validation forecast for strategy=global_forecast at epoch 0 : batch 105
0: validation forecast for strategy=global_forecast at epoch 0 : batch 106
0: validation forecast for strategy=global_forecast at epoch 0 : batch 107
0: validation forecast for strategy=global_forecast at epoch 0 : batch 108
0: validation forecast for strategy=global_forecast at epoch 0 : batch 109
0: validation forecast for strategy=global_forecast at epoch 0 : batch 110
0: validation forecast for strategy=global_forecast at epoch 0 : batch 111
0: validation forecast for strategy=global_forecast at epoch 0 : batch 112
0: validation forecast for strategy=global_forecast at epoch 0 : batch 113
0: validation forecast for strategy=global_forecast at epoch 0 : batch 114
0: validation forecast for strategy=global_forecast at epoch 0 : batch 115
0: validation forecast for strategy=global_forecast at epoch 0 : batch 116
0: validation forecast for strategy=global_forecast at epoch 0 : batch 117
0: validation forecast for strategy=global_forecast at epoch 0 : batch 118
0: validation forecast for strategy=global_forecast at epoch 0 : batch 119
0: validation forecast for strategy=global_forecast at epoch 0 : batch 120
0: validation forecast for strategy=global_forecast at epoch 0 : batch 121
0: validation forecast for strategy=global_forecast at epoch 0 : batch 122
0: validation forecast for strategy=global_forecast at epoch 0 : batch 123
0: validation forecast for strategy=global_forecast at epoch 0 : batch 124
0: validation forecast for strategy=global_forecast at epoch 0 : batch 125
0: validation forecast for strategy=global_forecast at epoch 0 : batch 126
0: validation forecast for strategy=global_forecast at epoch 0 : batch 127
0: validation forecast for strategy=global_forecast at epoch 0 : batch 128
0: validation forecast for strategy=global_forecast at epoch 0 : batch 129
0: validation forecast for strategy=global_forecast at epoch 0 : batch 130
0: validation forecast for strategy=global_forecast at epoch 0 : batch 131
0: validation forecast for strategy=global_forecast at epoch 0 : batch 132
0: validation forecast for strategy=global_forecast at epoch 0 : batch 133
0: validation forecast for strategy=global_forecast at epoch 0 : batch 134
0: validation forecast for strategy=global_forecast at epoch 0 : batch 135
0: validation forecast for strategy=global_forecast at epoch 0 : batch 136
0: validation forecast for strategy=global_forecast at epoch 0 : batch 137
0: validation forecast for strategy=global_forecast at epoch 0 : batch 138
0: validation forecast for strategy=global_forecast at epoch 0 : batch 139
0: validation forecast for strategy=global_forecast at epoch 0 : batch 140
0: validation forecast for strategy=global_forecast at epoch 0 : batch 141
0: validation forecast for strategy=global_forecast at epoch 0 : batch 142
0: validation forecast for strategy=global_forecast at epoch 0 : batch 143
0: validation forecast for strategy=global_forecast at epoch 0 : batch 144
0: validation forecast for strategy=global_forecast at epoch 0 : batch 145
0: validation forecast for strategy=global_forecast at epoch 0 : batch 146
0: validation forecast for strategy=global_forecast at epoch 0 : batch 147
0: validation forecast for strategy=global_forecast at epoch 0 : batch 148
0: validation forecast for strategy=global_forecast at epoch 0 : batch 149
0: validation forecast for strategy=global_forecast at epoch 0 : batch 150
0: validation forecast for strategy=global_forecast at epoch 0 : batch 151
0: validation forecast for strategy=global_forecast at epoch 0 : batch 152
0: validation forecast for strategy=global_forecast at epoch 0 : batch 153
0: validation forecast for strategy=global_forecast at epoch 0 : batch 154
0: validation forecast for strategy=global_forecast at epoch 0 : batch 155
0: validation forecast for strategy=global_forecast at epoch 0 : batch 156
0: validation forecast for strategy=global_forecast at epoch 0 : batch 157
0: validation forecast for strategy=global_forecast at epoch 0 : batch 158
0: validation forecast for strategy=global_forecast at epoch 0 : batch 159
0: validation forecast for strategy=global_forecast at epoch 0 : batch 160
0: validation forecast for strategy=global_forecast at epoch 0 : batch 161
0: validation forecast for strategy=global_forecast at epoch 0 : batch 162
0: validation forecast for strategy=global_forecast at epoch 0 : batch 163
0: validation forecast for strategy=global_forecast at epoch 0 : batch 164
0: validation forecast for strategy=global_forecast at epoch 0 : batch 165
0: validation forecast for strategy=global_forecast at epoch 0 : batch 166
0: validation forecast for strategy=global_forecast at epoch 0 : batch 167
0: validation forecast for strategy=global_forecast at epoch 0 : batch 168
0: validation forecast for strategy=global_forecast at epoch 0 : batch 169
0: validation forecast for strategy=global_forecast at epoch 0 : batch 170
0: validation forecast for strategy=global_forecast at epoch 0 : batch 171
0: validation forecast for strategy=global_forecast at epoch 0 : batch 172
0: validation forecast for strategy=global_forecast at epoch 0 : batch 173
0: validation forecast for strategy=global_forecast at epoch 0 : batch 174
0: validation forecast for strategy=global_forecast at epoch 0 : batch 175
0: validation forecast for strategy=global_forecast at epoch 0 : batch 176
0: validation forecast for strategy=global_forecast at epoch 0 : batch 177
0: validation forecast for strategy=global_forecast at epoch 0 : batch 178
0: validation forecast for strategy=global_forecast at epoch 0 : batch 179
0: validation forecast for strategy=global_forecast at epoch 0 : batch 180
0: validation forecast for strategy=global_forecast at epoch 0 : batch 181
0: validation forecast for strategy=global_forecast at epoch 0 : batch 182
0: validation forecast for strategy=global_forecast at epoch 0 : batch 183
0: validation forecast for strategy=global_forecast at epoch 0 : batch 184
0: validation forecast for strategy=global_forecast at epoch 0 : batch 185
0: validation forecast for strategy=global_forecast at epoch 0 : batch 186
0: validation forecast for strategy=global_forecast at epoch 0 : batch 187
0: validation forecast for strategy=global_forecast at epoch 0 : batch 188
0: validation forecast for strategy=global_forecast at epoch 0 : batch 189
0: validation forecast for strategy=global_forecast at epoch 0 : batch 190
0: validation forecast for strategy=global_forecast at epoch 0 : batch 191
0: validation forecast for strategy=global_forecast at epoch 0 : batch 192
0: validation forecast for strategy=global_forecast at epoch 0 : batch 193
0: validation forecast for strategy=global_forecast at epoch 0 : batch 194
0: validation forecast for strategy=global_forecast at epoch 0 : batch 195
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0006634933524765074
0: validation loss for velocity_v : 0.0006842825096100569
0: validation loss for specific_humidity : 1.5729670849395916e-05
0: validation loss for velocity_z : 0.0013588471338152885
0: validation loss for temperature : 43421.3515625
0: validation loss for total_precip : 0.7338394522666931
0: validation loss for t2m : 0.11201861500740051
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 474.90 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250924_154522-p1ewm4nx[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250924_154522-p1ewm4nx/logs[0m
0: Running global_forecast for 2015-01-24 22:00 ...
0: Wandb run: atmorep-6v403saw-19707116
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707116
0: wandb_id : 6v403saw
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 1, 24, 22]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [249.49167 249.48972 249.48788 249.48622 249.48505 249.48396 249.4828
0:  249.48186 249.48105 249.48051 249.48015 249.47983 249.47954 249.47928
0:  249.47905 249.47885 249.47849 249.47766 249.47737 249.47722]
0: Target values (first 20):
0: [242.54971 242.84013 242.87775 242.87944 242.88367 242.88742 242.88881
0:  242.88934 242.88943 242.89049 242.88918 242.88829 242.8897  242.8905
0:  242.89087 242.89111 242.89072 242.89047 242.88701 242.88528]
0: validation forecast for strategy=global_forecast at epoch 0 : batch 0
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -0.780, max = 1.447, mean = 0.057
0:          sample (first 20): tensor([-0.2968, -0.3485, -0.2916, -0.3515, -0.3252, -0.3329, -0.3270, -0.2984, -0.2940, -0.2991, -0.2820, -0.2927,
0:         -0.2901, -0.2871, -0.2858, -0.2889, -0.2804, -0.2948, -0.2738, -0.2579])
0: validation forecast for strategy=global_forecast at epoch 0 : batch 1
0: validation forecast for strategy=global_forecast at epoch 0 : batch 2
0: validation forecast for strategy=global_forecast at epoch 0 : batch 3
0: validation forecast for strategy=global_forecast at epoch 0 : batch 4
0: validation forecast for strategy=global_forecast at epoch 0 : batch 5
0: validation forecast for strategy=global_forecast at epoch 0 : batch 6
0: validation forecast for strategy=global_forecast at epoch 0 : batch 7
0: validation forecast for strategy=global_forecast at epoch 0 : batch 8
0: validation forecast for strategy=global_forecast at epoch 0 : batch 9
0: validation forecast for strategy=global_forecast at epoch 0 : batch 10
0: validation forecast for strategy=global_forecast at epoch 0 : batch 11
0: validation forecast for strategy=global_forecast at epoch 0 : batch 12
0: validation forecast for strategy=global_forecast at epoch 0 : batch 13
0: validation forecast for strategy=global_forecast at epoch 0 : batch 14
0: validation forecast for strategy=global_forecast at epoch 0 : batch 15
0: validation forecast for strategy=global_forecast at epoch 0 : batch 16
0: validation forecast for strategy=global_forecast at epoch 0 : batch 17
0: validation forecast for strategy=global_forecast at epoch 0 : batch 18
0: validation forecast for strategy=global_forecast at epoch 0 : batch 19
0: validation forecast for strategy=global_forecast at epoch 0 : batch 20
0: validation forecast for strategy=global_forecast at epoch 0 : batch 21
0: validation forecast for strategy=global_forecast at epoch 0 : batch 22
0: validation forecast for strategy=global_forecast at epoch 0 : batch 23
0: validation forecast for strategy=global_forecast at epoch 0 : batch 24
0: validation forecast for strategy=global_forecast at epoch 0 : batch 25
0: validation forecast for strategy=global_forecast at epoch 0 : batch 26
0: validation forecast for strategy=global_forecast at epoch 0 : batch 27
0: validation forecast for strategy=global_forecast at epoch 0 : batch 28
0: validation forecast for strategy=global_forecast at epoch 0 : batch 29
0: validation forecast for strategy=global_forecast at epoch 0 : batch 30
0: validation forecast for strategy=global_forecast at epoch 0 : batch 31
0: validation forecast for strategy=global_forecast at epoch 0 : batch 32
0: validation forecast for strategy=global_forecast at epoch 0 : batch 33
0: validation forecast for strategy=global_forecast at epoch 0 : batch 34
0: validation forecast for strategy=global_forecast at epoch 0 : batch 35
0: validation forecast for strategy=global_forecast at epoch 0 : batch 36
0: validation forecast for strategy=global_forecast at epoch 0 : batch 37
0: validation forecast for strategy=global_forecast at epoch 0 : batch 38
0: validation forecast for strategy=global_forecast at epoch 0 : batch 39
0: validation forecast for strategy=global_forecast at epoch 0 : batch 40
0: validation forecast for strategy=global_forecast at epoch 0 : batch 41
0: validation forecast for strategy=global_forecast at epoch 0 : batch 42
0: validation forecast for strategy=global_forecast at epoch 0 : batch 43
