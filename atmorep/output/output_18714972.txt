0: Wandb run: atmorep-yoze69vq-18714972
0: l50081:1510369:1510369 [0] NCCL INFO Bootstrap : Using ib0:10.128.11.160<0>
0: l50081:1510369:1510369 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
0: l50081:1510369:1510369 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
0: l50081:1510369:1510369 [0] NCCL INFO NET/Plugin: Using internal network plugin.
0: l50081:1510369:1510369 [0] NCCL INFO cudaDriverVersion 12060
0: NCCL version 2.21.5+cuda12.4
1: l50103:1931886:1931886 [0] NCCL INFO cudaDriverVersion 12060
1: l50103:1931886:1931886 [0] NCCL INFO Bootstrap : Using ib0:10.128.11.164<0>
1: l50103:1931886:1931886 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
1: l50103:1931886:1931886 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
1: l50103:1931886:1931886 [0] NCCL INFO NET/Plugin: Using internal network plugin.
1: l50103:1931886:1932129 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib0:10.128.11.164<0>
1: l50103:1931886:1932129 [0] NCCL INFO Using non-device net plugin version 0
1: l50103:1931886:1932129 [0] NCCL INFO Using network IB
0: l50081:1510369:1510881 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib0:10.128.11.160<0>
0: l50081:1510369:1510881 [0] NCCL INFO Using non-device net plugin version 0
0: l50081:1510369:1510881 [0] NCCL INFO Using network IB
1: l50103:1931886:1932129 [0] NCCL INFO DMA-BUF is available on GPU device 0
0: l50081:1510369:1510881 [0] NCCL INFO DMA-BUF is available on GPU device 0
0: l50081:1510369:1510881 [0] NCCL INFO ncclCommInitRank comm 0x55555f0e65f0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0xf564a78f4b688534 - Init START
1: l50103:1931886:1932129 [0] NCCL INFO ncclCommInitRank comm 0x55555ec9dcf0 rank 1 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0xf564a78f4b688534 - Init START
1: l50103:1931886:1932129 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
0: l50081:1510369:1510881 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
0: l50081:1510369:1510881 [0] NCCL INFO comm 0x55555f0e65f0 rank 0 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
0: l50081:1510369:1510881 [0] NCCL INFO Channel 00/04 :    0   1
0: l50081:1510369:1510881 [0] NCCL INFO Channel 01/04 :    0   1
0: l50081:1510369:1510881 [0] NCCL INFO Channel 02/04 :    0   1
0: l50081:1510369:1510881 [0] NCCL INFO Channel 03/04 :    0   1
0: l50081:1510369:1510881 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] -1/-1/-1->0->1 [3] -1/-1/-1->0->1
0: l50081:1510369:1510881 [0] NCCL INFO P2P Chunksize set to 131072
1: l50103:1931886:1932129 [0] NCCL INFO comm 0x55555ec9dcf0 rank 1 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
1: l50103:1931886:1932129 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] 0/-1/-1->1->-1 [3] 0/-1/-1->1->-1
1: l50103:1931886:1932129 [0] NCCL INFO P2P Chunksize set to 131072
1: l50103:1931886:1932129 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [receive] via NET/IB/0
0: l50081:1510369:1510881 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [receive] via NET/IB/0
1: l50103:1931886:1932129 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [receive] via NET/IB/1
1: l50103:1931886:1932129 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [receive] via NET/IB/0
0: l50081:1510369:1510881 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [receive] via NET/IB/1
1: l50103:1931886:1932129 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [receive] via NET/IB/1
0: l50081:1510369:1510881 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [receive] via NET/IB/0
1: l50103:1931886:1932129 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [send] via NET/IB/0
0: l50081:1510369:1510881 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [receive] via NET/IB/1
1: l50103:1931886:1932129 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [send] via NET/IB/1
0: l50081:1510369:1510881 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [send] via NET/IB/0
1: l50103:1931886:1932129 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [send] via NET/IB/0
0: l50081:1510369:1510881 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [send] via NET/IB/1
1: l50103:1931886:1932129 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [send] via NET/IB/1
0: l50081:1510369:1510881 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [send] via NET/IB/0
0: l50081:1510369:1510881 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [send] via NET/IB/1
1: l50103:1931886:1932132 [0] NCCL INFO NCCL_IB_TIMEOUT set by environment to 250.
1: l50103:1931886:1932132 [0] NCCL INFO NCCL_IB_RETRY_CNT set by environment to 50.
0: l50081:1510369:1510884 [0] NCCL INFO NCCL_IB_TIMEOUT set by environment to 250.
0: l50081:1510369:1510884 [0] NCCL INFO NCCL_IB_RETRY_CNT set by environment to 50.
0: l50081:1510369:1510881 [0] NCCL INFO Connected all rings
0: l50081:1510369:1510881 [0] NCCL INFO Connected all trees
1: l50103:1931886:1932129 [0] NCCL INFO Connected all rings
1: l50103:1931886:1932129 [0] NCCL INFO Connected all trees
1: l50103:1931886:1932129 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
1: l50103:1931886:1932129 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
0: l50081:1510369:1510881 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
0: l50081:1510369:1510881 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
0: l50081:1510369:1510881 [0] NCCL INFO TUNER/Plugin: Plugin load returned 11 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
0: l50081:1510369:1510881 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
0: l50081:1510369:1510881 [0] NCCL INFO ncclCommInitRank comm 0x55555f0e65f0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0xf564a78f4b688534 - Init COMPLETE
1: l50103:1931886:1932129 [0] NCCL INFO TUNER/Plugin: Plugin load returned 11 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
1: l50103:1931886:1932129 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
1: l50103:1931886:1932129 [0] NCCL INFO ncclCommInitRank comm 0x55555ec9dcf0 rank 1 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0xf564a78f4b688534 - Init COMPLETE
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 2
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.1, 0, 0, 0]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.1, 0, 0, 0]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.1, 0, 0, 0]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.1, 0, 0, 0]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.1, 0, 0, 0], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.1, 0, 0, 0]], ['t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidi
0: ty'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.58]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : [[0.0, 360.0], [0.0, 360.0]]
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 96
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : BERT
0: forecast_num_tokens : 2
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 0
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 18714972
0: wandb_id : yoze69vq
0: file_path : /work/ab1412/atmorep/data/era5_y2010_2020_res25_with_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : hjbmsjft
0: years_test : [2021]
1: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
1: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
1: self.lats : (721,)
1: self.lons : (1440,)
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
1: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
1: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
1: self.lats : (721,)
1: self.lons : (1440,)
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: Loaded model id = 0rmiio09.
1: Loaded run '0rmiio09' at epoch -2.
0: Loaded model id = 0rmiio09.
0: Loaded run '0rmiio09' at epoch -2.
1: -1 : 16:31:07 :: batch_size = 96, lr = 1e-05
0: Number of trainable parameters: 886,234,640
0: -1 : 16:31:07 :: batch_size = 96, lr = 1e-05
0: [DEBUG] TRAIN INPUT BATCH
0: Epoch -1, first input batch shapes / sample data:
0:   └─ Field: 'velocity_u' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
1: [DEBUG] TRAIN INPUT BATCH
1: Epoch -1, first input batch shapes / sample data:
1:   └─ Field: 'velocity_u' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
1:      first 25 values: tensor([-0.2466, -0.2332, -0.2240, -0.2201, -0.2227, -0.2304, -0.2414, -0.2553, -0.2707, -0.2864, -0.3005, -0.3112,
1:         -0.3177, -0.3197, -0.3182, -0.3136, -0.3089, -0.3051, -0.2263, -0.2124, -0.2037, -0.2003, -0.2021, -0.2091,
1:         -0.2194], device='cuda:0')
1:   └─ Field: 'velocity_v' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
1:      first 25 values: tensor([0.6635, 0.6728, 0.6814, 0.6889, 0.6945, 0.6962, 0.6960, 0.6935, 0.6883, 0.6810, 0.6726, 0.6668, 0.6653, 0.6674,
1:         0.6741, 0.6841, 0.6943, 0.7020, 0.6460, 0.6558, 0.6645, 0.6712, 0.6756, 0.6764, 0.6745], device='cuda:0')
1:   └─ Field: 'specific_humidity' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
1:      first 25 values: tensor([-0.4338, -0.4372, -0.4349, -0.4292, -0.4259, -0.4270, -0.4338, -0.4499, -0.4765, -0.5082, -0.5391, -0.5621,
1:         -0.5746, -0.5791, -0.5789, -0.5779, -0.5783, -0.5815, -0.4382, -0.4458, -0.4504, -0.4478, -0.4470, -0.4478,
1:         -0.4543], device='cuda:0')
1:   └─ Field: 'velocity_z' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
1:      first 25 values: tensor([ 0.1116,  0.0581, -0.0155, -0.0534, -0.0601, -0.0668, -0.0445, -0.0267, -0.0289, -0.0177, -0.0445, -0.0311,
1:         -0.0021,  0.0045,  0.0581,  0.0781,  0.1071,  0.1428,  0.0023, -0.0311, -0.0646, -0.0824, -0.0802, -0.0891,
1:         -0.0690], device='cuda:0')
1:   └─ Field: 'temperature' shape: torch.Size([96, 5, 12, 2, 4, 3, 27, 27])
1:      first 25 values: tensor([ 0.0707,  0.0961,  0.1242,  0.1439,  0.1474,  0.1312,  0.0972,  0.0492, -0.0089, -0.0772, -0.1636, -0.2612,
1:         -0.3611, -0.4577, -0.5435, -0.6139, -0.6756, -0.7388, -0.8013, -0.8650, -0.9306, -0.9860, -1.0369, -1.0881,
1:         -1.1401], device='cuda:0')
1:   └─ Field: 'total_precip' shape: torch.Size([96, 1, 12, 6, 12, 3, 9, 9])
1:      first 25 values: tensor([-0.0775, -0.1963, -0.2382, -0.2417, -0.2417, -0.2428, -0.2428, -0.2428, -0.2417, -0.1916, -0.1951, -0.2359,
1:         -0.2405, -0.2382, -0.2428, -0.2428, -0.2428, -0.2405, -0.1544, -0.1811, -0.2289, -0.2417, -0.2347, -0.2417,
1:         -0.2428], device='cuda:0')
1:   └─ Field: 't2m' shape: torch.Size([96, 1, 12, 2, 4, 3, 27, 27])
1:      first 25 values: tensor([1.4784, 1.5105, 1.4724, 1.4794, 1.4302, 1.4255, 1.3553, 1.2629, 1.2160, 1.2112, 1.1758, 1.1425, 1.0867, 1.0571,
1:         1.0285, 1.0381, 1.0214, 1.0327, 1.0490, 1.0701, 1.1175, 1.1448, 1.1555, 1.1779, 1.2068], device='cuda:0')
1: [DEBUG] TRAIN TARGET BATCH
1: Epoch -1, batch 0 - Sparse-masked 't2m' shape target data: torch.Size([2316, 2187])
1:     First 25 batch values:
1: tensor([0.9117, 0.9243, 0.9310, 0.9397, 0.8576, 0.9064, 0.8308, 0.7689, 0.7475, 0.6561, 0.6758, 0.5693, 0.5085, 0.5628,
1:         0.5549, 0.5307, 0.3749, 0.3050, 0.2724, 0.3420, 0.4395, 0.5473, 0.7609, 0.8014, 0.9722])
1: [DEBUG] TRAIN PREDICTIONS BATCH
1: Epoch -1, first predictions sample:
1:   └─ Predictions for 'velocity_u' shape: torch.Size([5304, 972])
1:      first 25 pred values: tensor([0.7325, 0.7381, 0.7467, 0.7576, 0.7683, 0.7825, 0.7952, 0.8075, 0.8198, 0.8269, 0.8280, 0.8276, 0.8246, 0.8248,
1:         0.8269, 0.8301, 0.8306, 0.8342, 0.7132, 0.7212, 0.7298, 0.7419, 0.7543, 0.7672, 0.7803], device='cuda:0',
1:        grad_fn=<SliceBackward0>)
1:   └─ Predictions for 'velocity_v' shape: torch.Size([5514, 972])
1:      first 25 pred values: tensor([-0.1738, -0.1185, -0.0785, -0.0494, -0.0275, -0.0084,  0.0097,  0.0229,  0.0285,  0.0271,  0.0199,  0.0144,
1:          0.0163,  0.0267,  0.0455,  0.0753,  0.1165,  0.1699, -0.1757, -0.1212, -0.0851, -0.0615, -0.0467, -0.0353,
1:         -0.0246], device='cuda:0', grad_fn=<SliceBackward0>)
1:   └─ Predictions for 'specific_humidity' shape: torch.Size([5424, 972])
1:      first 25 pred values: tensor([0.4214, 0.3994, 0.3823, 0.3739, 0.3766, 0.3745, 0.3795, 0.3750, 0.3733, 0.3746, 0.3788, 0.3955, 0.4168, 0.4406,
1:         0.4641, 0.4804, 0.5043, 0.5214, 0.3875, 0.3546, 0.3293, 0.3206, 0.3223, 0.3324, 0.3439], device='cuda:0',
1:        grad_fn=<SliceBackward0>)
1:   └─ Predictions for 'velocity_z' shape: torch.Size([5344, 972])
1:      first 25 pred values: tensor([ 1.8000e-01,  9.8392e-02,  3.7003e-02,  2.1752e-02, -6.7074e-03, -9.5230e-03,  3.5810e-02,  1.2246e-01,
1:          2.8230e-01,  4.7006e-01,  6.3451e-01,  7.4458e-01,  7.8261e-01,  8.2078e-01,  8.6277e-01,  8.5137e-01,
1:          8.0725e-01,  7.3727e-01,  1.3086e-01,  3.8016e-02, -2.7104e-02, -3.6167e-02, -4.1765e-02,  8.1273e-05,
1:          1.0606e-01], device='cuda:0', grad_fn=<SliceBackward0>)
1:   └─ Predictions for 'temperature' shape: torch.Size([2598, 2187])
0:      first 25 values: tensor([-0.2466, -0.2332, -0.2240, -0.2201, -0.2227, -0.2304, -0.2414, -0.2553, -0.2707, -0.2864, -0.3005, -0.3112,
0:         -0.3177, -0.3197, -0.3182, -0.3136, -0.3089, -0.3051, -0.2263, -0.2124, -0.2037, -0.2003, -0.2021, -0.2091,
0:         -0.2194], device='cuda:0')
0:   └─ Field: 'velocity_v' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
1:      first 25 pred values: tensor([-1.4805, -1.5092, -1.5306, -1.5490, -1.5666, -1.5869, -1.6103, -1.6364, -1.6622, -1.6851, -1.7031, -1.7146,
1:         -1.7204, -1.7229, -1.7228, -1.7215, -1.7196, -1.7176, -1.7160, -1.7153, -1.7160, -1.7138, -1.7094, -1.7019,
1:         -1.6913], device='cuda:0', grad_fn=<SliceBackward0>)
1:   └─ Predictions for 'total_precip' shape: torch.Size([3828, 243])
0:      first 25 values: tensor([0.6635, 0.6728, 0.6814, 0.6889, 0.6945, 0.6962, 0.6960, 0.6935, 0.6883, 0.6810, 0.6726, 0.6668, 0.6653, 0.6674,
0:         0.6741, 0.6841, 0.6943, 0.7020, 0.6460, 0.6558, 0.6645, 0.6712, 0.6756, 0.6764, 0.6745], device='cuda:0')
0:   └─ Field: 'specific_humidity' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
0:      first 25 values: tensor([-0.4338, -0.4372, -0.4349, -0.4292, -0.4259, -0.4270, -0.4338, -0.4499, -0.4765, -0.5082, -0.5391, -0.5621,
0:         -0.5746, -0.5791, -0.5789, -0.5779, -0.5783, -0.5815, -0.4382, -0.4458, -0.4504, -0.4478, -0.4470, -0.4478,
0:         -0.4543], device='cuda:0')
0:   └─ Field: 'velocity_z' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
1:      first 25 pred values: tensor([-0.2377, -0.2402, -0.2416, -0.2424, -0.2409, -0.2428, -0.2430, -0.2404, -0.2428, -0.2421, -0.2410, -0.2431,
1:         -0.2411, -0.2426, -0.2434, -0.2446, -0.2436, -0.2422, -0.2447, -0.2432, -0.2437, -0.2425, -0.2435, -0.2450,
1:         -0.2453], device='cuda:0', grad_fn=<SliceBackward0>)
1:   └─ Predictions for 't2m' shape: torch.Size([2316, 2187])
0:      first 25 values: tensor([ 0.1116,  0.0581, -0.0155, -0.0534, -0.0601, -0.0668, -0.0445, -0.0267, -0.0289, -0.0177, -0.0445, -0.0311,
0:         -0.0021,  0.0045,  0.0581,  0.0781,  0.1071,  0.1428,  0.0023, -0.0311, -0.0646, -0.0824, -0.0802, -0.0891,
0:         -0.0690], device='cuda:0')
0:   └─ Field: 'temperature' shape: torch.Size([96, 5, 12, 2, 4, 3, 27, 27])
0:      first 25 values: tensor([ 0.0707,  0.0961,  0.1242,  0.1439,  0.1474,  0.1312,  0.0972,  0.0492, -0.0089, -0.0772, -0.1636, -0.2612,
0:         -0.3611, -0.4577, -0.5435, -0.6139, -0.6756, -0.7388, -0.8013, -0.8650, -0.9306, -0.9860, -1.0369, -1.0881,
0:         -1.1401], device='cuda:0')
1:      first 25 pred values: tensor([1.3086, 1.3496, 1.2786, 1.2967, 1.2408, 1.2669, 1.2392, 1.1907, 1.2055, 1.1317, 1.0925, 1.0777, 1.0580, 1.0500,
1:         1.0256, 0.9779, 0.9194, 0.8597, 0.8335, 0.8681, 0.7556, 0.8233, 0.7327, 0.6901, 0.6525], device='cuda:0',
1:        grad_fn=<SliceBackward0>)
0:   └─ Field: 'total_precip' shape: torch.Size([96, 1, 12, 6, 12, 3, 9, 9])
0:      first 25 values: tensor([-0.0775, -0.1963, -0.2382, -0.2417, -0.2417, -0.2428, -0.2428, -0.2428, -0.2417, -0.1916, -0.1951, -0.2359,
0:         -0.2405, -0.2382, -0.2428, -0.2428, -0.2428, -0.2405, -0.1544, -0.1811, -0.2289, -0.2417, -0.2347, -0.2417,
0:         -0.2428], device='cuda:0')
0:   └─ Field: 't2m' shape: torch.Size([96, 1, 12, 2, 4, 3, 27, 27])
0:      first 25 values: tensor([1.4784, 1.5105, 1.4724, 1.4794, 1.4302, 1.4255, 1.3553, 1.2629, 1.2160, 1.2112, 1.1758, 1.1425, 1.0867, 1.0571,
0:         1.0285, 1.0381, 1.0214, 1.0327, 1.0490, 1.0701, 1.1175, 1.1448, 1.1555, 1.1779, 1.2068], device='cuda:0')
0: [DEBUG] TRAIN TARGET BATCH
0: Epoch -1, batch 0 - Sparse-masked 't2m' shape target data: torch.Size([2142, 2187])
0:     First 25 batch values:
0: tensor([1.0609, 1.0760, 1.1075, 1.1696, 1.2054, 1.3017, 1.3496, 1.3855, 1.4442, 1.4522, 1.4996, 1.5295, 1.5531, 1.6184,
0:         1.6590, 1.7302, 1.7334, 1.6870, 1.6191, 1.5128, 1.5043, 1.5554, 1.5990, 1.5993, 1.5513])
0: [DEBUG] TRAIN PREDICTIONS BATCH
0: Epoch -1, first predictions sample:
0:   └─ Predictions for 'velocity_u' shape: torch.Size([5610, 972])
0:      first 25 pred values: tensor([-0.2040, -0.1986, -0.1921, -0.1875, -0.1848, -0.1841, -0.1818, -0.1770, -0.1728, -0.1670, -0.1640, -0.1619,
0:         -0.1636, -0.1677, -0.1703, -0.1687, -0.1646, -0.1558, -0.1856, -0.1773, -0.1699, -0.1647, -0.1625, -0.1595,
0:         -0.1561], device='cuda:0', grad_fn=<SliceBackward0>)
0:   └─ Predictions for 'velocity_v' shape: torch.Size([5656, 972])
0:      first 25 pred values: tensor([1.2059, 1.1884, 1.1534, 1.1036, 1.0344, 0.9544, 0.8753, 0.8056, 0.7518, 0.7210, 0.7063, 0.7024, 0.7051, 0.7098,
0:         0.7131, 0.7137, 0.7097, 0.7057, 1.1776, 1.1556, 1.1181, 1.0599, 0.9847, 0.8994, 0.8159], device='cuda:0',
0:        grad_fn=<SliceBackward0>)
0:   └─ Predictions for 'specific_humidity' shape: torch.Size([5494, 972])
0:      first 25 pred values: tensor([-0.0923, -0.1355, -0.1559, -0.1572, -0.1436, -0.1157, -0.0786, -0.0325,  0.0203,  0.0758,  0.1257,  0.1751,
0:          0.2110,  0.2332,  0.2406,  0.2375,  0.2342,  0.2255,  0.0279, -0.0171, -0.0472, -0.0594, -0.0564, -0.0329,
0:         -0.0015], device='cuda:0', grad_fn=<SliceBackward0>)
0:   └─ Predictions for 'velocity_z' shape: torch.Size([5461, 972])
0:      first 25 pred values: tensor([0.1939, 0.2695, 0.3325, 0.3341, 0.3101, 0.2730, 0.2252, 0.2248, 0.2506, 0.2783, 0.3333, 0.3822, 0.3992, 0.4215,
0:         0.4242, 0.3551, 0.2761, 0.2411, 0.1246, 0.1762, 0.2084, 0.1956, 0.1692, 0.1364, 0.0992], device='cuda:0',
0:        grad_fn=<SliceBackward0>)
0:   └─ Predictions for 'temperature' shape: torch.Size([2434, 2187])
0:      first 25 pred values: tensor([-1.0495, -1.0183, -0.9921, -0.9759, -0.9674, -0.9653, -0.9635, -0.9584, -0.9504, -0.9424, -0.9367, -0.9348,
0:         -0.9340, -0.9321, -0.9294, -0.9235, -0.9145, -0.9010, -0.8828, -0.8636, -0.8502, -0.8442, -0.8452, -0.8496,
0:         -0.8535], device='cuda:0', grad_fn=<SliceBackward0>)
0:   └─ Predictions for 'total_precip' shape: torch.Size([3516, 243])
0:      first 25 pred values: tensor([-0.2351, -0.2400, -0.2385, -0.2380, -0.2382, -0.2390, -0.2384, -0.2347, -0.2402, -0.2380, -0.2382, -0.2397,
0:         -0.2375, -0.2401, -0.2414, -0.2427, -0.2408, -0.2386, -0.2418, -0.2386, -0.2409, -0.2409, -0.2397, -0.2406,
0:         -0.2402], device='cuda:0', grad_fn=<SliceBackward0>)
0:   └─ Predictions for 't2m' shape: torch.Size([2142, 2187])
0:      first 25 pred values: tensor([0.9758, 1.0114, 1.0112, 1.1454, 1.0844, 1.1889, 1.2123, 1.1723, 1.2289, 1.2755, 1.3554, 1.3289, 1.4355, 1.4276,
0:         1.4966, 1.5154, 1.5084, 1.5432, 1.5458, 1.5668, 1.5696, 1.5672, 1.6430, 1.6612, 1.6839], device='cuda:0',
0:        grad_fn=<SliceBackward0>)
0: epoch: -1 [1/5 (20%)]	Loss: 0.39387 : 0.06318 :: 0.04577 (1.66 s/sec)
0: epoch: -1 [2/5 (40%)]	Loss: 0.43940 : 0.06111 :: 0.04584 (10.07 s/sec)
0: epoch: -1 [3/5 (60%)]	Loss: 0.45531 : 0.08377 :: 0.05086 (10.32 s/sec)
0: epoch: -1 [4/5 (80%)]	Loss: 0.44652 : 0.08709 :: 0.04463 (10.27 s/sec)
0: > /work/ab1412/atmorep/pyenv/lib/python3.10/site-packages/torch/serialization.py(690)__exit__()
0: -> self.file_like.write_end_of_file()
0: (Pdb) 
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250729_163004-yoze69vq[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250729_163004-yoze69vq/logs[0m
0: l50081:1510369:1510884 [0] NCCL INFO [Service thread] Connection closed by localRank 0
0: l50081:1510369:1511361 [0] NCCL INFO comm 0x55555f0e65f0 rank 0 nranks 2 cudaDev 0 busId 3000 - Abort COMPLETE
