0: Evaluating the following times: (2099,)
0: Running global_forecast for 2015-05-11 04:00 ...
0: Wandb run: atmorep-6qgq1ho0-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 6qgq1ho0
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 4]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.123, max = -0.162, mean = -1.039
0:          sample (first 20): tensor([-0.5708, -0.6258, -0.5917, -0.6620, -0.6045, -0.6319, -0.6693, -0.6592, -0.6199, -0.6094, -0.6231, -0.7090,
0:         -0.5909, -0.6189, -0.6892, -0.6536, -0.7077, -0.6647, -0.6952, -0.7132])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005071952473372221
0: validation loss for velocity_v : 0.0007998188957571983
0: validation loss for specific_humidity : 1.8724031178862788e-05
0: validation loss for velocity_z : 0.0012105905916541815
0: validation loss for temperature : 45644.63671875
0: validation loss for total_precip : 0.00036648771492764354
0: validation loss for t2m : 78078.4453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 431.48 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_170829-6qgq1ho0[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_170829-6qgq1ho0/logs[0m
0: Running global_forecast for 2015-05-11 05:00 ...
0: Wandb run: atmorep-q4id6c11-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : q4id6c11
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 5]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.125, max = -0.161, mean = -1.042
0:          sample (first 20): tensor([-0.5720, -0.6267, -0.5933, -0.6633, -0.6056, -0.6331, -0.6709, -0.6604, -0.6212, -0.6110, -0.6240, -0.7107,
0:         -0.5927, -0.6201, -0.6907, -0.6549, -0.7091, -0.6659, -0.6961, -0.7146])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0004887591348960996
0: validation loss for velocity_v : 0.000804088544100523
0: validation loss for specific_humidity : 1.858149880717974e-05
0: validation loss for velocity_z : 0.0012000594288110733
0: validation loss for temperature : 45637.6171875
0: validation loss for total_precip : 0.00035917351488023996
0: validation loss for t2m : 78078.3828125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 439.54 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_171554-q4id6c11[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_171554-q4id6c11/logs[0m
0: Running global_forecast for 2015-05-11 06:00 ...
0: Wandb run: atmorep-olxavv28-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : olxavv28
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 6]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.128, max = -0.161, mean = -1.045
0:          sample (first 20): tensor([-0.5720, -0.6275, -0.5927, -0.6635, -0.6061, -0.6334, -0.6705, -0.6614, -0.6212, -0.6110, -0.6246, -0.7105,
0:         -0.5926, -0.6204, -0.6908, -0.6553, -0.7090, -0.6669, -0.6967, -0.7149])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005264000501483679
0: validation loss for velocity_v : 0.0008015717612579465
0: validation loss for specific_humidity : 1.865161357272882e-05
0: validation loss for velocity_z : 0.0012043191818520427
0: validation loss for temperature : 45639.0703125
0: validation loss for total_precip : 0.0003807034227065742
0: validation loss for t2m : 78078.3515625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 393.92 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_172322-olxavv28[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_172322-olxavv28/logs[0m
0: Running global_forecast for 2015-05-11 07:00 ...
0: Wandb run: atmorep-feicboo7-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : feicboo7
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 7]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.132, max = -0.161, mean = -1.046
0:          sample (first 20): tensor([-0.5732, -0.6282, -0.5936, -0.6644, -0.6068, -0.6342, -0.6720, -0.6620, -0.6222, -0.6121, -0.6256, -0.7116,
0:         -0.5939, -0.6215, -0.6917, -0.6560, -0.7102, -0.6677, -0.6978, -0.7158])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005058743408881128
0: validation loss for velocity_v : 0.0008048070012591779
0: validation loss for specific_humidity : 1.8503675164538436e-05
0: validation loss for velocity_z : 0.0011935250367969275
0: validation loss for temperature : 45632.25390625
0: validation loss for total_precip : 0.000373394024791196
0: validation loss for t2m : 78078.3125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 400.39 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_173004-feicboo7[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_173004-feicboo7/logs[0m
0: Running global_forecast for 2015-05-11 08:00 ...
0: Wandb run: atmorep-wzs2ogfd-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : wzs2ogfd
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 8]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.135, max = -0.160, mean = -1.049
0:          sample (first 20): tensor([-0.5735, -0.6288, -0.5950, -0.6647, -0.6075, -0.6347, -0.6730, -0.6627, -0.6227, -0.6130, -0.6261, -0.7124,
0:         -0.5945, -0.6222, -0.6925, -0.6568, -0.7111, -0.6683, -0.6984, -0.7163])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0004874850274063647
0: validation loss for velocity_v : 0.0008090809569694102
0: validation loss for specific_humidity : 1.8367594748269767e-05
0: validation loss for velocity_z : 0.001183276530355215
0: validation loss for temperature : 45625.40625
0: validation loss for total_precip : 0.00036613334668800235
0: validation loss for t2m : 78078.2734375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 418.75 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_173704-wzs2ogfd[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_173704-wzs2ogfd/logs[0m
0: Running global_forecast for 2015-05-11 09:00 ...
0: Wandb run: atmorep-a3n814oc-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : a3n814oc
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 9]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.137, max = -0.161, mean = -1.052
0:          sample (first 20): tensor([-0.5732, -0.6293, -0.5938, -0.6646, -0.6075, -0.6347, -0.6723, -0.6626, -0.6225, -0.6130, -0.6262, -0.7123,
0:         -0.5939, -0.6218, -0.6923, -0.6564, -0.7106, -0.6685, -0.6983, -0.7164])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005677151493728161
0: validation loss for velocity_v : 0.000771092192735523
0: validation loss for specific_humidity : 1.8294154870091006e-05
0: validation loss for velocity_z : 0.0011939620599150658
0: validation loss for temperature : 45626.078125
0: validation loss for total_precip : 0.0003884423931594938
0: validation loss for t2m : 78078.2109375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 412.21 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_174419-a3n814oc[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_174419-a3n814oc/logs[0m
0: Running global_forecast for 2015-05-11 10:00 ...
0: Wandb run: atmorep-r1mdv1et-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : r1mdv1et
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 10]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.140, max = -0.160, mean = -1.055
0:          sample (first 20): tensor([-0.5745, -0.6305, -0.5953, -0.6661, -0.6087, -0.6357, -0.6739, -0.6636, -0.6237, -0.6141, -0.6274, -0.7135,
0:         -0.5956, -0.6228, -0.6936, -0.6579, -0.7120, -0.6700, -0.6995, -0.7174])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005431066965684295
0: validation loss for velocity_v : 0.0007733089732937515
0: validation loss for specific_humidity : 1.8175438526668586e-05
0: validation loss for velocity_z : 0.0011836793273687363
0: validation loss for temperature : 45619.38671875
0: validation loss for total_precip : 0.0003812567447312176
0: validation loss for t2m : 78078.1796875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 427.63 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_175131-r1mdv1et[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_175131-r1mdv1et/logs[0m
0: Running global_forecast for 2015-05-11 11:00 ...
0: Wandb run: atmorep-vlyol80l-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : vlyol80l
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 11]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.143, max = -0.159, mean = -1.056
0:          sample (first 20): tensor([-0.5747, -0.6303, -0.5959, -0.6661, -0.6087, -0.6357, -0.6746, -0.6639, -0.6239, -0.6144, -0.6276, -0.7137,
0:         -0.5959, -0.6232, -0.6938, -0.6583, -0.7123, -0.6702, -0.6995, -0.7179])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005211913958191872
0: validation loss for velocity_v : 0.0007767556235194206
0: validation loss for specific_humidity : 1.8063943571178243e-05
0: validation loss for velocity_z : 0.0011732917046174407
0: validation loss for temperature : 45612.9296875
0: validation loss for total_precip : 0.0003740638494491577
0: validation loss for t2m : 78078.1171875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 338.89 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_175859-vlyol80l[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_175859-vlyol80l/logs[0m
0: Running global_forecast for 2015-05-11 12:00 ...
0: Wandb run: atmorep-yxgwrpit-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : yxgwrpit
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 12]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.144, max = -0.160, mean = -1.056
0:          sample (first 20): tensor([-0.5733, -0.6294, -0.5941, -0.6650, -0.6075, -0.6346, -0.6730, -0.6632, -0.6232, -0.6133, -0.6264, -0.7126,
0:         -0.5943, -0.6217, -0.6926, -0.6574, -0.7109, -0.6691, -0.6990, -0.7165])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008018859080038965
0: validation loss for velocity_v : 0.0008203281322494149
0: validation loss for specific_humidity : 1.7120726624852978e-05
0: validation loss for velocity_z : 0.0012087681097909808
0: validation loss for temperature : 45616.86328125
0: validation loss for total_precip : 0.00039544771425426006
0: validation loss for t2m : 78077.9921875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 383.29 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_180446-yxgwrpit[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_180446-yxgwrpit/logs[0m
0: Running global_forecast for 2015-05-11 13:00 ...
0: Wandb run: atmorep-x128g8j7-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : x128g8j7
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 13]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.147, max = -0.160, mean = -1.059
0:          sample (first 20): tensor([-0.5745, -0.6308, -0.5956, -0.6663, -0.6087, -0.6360, -0.6744, -0.6639, -0.6241, -0.6145, -0.6279, -0.7138,
0:         -0.5960, -0.6231, -0.6935, -0.6586, -0.7126, -0.6703, -0.7000, -0.7178])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007674400694668293
0: validation loss for velocity_v : 0.0008195963455364108
0: validation loss for specific_humidity : 1.706227703834884e-05
0: validation loss for velocity_z : 0.0011985913151875138
0: validation loss for temperature : 45610.47265625
0: validation loss for total_precip : 0.000387789768865332
0: validation loss for t2m : 78077.9453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 391.23 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_181118-x128g8j7[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_181118-x128g8j7/logs[0m
0: Running global_forecast for 2015-05-11 14:00 ...
0: Wandb run: atmorep-lswl775p-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : lswl775p
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 14]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.149, max = -0.158, mean = -1.062
0:          sample (first 20): tensor([-0.5752, -0.6311, -0.5967, -0.6670, -0.6092, -0.6365, -0.6757, -0.6645, -0.6247, -0.6156, -0.6285, -0.7148,
0:         -0.5971, -0.6240, -0.6946, -0.6593, -0.7132, -0.6711, -0.7009, -0.7184])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000735545065253973
0: validation loss for velocity_v : 0.0008198065916076303
0: validation loss for specific_humidity : 1.7019408915075473e-05
0: validation loss for velocity_z : 0.0011887531727552414
0: validation loss for temperature : 45604.09375
0: validation loss for total_precip : 0.00038031500298529863
0: validation loss for t2m : 78077.890625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 389.04 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_181803-lswl775p[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_181803-lswl775p/logs[0m
0: Running global_forecast for 2015-05-11 15:00 ...
0: Wandb run: atmorep-zhjp2q74-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : zhjp2q74
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 15]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.149, max = -0.160, mean = -1.064
0:          sample (first 20): tensor([-0.5758, -0.6323, -0.5965, -0.6675, -0.6102, -0.6372, -0.6758, -0.6655, -0.6252, -0.6164, -0.6292, -0.7153,
0:         -0.5970, -0.6243, -0.6948, -0.6599, -0.7133, -0.6722, -0.7014, -0.7187])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005546915344893932
0: validation loss for velocity_v : 0.000823221926111728
0: validation loss for specific_humidity : 1.852103196142707e-05
0: validation loss for velocity_z : 0.0011847499990835786
0: validation loss for temperature : 45603.34375
0: validation loss for total_precip : 0.00038463337114080787
0: validation loss for t2m : 78077.8203125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 396.56 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_182441-zhjp2q74[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_182441-zhjp2q74/logs[0m
0: Running global_forecast for 2015-05-11 16:00 ...
0: Wandb run: atmorep-f7ji1j9q-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : f7ji1j9q
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 16]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.151, max = -0.159, mean = -1.067
0:          sample (first 20): tensor([-0.5773, -0.6334, -0.5981, -0.6687, -0.6115, -0.6384, -0.6777, -0.6666, -0.6264, -0.6178, -0.6306, -0.7170,
0:         -0.5989, -0.6260, -0.6964, -0.6614, -0.7150, -0.6737, -0.7028, -0.7204])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005316815222613513
0: validation loss for velocity_v : 0.0008248616359196603
0: validation loss for specific_humidity : 1.8410793927614577e-05
0: validation loss for velocity_z : 0.0011748418910428882
0: validation loss for temperature : 45597.0703125
0: validation loss for total_precip : 0.00037751084892079234
0: validation loss for t2m : 78077.7734375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 445.24 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_183133-f7ji1j9q[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_183133-f7ji1j9q/logs[0m
0: Running global_forecast for 2015-05-11 17:00 ...
0: Wandb run: atmorep-kq9g081l-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : kq9g081l
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 17]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.152, max = -0.158, mean = -1.069
0:          sample (first 20): tensor([-0.5783, -0.6348, -0.5999, -0.6697, -0.6125, -0.6395, -0.6796, -0.6677, -0.6273, -0.6190, -0.6318, -0.7182,
0:         -0.6004, -0.6272, -0.6975, -0.6627, -0.7165, -0.6751, -0.7038, -0.7214])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000510911806486547
0: validation loss for velocity_v : 0.0008271444239653647
0: validation loss for specific_humidity : 1.8307080608792603e-05
0: validation loss for velocity_z : 0.001165130059234798
0: validation loss for temperature : 45590.8515625
0: validation loss for total_precip : 0.0003702607355080545
0: validation loss for t2m : 78077.7421875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 445.73 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_183910-kq9g081l[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_183910-kq9g081l/logs[0m
0: Running global_forecast for 2015-05-11 18:00 ...
0: Wandb run: atmorep-khu310qo-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : khu310qo
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 18]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.154, max = -0.158, mean = -1.072
0:          sample (first 20): tensor([-0.5781, -0.6355, -0.5991, -0.6696, -0.6125, -0.6398, -0.6790, -0.6680, -0.6274, -0.6189, -0.6322, -0.7183,
0:         -0.6001, -0.6273, -0.6974, -0.6629, -0.7163, -0.6755, -0.7045, -0.7217])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005436813225969672
0: validation loss for velocity_v : 0.0008254977292381227
0: validation loss for specific_humidity : 1.839744254539255e-05
0: validation loss for velocity_z : 0.0011689800303429365
0: validation loss for temperature : 45591.98828125
0: validation loss for total_precip : 0.0003880529257003218
0: validation loss for t2m : 78077.7265625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 418.65 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_184650-khu310qo[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_184650-khu310qo/logs[0m
0: Running global_forecast for 2015-05-11 19:00 ...
0: Wandb run: atmorep-7naa3pw1-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 7naa3pw1
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 19]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.156, max = -0.157, mean = -1.074
0:          sample (first 20): tensor([-0.5790, -0.6365, -0.6003, -0.6708, -0.6135, -0.6405, -0.6806, -0.6688, -0.6284, -0.6199, -0.6331, -0.7193,
0:         -0.6014, -0.6285, -0.6982, -0.6641, -0.7174, -0.6765, -0.7053, -0.7226])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005206571659073234
0: validation loss for velocity_v : 0.0008276394801214337
0: validation loss for specific_humidity : 1.8303320757695474e-05
0: validation loss for velocity_z : 0.0011588898487389088
0: validation loss for temperature : 45585.80078125
0: validation loss for total_precip : 0.0003806533932220191
0: validation loss for t2m : 78077.6875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 334.43 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_185404-7naa3pw1[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_185404-7naa3pw1/logs[0m
0: Running global_forecast for 2015-05-11 20:00 ...
0: Wandb run: atmorep-2kcmav38-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 2kcmav38
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 20]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.158, max = -0.156, mean = -1.077
0:          sample (first 20): tensor([-0.5815, -0.6386, -0.6032, -0.6731, -0.6157, -0.6425, -0.6835, -0.6710, -0.6308, -0.6223, -0.6354, -0.7219,
0:         -0.6043, -0.6310, -0.7011, -0.6667, -0.7199, -0.6790, -0.7077, -0.7248])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005000629462301731
0: validation loss for velocity_v : 0.0008307019015774131
0: validation loss for specific_humidity : 1.8224336599814706e-05
0: validation loss for velocity_z : 0.0011492057237774134
0: validation loss for temperature : 45579.73046875
0: validation loss for total_precip : 0.0003732202749233693
0: validation loss for t2m : 78077.65625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 397.62 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_185953-2kcmav38[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_185953-2kcmav38/logs[0m
0: Running global_forecast for 2015-05-11 21:00 ...
0: Wandb run: atmorep-45g7soxt-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 45g7soxt
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 21]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.159, max = -0.157, mean = -1.080
0:          sample (first 20): tensor([-0.5793, -0.6371, -0.6007, -0.6715, -0.6141, -0.6409, -0.6809, -0.6696, -0.6288, -0.6206, -0.6337, -0.7204,
0:         -0.6017, -0.6287, -0.6988, -0.6646, -0.7180, -0.6771, -0.7060, -0.7231])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005691397236660123
0: validation loss for velocity_v : 0.0007912647561170161
0: validation loss for specific_humidity : 1.8101522073266096e-05
0: validation loss for velocity_z : 0.001166598405689001
0: validation loss for temperature : 45580.75390625
0: validation loss for total_precip : 0.00038900264189578593
0: validation loss for t2m : 78077.5703125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 403.07 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_190644-45g7soxt[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_190644-45g7soxt/logs[0m
0: Running global_forecast for 2015-05-11 22:00 ...
0: Wandb run: atmorep-2wg3e9w1-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 2wg3e9w1
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 22]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.160, max = -0.156, mean = -1.083
0:          sample (first 20): tensor([-0.5796, -0.6370, -0.6013, -0.6715, -0.6141, -0.6408, -0.6816, -0.6698, -0.6287, -0.6209, -0.6336, -0.7204,
0:         -0.6023, -0.6287, -0.6991, -0.6647, -0.7184, -0.6772, -0.7060, -0.7231])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005439748056232929
0: validation loss for velocity_v : 0.0007928182603791356
0: validation loss for specific_humidity : 1.803255690902006e-05
0: validation loss for velocity_z : 0.0011567818000912666
0: validation loss for temperature : 45574.89453125
0: validation loss for total_precip : 0.00038161652628332376
0: validation loss for t2m : 78077.5390625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 385.49 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_191335-2wg3e9w1[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_191335-2wg3e9w1/logs[0m
0: Running global_forecast for 2015-05-11 23:00 ...
0: Wandb run: atmorep-zgencyx3-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : zgencyx3
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 11, 23]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.161, max = -0.156, mean = -1.085
0:          sample (first 20): tensor([-0.5806, -0.6383, -0.6031, -0.6725, -0.6152, -0.6419, -0.6833, -0.6703, -0.6297, -0.6221, -0.6349, -0.7217,
0:         -0.6037, -0.6303, -0.7002, -0.6660, -0.7197, -0.6789, -0.7074, -0.7244])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000521334819495678
0: validation loss for velocity_v : 0.0007950235740281641
0: validation loss for specific_humidity : 1.7968497559195384e-05
0: validation loss for velocity_z : 0.0011473177000880241
0: validation loss for temperature : 45569.01171875
0: validation loss for total_precip : 0.0003743116685654968
0: validation loss for t2m : 78077.4921875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 400.52 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_192015-zgencyx3[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_192015-zgencyx3/logs[0m
0: Running global_forecast for 2015-05-12 00:00 ...
0: Wandb run: atmorep-bsvfporp-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : bsvfporp
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 0]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.106, max = -0.165, mean = -1.028
0:          sample (first 20): tensor([-0.5673, -0.6212, -0.5876, -0.6578, -0.6003, -0.6279, -0.6639, -0.6555, -0.6160, -0.6053, -0.6189, -0.7041,
0:         -0.5862, -0.6144, -0.6847, -0.6489, -0.7031, -0.6595, -0.6907, -0.7089])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007695021340623498
0: validation loss for velocity_v : 0.0008157934644259512
0: validation loss for specific_humidity : 1.7899439626489766e-05
0: validation loss for velocity_z : 0.0013287955662235618
0: validation loss for temperature : 45667.62109375
0: validation loss for total_precip : 0.0004376317374408245
0: validation loss for t2m : 78078.609375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 415.21 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_192709-bsvfporp[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_192709-bsvfporp/logs[0m
0: Running global_forecast for 2015-05-12 01:00 ...
0: Wandb run: atmorep-d1qjcd6c-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : d1qjcd6c
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 1]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.110, max = -0.164, mean = -1.031
0:          sample (first 20): tensor([-0.5682, -0.6220, -0.5892, -0.6589, -0.6014, -0.6287, -0.6657, -0.6562, -0.6171, -0.6063, -0.6200, -0.7050,
0:         -0.5874, -0.6156, -0.6857, -0.6500, -0.7042, -0.6604, -0.6919, -0.7099])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007372591062448919
0: validation loss for velocity_v : 0.0008141128346323967
0: validation loss for specific_humidity : 1.774104021023959e-05
0: validation loss for velocity_z : 0.001316408975981176
0: validation loss for temperature : 45660.24609375
0: validation loss for total_precip : 0.0004290603392291814
0: validation loss for t2m : 78078.5625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 412.44 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_193418-d1qjcd6c[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_193418-d1qjcd6c/logs[0m
0: Running global_forecast for 2015-05-12 02:00 ...
0: Wandb run: atmorep-xte8kjee-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : xte8kjee
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 2]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.112, max = -0.162, mean = -1.033
0:          sample (first 20): tensor([-0.5680, -0.6216, -0.5892, -0.6587, -0.6012, -0.6287, -0.6660, -0.6559, -0.6169, -0.6063, -0.6196, -0.7049,
0:         -0.5874, -0.6156, -0.6857, -0.6498, -0.7043, -0.6603, -0.6913, -0.7099])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007072019507177174
0: validation loss for velocity_v : 0.000813047110568732
0: validation loss for specific_humidity : 1.7615438991924748e-05
0: validation loss for velocity_z : 0.0013041074853390455
0: validation loss for temperature : 45653.015625
0: validation loss for total_precip : 0.0004205019795335829
0: validation loss for t2m : 78078.5234375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 417.15 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_194123-xte8kjee[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_194123-xte8kjee/logs[0m
0: Running global_forecast for 2015-05-12 03:00 ...
0: Wandb run: atmorep-0gg8s6qd-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 0gg8s6qd
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 3]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.117, max = -0.163, mean = -1.037
0:          sample (first 20): tensor([-0.5697, -0.6246, -0.5906, -0.6612, -0.6035, -0.6311, -0.6677, -0.6588, -0.6191, -0.6087, -0.6222, -0.7081,
0:         -0.5896, -0.6177, -0.6883, -0.6527, -0.7068, -0.6635, -0.6943, -0.7124])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005275061121210456
0: validation loss for velocity_v : 0.0007967684068717062
0: validation loss for specific_humidity : 1.8880300558521412e-05
0: validation loss for velocity_z : 0.001221314538270235
0: validation loss for temperature : 45651.78125
0: validation loss for total_precip : 0.0003738722880370915
0: validation loss for t2m : 78078.5
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 320.15 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_194827-0gg8s6qd[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_194827-0gg8s6qd/logs[0m
0: Running global_forecast for 2015-05-12 04:00 ...
0: Wandb run: atmorep-5o0q95rf-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 5o0q95rf
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 4]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.123, max = -0.162, mean = -1.039
0:          sample (first 20): tensor([-0.5708, -0.6255, -0.5917, -0.6620, -0.6045, -0.6319, -0.6693, -0.6592, -0.6199, -0.6095, -0.6232, -0.7090,
0:         -0.5909, -0.6189, -0.6894, -0.6534, -0.7078, -0.6646, -0.6953, -0.7134])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005071711493656039
0: validation loss for velocity_v : 0.0007997188367880881
0: validation loss for specific_humidity : 1.8723068933468312e-05
0: validation loss for velocity_z : 0.0012105170171707869
0: validation loss for temperature : 45644.62109375
0: validation loss for total_precip : 0.0003664909745566547
0: validation loss for t2m : 78078.4453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 434.37 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_195402-5o0q95rf[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_195402-5o0q95rf/logs[0m
0: Running global_forecast for 2015-05-12 05:00 ...
0: Wandb run: atmorep-yyicdmlc-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : yyicdmlc
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 5]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.124, max = -0.161, mean = -1.042
0:          sample (first 20): tensor([-0.5719, -0.6266, -0.5934, -0.6630, -0.6055, -0.6329, -0.6709, -0.6602, -0.6211, -0.6108, -0.6240, -0.7102,
0:         -0.5923, -0.6201, -0.6906, -0.6549, -0.7087, -0.6657, -0.6961, -0.7143])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0004887576214969158
0: validation loss for velocity_v : 0.00080427824286744
0: validation loss for specific_humidity : 1.8580167306936346e-05
0: validation loss for velocity_z : 0.0012000035494565964
0: validation loss for temperature : 45637.6328125
0: validation loss for total_precip : 0.0003592361172195524
0: validation loss for t2m : 78078.3828125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 434.83 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_200131-yyicdmlc[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_200131-yyicdmlc/logs[0m
0: Running global_forecast for 2015-05-12 06:00 ...
0: Wandb run: atmorep-uofs5dm4-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : uofs5dm4
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 6]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.129, max = -0.161, mean = -1.044
0:          sample (first 20): tensor([-0.5719, -0.6273, -0.5923, -0.6635, -0.6056, -0.6330, -0.6702, -0.6614, -0.6211, -0.6108, -0.6244, -0.7105,
0:         -0.5922, -0.6205, -0.6905, -0.6548, -0.7090, -0.6663, -0.6968, -0.7146])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005264461506158113
0: validation loss for velocity_v : 0.0008015301427803934
0: validation loss for specific_humidity : 1.8649090634426102e-05
0: validation loss for velocity_z : 0.0012041497975587845
0: validation loss for temperature : 45639.03125
0: validation loss for total_precip : 0.0003807545581366867
0: validation loss for t2m : 78078.3515625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 401.91 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_200900-uofs5dm4[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_200900-uofs5dm4/logs[0m
0: Running global_forecast for 2015-05-12 07:00 ...
0: Wandb run: atmorep-mbsmjd7c-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : mbsmjd7c
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 7]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.131, max = -0.161, mean = -1.047
0:          sample (first 20): tensor([-0.5733, -0.6284, -0.5942, -0.6648, -0.6073, -0.6345, -0.6723, -0.6626, -0.6227, -0.6126, -0.6260, -0.7120,
0:         -0.5944, -0.6221, -0.6923, -0.6564, -0.7106, -0.6682, -0.6982, -0.7165])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005058597307652235
0: validation loss for velocity_v : 0.0008049894822761416
0: validation loss for specific_humidity : 1.8499817088013515e-05
0: validation loss for velocity_z : 0.0011934684589505196
0: validation loss for temperature : 45632.15234375
0: validation loss for total_precip : 0.00037344059091992676
0: validation loss for t2m : 78078.3125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 401.38 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_201555-mbsmjd7c[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_201555-mbsmjd7c/logs[0m
0: Running global_forecast for 2015-05-12 08:00 ...
0: Wandb run: atmorep-cz7vsx25-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : cz7vsx25
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 8]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.134, max = -0.160, mean = -1.049
0:          sample (first 20): tensor([-0.5745, -0.6295, -0.5956, -0.6655, -0.6081, -0.6354, -0.6736, -0.6631, -0.6234, -0.6135, -0.6269, -0.7132,
0:         -0.5955, -0.6230, -0.6932, -0.6573, -0.7118, -0.6692, -0.6992, -0.7172])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.00048747361870482564
0: validation loss for velocity_v : 0.0008091988856904209
0: validation loss for specific_humidity : 1.8361946786171757e-05
0: validation loss for velocity_z : 0.0011831599986180663
0: validation loss for temperature : 45625.37109375
0: validation loss for total_precip : 0.0003661655937321484
0: validation loss for t2m : 78078.2734375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 459.47 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_202249-cz7vsx25[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_202249-cz7vsx25/logs[0m
0: Running global_forecast for 2015-05-12 09:00 ...
0: Wandb run: atmorep-6jqzurqq-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 6jqzurqq
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 9]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.136, max = -0.162, mean = -1.052
0:          sample (first 20): tensor([-0.5729, -0.6292, -0.5936, -0.6645, -0.6072, -0.6344, -0.6721, -0.6626, -0.6226, -0.6125, -0.6260, -0.7119,
0:         -0.5937, -0.6214, -0.6920, -0.6563, -0.7105, -0.6682, -0.6982, -0.7162])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005677135195583105
0: validation loss for velocity_v : 0.0007711074431426823
0: validation loss for specific_humidity : 1.8290553271071985e-05
0: validation loss for velocity_z : 0.0011938384268432856
0: validation loss for temperature : 45626.03515625
0: validation loss for total_precip : 0.00038852577563375235
0: validation loss for t2m : 78078.21875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 414.66 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_203050-6jqzurqq[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_203050-6jqzurqq/logs[0m
0: Running global_forecast for 2015-05-12 10:00 ...
0: Wandb run: atmorep-z4oo6zdw-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : z4oo6zdw
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 10]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.140, max = -0.159, mean = -1.054
0:          sample (first 20): tensor([-0.5744, -0.6304, -0.5951, -0.6660, -0.6084, -0.6356, -0.6740, -0.6635, -0.6237, -0.6139, -0.6274, -0.7133,
0:         -0.5952, -0.6228, -0.6932, -0.6577, -0.7119, -0.6698, -0.6994, -0.7174])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005430972087197006
0: validation loss for velocity_v : 0.000773392675910145
0: validation loss for specific_humidity : 1.8169650502386503e-05
0: validation loss for velocity_z : 0.0011834620963782072
0: validation loss for temperature : 45619.40625
0: validation loss for total_precip : 0.0003813409130088985
0: validation loss for t2m : 78078.171875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 414.17 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_203800-z4oo6zdw[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_203800-z4oo6zdw/logs[0m
0: Running global_forecast for 2015-05-12 11:00 ...
0: Wandb run: atmorep-2ktssb2j-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 2ktssb2j
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 11]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.144, max = -0.159, mean = -1.056
0:          sample (first 20): tensor([-0.5747, -0.6305, -0.5961, -0.6663, -0.6086, -0.6356, -0.6746, -0.6638, -0.6238, -0.6146, -0.6275, -0.7140,
0:         -0.5961, -0.6234, -0.6940, -0.6584, -0.7125, -0.6704, -0.6996, -0.7177])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005211859825067222
0: validation loss for velocity_v : 0.0007767956121824682
0: validation loss for specific_humidity : 1.8061578884953633e-05
0: validation loss for velocity_z : 0.0011732617858797312
0: validation loss for temperature : 45612.94921875
0: validation loss for total_precip : 0.0003740980173461139
0: validation loss for t2m : 78078.1171875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 322.20 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_204507-2ktssb2j[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_204507-2ktssb2j/logs[0m
0: Running global_forecast for 2015-05-12 12:00 ...
0: Wandb run: atmorep-dzyhgf6l-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : dzyhgf6l
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 12]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.144, max = -0.160, mean = -1.057
0:          sample (first 20): tensor([-0.5743, -0.6303, -0.5948, -0.6657, -0.6081, -0.6351, -0.6735, -0.6637, -0.6236, -0.6140, -0.6271, -0.7135,
0:         -0.5951, -0.6223, -0.6932, -0.6581, -0.7116, -0.6698, -0.6997, -0.7170])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008018885273486376
0: validation loss for velocity_v : 0.0008203288307413459
0: validation loss for specific_humidity : 1.711797813186422e-05
0: validation loss for velocity_z : 0.001208715490065515
0: validation loss for temperature : 45616.87890625
0: validation loss for total_precip : 0.0003955051361117512
0: validation loss for t2m : 78077.9921875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 408.52 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_205041-dzyhgf6l[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_205041-dzyhgf6l/logs[0m
0: Running global_forecast for 2015-05-12 13:00 ...
0: Wandb run: atmorep-4e2avb97-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 4e2avb97
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 13]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.147, max = -0.160, mean = -1.059
0:          sample (first 20): tensor([-0.5744, -0.6308, -0.5955, -0.6664, -0.6085, -0.6360, -0.6744, -0.6640, -0.6241, -0.6145, -0.6277, -0.7136,
0:         -0.5957, -0.6234, -0.6938, -0.6585, -0.7125, -0.6703, -0.7003, -0.7179])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000767455087043345
0: validation loss for velocity_v : 0.0008196425042115152
0: validation loss for specific_humidity : 1.706186230876483e-05
0: validation loss for velocity_z : 0.0011984847951680422
0: validation loss for temperature : 45610.48828125
0: validation loss for total_precip : 0.00038787099765613675
0: validation loss for t2m : 78077.9453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 387.07 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_205737-4e2avb97[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_205737-4e2avb97/logs[0m
0: Running global_forecast for 2015-05-12 14:00 ...
0: Wandb run: atmorep-3b8js79i-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 3b8js79i
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 14]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.149, max = -0.159, mean = -1.062
0:          sample (first 20): tensor([-0.5753, -0.6311, -0.5965, -0.6667, -0.6092, -0.6363, -0.6754, -0.6646, -0.6245, -0.6153, -0.6281, -0.7146,
0:         -0.5968, -0.6237, -0.6945, -0.6591, -0.7132, -0.6708, -0.7005, -0.7181])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007356040878221393
0: validation loss for velocity_v : 0.0008198313880711794
0: validation loss for specific_humidity : 1.7020493032759987e-05
0: validation loss for velocity_z : 0.0011885950807482004
0: validation loss for temperature : 45604.03515625
0: validation loss for total_precip : 0.00038039693026803434
0: validation loss for t2m : 78077.90625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 391.92 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_210418-3b8js79i[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_210418-3b8js79i/logs[0m
0: Running global_forecast for 2015-05-12 15:00 ...
0: Wandb run: atmorep-epjou6zj-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : epjou6zj
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 15]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.149, max = -0.160, mean = -1.064
0:          sample (first 20): tensor([-0.5755, -0.6322, -0.5963, -0.6672, -0.6100, -0.6370, -0.6755, -0.6650, -0.6250, -0.6160, -0.6290, -0.7153,
0:         -0.5968, -0.6240, -0.6948, -0.6595, -0.7134, -0.6721, -0.7013, -0.7185])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005546749453060329
0: validation loss for velocity_v : 0.0008233182015828788
0: validation loss for specific_humidity : 1.851747219916433e-05
0: validation loss for velocity_z : 0.0011847048299387097
0: validation loss for temperature : 45603.33203125
0: validation loss for total_precip : 0.00038473037420772016
0: validation loss for t2m : 78077.828125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 400.45 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_211104-epjou6zj[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_211104-epjou6zj/logs[0m
0: Running global_forecast for 2015-05-12 16:00 ...
0: Wandb run: atmorep-5p5ojpad-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 5p5ojpad
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 16]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.151, max = -0.159, mean = -1.067
0:          sample (first 20): tensor([-0.5762, -0.6327, -0.5973, -0.6677, -0.6106, -0.6376, -0.6765, -0.6658, -0.6255, -0.6168, -0.6297, -0.7161,
0:         -0.5980, -0.6252, -0.6954, -0.6603, -0.7141, -0.6727, -0.7019, -0.7195])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005316473543643951
0: validation loss for velocity_v : 0.0008247093064710498
0: validation loss for specific_humidity : 1.8408791220281273e-05
0: validation loss for velocity_z : 0.001174679957330227
0: validation loss for temperature : 45597.0
0: validation loss for total_precip : 0.0003775408258661628
0: validation loss for t2m : 78077.7734375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 411.72 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_211758-5p5ojpad[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_211758-5p5ojpad/logs[0m
0: Running global_forecast for 2015-05-12 17:00 ...
0: Wandb run: atmorep-njfv6hkd-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : njfv6hkd
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 17]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.153, max = -0.158, mean = -1.069
0:          sample (first 20): tensor([-0.5783, -0.6346, -0.5999, -0.6697, -0.6123, -0.6396, -0.6795, -0.6673, -0.6274, -0.6189, -0.6317, -0.7182,
0:         -0.6004, -0.6269, -0.6973, -0.6627, -0.7162, -0.6748, -0.7036, -0.7213])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005109208286739886
0: validation loss for velocity_v : 0.0008272382547147572
0: validation loss for specific_humidity : 1.8305834601051174e-05
0: validation loss for velocity_z : 0.0011650436790660024
0: validation loss for temperature : 45590.83203125
0: validation loss for total_precip : 0.0003703881520777941
0: validation loss for t2m : 78077.7421875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 412.96 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_212506-njfv6hkd[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_212506-njfv6hkd/logs[0m
0: Running global_forecast for 2015-05-12 18:00 ...
0: Wandb run: atmorep-zt1646fw-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : zt1646fw
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 18]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.154, max = -0.158, mean = -1.071
0:          sample (first 20): tensor([-0.5770, -0.6347, -0.5980, -0.6687, -0.6117, -0.6384, -0.6777, -0.6671, -0.6265, -0.6178, -0.6309, -0.7172,
0:         -0.5988, -0.6263, -0.6961, -0.6617, -0.7152, -0.6743, -0.7034, -0.7205])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005437578656710684
0: validation loss for velocity_v : 0.0008256763685494661
0: validation loss for specific_humidity : 1.83951087819878e-05
0: validation loss for velocity_z : 0.0011688158847391605
0: validation loss for temperature : 45592.00390625
0: validation loss for total_precip : 0.000388098880648613
0: validation loss for t2m : 78077.7265625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 417.15 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_213212-zt1646fw[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_213212-zt1646fw/logs[0m
0: Running global_forecast for 2015-05-12 19:00 ...
0: Wandb run: atmorep-8oauhdf0-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 8oauhdf0
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 19]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.156, max = -0.157, mean = -1.074
0:          sample (first 20): tensor([-0.5788, -0.6360, -0.6003, -0.6705, -0.6132, -0.6401, -0.6800, -0.6683, -0.6283, -0.6198, -0.6329, -0.7190,
0:         -0.6010, -0.6281, -0.6982, -0.6637, -0.7172, -0.6758, -0.7050, -0.7225])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005207004141993821
0: validation loss for velocity_v : 0.0008276095613837242
0: validation loss for specific_humidity : 1.8299639123142697e-05
0: validation loss for velocity_z : 0.001158911851234734
0: validation loss for temperature : 45585.765625
0: validation loss for total_precip : 0.00038071259041316807
0: validation loss for t2m : 78077.7109375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 309.78 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_213918-8oauhdf0[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_213918-8oauhdf0/logs[0m
0: Running global_forecast for 2015-05-12 20:00 ...
0: Wandb run: atmorep-ig4r53tm-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : ig4r53tm
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 20]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.158, max = -0.155, mean = -1.078
0:          sample (first 20): tensor([-0.5807, -0.6377, -0.6024, -0.6725, -0.6150, -0.6419, -0.6828, -0.6702, -0.6302, -0.6215, -0.6346, -0.7212,
0:         -0.6035, -0.6301, -0.7004, -0.6657, -0.7193, -0.6782, -0.7070, -0.7242])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005000311648473144
0: validation loss for velocity_v : 0.0008306389208883047
0: validation loss for specific_humidity : 1.8223108781967312e-05
0: validation loss for velocity_z : 0.0011491607874631882
0: validation loss for temperature : 45579.71875
0: validation loss for total_precip : 0.00037325607263483107
0: validation loss for t2m : 78077.640625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 427.04 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_214436-ig4r53tm[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_214436-ig4r53tm/logs[0m
0: Running global_forecast for 2015-05-12 21:00 ...
0: Wandb run: atmorep-6rdpsruh-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 6rdpsruh
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 21]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.158, max = -0.157, mean = -1.080
0:          sample (first 20): tensor([-0.5792, -0.6370, -0.6002, -0.6711, -0.6137, -0.6407, -0.6805, -0.6696, -0.6287, -0.6205, -0.6333, -0.7201,
0:         -0.6016, -0.6286, -0.6984, -0.6642, -0.7180, -0.6767, -0.7059, -0.7229])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005691705155186355
0: validation loss for velocity_v : 0.000791356258559972
0: validation loss for specific_humidity : 1.8099270164384507e-05
0: validation loss for velocity_z : 0.0011665176134556532
0: validation loss for temperature : 45580.69921875
0: validation loss for total_precip : 0.00038903614040464163
0: validation loss for t2m : 78077.5859375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 405.62 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_215158-6rdpsruh[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_215158-6rdpsruh/logs[0m
0: Running global_forecast for 2015-05-12 22:00 ...
0: Wandb run: atmorep-mx1aem6r-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : mx1aem6r
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 22]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.159, max = -0.156, mean = -1.082
0:          sample (first 20): tensor([-0.5797, -0.6373, -0.6017, -0.6720, -0.6144, -0.6413, -0.6818, -0.6698, -0.6291, -0.6211, -0.6340, -0.7206,
0:         -0.6025, -0.6290, -0.6992, -0.6649, -0.7185, -0.6777, -0.7064, -0.7237])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005439462256617844
0: validation loss for velocity_v : 0.0007928211707621813
0: validation loss for specific_humidity : 1.802743281587027e-05
0: validation loss for velocity_z : 0.0011566190514713526
0: validation loss for temperature : 45574.86328125
0: validation loss for total_precip : 0.000381652353098616
0: validation loss for t2m : 78077.53125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 440.59 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_215857-mx1aem6r[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_215857-mx1aem6r/logs[0m
0: Running global_forecast for 2015-05-12 23:00 ...
0: Wandb run: atmorep-zazxkq45-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : zazxkq45
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 12, 23]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.161, max = -0.156, mean = -1.085
0:          sample (first 20): tensor([-0.5804, -0.6381, -0.6028, -0.6724, -0.6150, -0.6417, -0.6829, -0.6704, -0.6296, -0.6218, -0.6347, -0.7217,
0:         -0.6036, -0.6301, -0.7002, -0.6658, -0.7195, -0.6785, -0.7072, -0.7242])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005213276599533856
0: validation loss for velocity_v : 0.0007950704894028604
0: validation loss for specific_humidity : 1.796816650312394e-05
0: validation loss for velocity_z : 0.001147079048678279
0: validation loss for temperature : 45569.046875
0: validation loss for total_precip : 0.0003744211862795055
0: validation loss for t2m : 78077.5
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 400.30 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_220631-zazxkq45[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_220631-zazxkq45/logs[0m
0: Running global_forecast for 2015-05-13 00:00 ...
0: Wandb run: atmorep-15yha4ch-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 15yha4ch
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 0]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.105, max = -0.164, mean = -1.028
0:          sample (first 20): tensor([-0.5679, -0.6220, -0.5884, -0.6587, -0.6014, -0.6287, -0.6652, -0.6562, -0.6170, -0.6061, -0.6198, -0.7047,
0:         -0.5870, -0.6151, -0.6856, -0.6501, -0.7038, -0.6601, -0.6912, -0.7097])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007694854866713285
0: validation loss for velocity_v : 0.0008158630807884037
0: validation loss for specific_humidity : 1.789618909242563e-05
0: validation loss for velocity_z : 0.0013286775210872293
0: validation loss for temperature : 45667.5625
0: validation loss for total_precip : 0.00043772620847448707
0: validation loss for t2m : 78078.609375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 414.68 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_221324-15yha4ch[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_221324-15yha4ch/logs[0m
0: Running global_forecast for 2015-05-13 01:00 ...
0: Wandb run: atmorep-1z65smx7-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 1z65smx7
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 1]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.110, max = -0.164, mean = -1.031
0:          sample (first 20): tensor([-0.5683, -0.6222, -0.5888, -0.6593, -0.6018, -0.6289, -0.6661, -0.6565, -0.6175, -0.6064, -0.6201, -0.7054,
0:         -0.5877, -0.6158, -0.6862, -0.6503, -0.7047, -0.6608, -0.6920, -0.7100])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007372639374807477
0: validation loss for velocity_v : 0.0008141751168295741
0: validation loss for specific_humidity : 1.773414624040015e-05
0: validation loss for velocity_z : 0.0013162926770746708
0: validation loss for temperature : 45660.1796875
0: validation loss for total_precip : 0.00042910114279948175
0: validation loss for t2m : 78078.5625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 434.24 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_222034-1z65smx7[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_222034-1z65smx7/logs[0m
0: Running global_forecast for 2015-05-13 02:00 ...
0: Wandb run: atmorep-p0phah01-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : p0phah01
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 2]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.113, max = -0.163, mean = -1.033
0:          sample (first 20): tensor([-0.5691, -0.6227, -0.5900, -0.6597, -0.6022, -0.6296, -0.6670, -0.6565, -0.6179, -0.6073, -0.6206, -0.7060,
0:         -0.5885, -0.6167, -0.6865, -0.6509, -0.7052, -0.6613, -0.6922, -0.7108])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007071428117342293
0: validation loss for velocity_v : 0.0008130354690365493
0: validation loss for specific_humidity : 1.7615033357287757e-05
0: validation loss for velocity_z : 0.0013039873447269201
0: validation loss for temperature : 45652.99609375
0: validation loss for total_precip : 0.000420562137151137
0: validation loss for t2m : 78078.53125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 407.84 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_222801-p0phah01[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_222801-p0phah01/logs[0m
0: Running global_forecast for 2015-05-13 03:00 ...
0: Wandb run: atmorep-zusn50ke-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : zusn50ke
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 3]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.117, max = -0.162, mean = -1.037
0:          sample (first 20): tensor([-0.5700, -0.6250, -0.5908, -0.6612, -0.6037, -0.6313, -0.6679, -0.6587, -0.6191, -0.6089, -0.6222, -0.7081,
0:         -0.5897, -0.6179, -0.6884, -0.6528, -0.7070, -0.6636, -0.6942, -0.7123])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005275164148770273
0: validation loss for velocity_v : 0.0007967384881339967
0: validation loss for specific_humidity : 1.887997132143937e-05
0: validation loss for velocity_z : 0.001221256097778678
0: validation loss for temperature : 45651.77734375
0: validation loss for total_precip : 0.0003738664381671697
0: validation loss for t2m : 78078.484375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 391.63 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_223501-zusn50ke[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_223501-zusn50ke/logs[0m
0: Running global_forecast for 2015-05-13 04:00 ...
0: Wandb run: atmorep-32oshhmj-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 32oshhmj
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 4]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.123, max = -0.162, mean = -1.040
0:          sample (first 20): tensor([-0.5706, -0.6256, -0.5914, -0.6617, -0.6042, -0.6318, -0.6691, -0.6591, -0.6198, -0.6094, -0.6229, -0.7088,
0:         -0.5908, -0.6187, -0.6891, -0.6532, -0.7075, -0.6642, -0.6951, -0.7131])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005071705090813339
0: validation loss for velocity_v : 0.0007998474757187068
0: validation loss for specific_humidity : 1.872033317340538e-05
0: validation loss for velocity_z : 0.001210344722494483
0: validation loss for temperature : 45644.62109375
0: validation loss for total_precip : 0.0003665599797386676
0: validation loss for t2m : 78078.4453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 409.41 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_224145-32oshhmj[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_224145-32oshhmj/logs[0m
0: Running global_forecast for 2015-05-13 05:00 ...
0: Wandb run: atmorep-6magrz2e-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 6magrz2e
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 5]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.124, max = -0.160, mean = -1.043
0:          sample (first 20): tensor([-0.5725, -0.6271, -0.5939, -0.6638, -0.6060, -0.6334, -0.6716, -0.6607, -0.6216, -0.6115, -0.6247, -0.7110,
0:         -0.5931, -0.6207, -0.6910, -0.6554, -0.7097, -0.6665, -0.6968, -0.7150])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000488758145365864
0: validation loss for velocity_v : 0.0008041627588681877
0: validation loss for specific_humidity : 1.8578832168714143e-05
0: validation loss for velocity_z : 0.0011998964473605156
0: validation loss for temperature : 45637.5625
0: validation loss for total_precip : 0.000359251513145864
0: validation loss for t2m : 78078.375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 402.84 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_224848-6magrz2e[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_224848-6magrz2e/logs[0m
0: Running global_forecast for 2015-05-13 06:00 ...
0: Wandb run: atmorep-83r5igm3-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 83r5igm3
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 6]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.127, max = -0.162, mean = -1.045
0:          sample (first 20): tensor([-0.5724, -0.6281, -0.5930, -0.6642, -0.6062, -0.6337, -0.6710, -0.6619, -0.6219, -0.6115, -0.6254, -0.7111,
0:         -0.5931, -0.6210, -0.6912, -0.6557, -0.7095, -0.6671, -0.6973, -0.7152])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005264281644485891
0: validation loss for velocity_v : 0.000801672285888344
0: validation loss for specific_humidity : 1.8651140635483898e-05
0: validation loss for velocity_z : 0.0012041011359542608
0: validation loss for temperature : 45638.9375
0: validation loss for total_precip : 0.00038079716614447534
0: validation loss for t2m : 78078.3515625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 407.42 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_225545-83r5igm3[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_225545-83r5igm3/logs[0m
0: Running global_forecast for 2015-05-13 07:00 ...
0: Wandb run: atmorep-wlqc6fjb-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : wlqc6fjb
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 7]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.131, max = -0.161, mean = -1.047
0:          sample (first 20): tensor([-0.5727, -0.6279, -0.5937, -0.6643, -0.6065, -0.6340, -0.6716, -0.6618, -0.6219, -0.6118, -0.6254, -0.7113,
0:         -0.5937, -0.6211, -0.6915, -0.6558, -0.7101, -0.6673, -0.6974, -0.7155])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005058644455857575
0: validation loss for velocity_v : 0.0008049955358728766
0: validation loss for specific_humidity : 1.8499760699342005e-05
0: validation loss for velocity_z : 0.0011933171190321445
0: validation loss for temperature : 45632.15234375
0: validation loss for total_precip : 0.00037341666757129133
0: validation loss for t2m : 78078.3046875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 381.14 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_230241-wlqc6fjb[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_230241-wlqc6fjb/logs[0m
0: Running global_forecast for 2015-05-13 08:00 ...
0: Wandb run: atmorep-tpvjwt7k-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : tpvjwt7k
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 8]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.133, max = -0.160, mean = -1.049
0:          sample (first 20): tensor([-0.5736, -0.6285, -0.5948, -0.6645, -0.6071, -0.6345, -0.6729, -0.6627, -0.6226, -0.6128, -0.6261, -0.7122,
0:         -0.5944, -0.6222, -0.6923, -0.6565, -0.7111, -0.6681, -0.6983, -0.7163])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.00048749582492746413
0: validation loss for velocity_v : 0.000809037999715656
0: validation loss for specific_humidity : 1.8362719856668264e-05
0: validation loss for velocity_z : 0.0011830831645056605
0: validation loss for temperature : 45625.34375
0: validation loss for total_precip : 0.00036621425533667207
0: validation loss for t2m : 78078.2578125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 443.93 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_230915-tpvjwt7k[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_230915-tpvjwt7k/logs[0m
0: Running global_forecast for 2015-05-13 09:00 ...
0: Wandb run: atmorep-q1zsjok2-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : q1zsjok2
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 9]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.137, max = -0.162, mean = -1.052
0:          sample (first 20): tensor([-0.5735, -0.6294, -0.5943, -0.6649, -0.6076, -0.6348, -0.6725, -0.6629, -0.6230, -0.6129, -0.6265, -0.7125,
0:         -0.5942, -0.6219, -0.6926, -0.6568, -0.7109, -0.6689, -0.6985, -0.7166])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005677688168361783
0: validation loss for velocity_v : 0.0007711763610132039
0: validation loss for specific_humidity : 1.8290649677510373e-05
0: validation loss for velocity_z : 0.0011938344687223434
0: validation loss for temperature : 45626.0546875
0: validation loss for total_precip : 0.00038857973413541913
0: validation loss for t2m : 78078.21875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 433.04 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_231654-q1zsjok2[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_231654-q1zsjok2/logs[0m
0: Running global_forecast for 2015-05-13 10:00 ...
0: Wandb run: atmorep-a252yvvb-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : a252yvvb
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 10]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.140, max = -0.160, mean = -1.054
0:          sample (first 20): tensor([-0.5742, -0.6302, -0.5952, -0.6658, -0.6083, -0.6353, -0.6736, -0.6634, -0.6236, -0.6139, -0.6271, -0.7133,
0:         -0.5951, -0.6227, -0.6932, -0.6575, -0.7116, -0.6695, -0.6992, -0.7173])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005431693862192333
0: validation loss for velocity_v : 0.0007734642131254077
0: validation loss for specific_humidity : 1.8169068425777368e-05
0: validation loss for velocity_z : 0.0011834459146484733
0: validation loss for temperature : 45619.421875
0: validation loss for total_precip : 0.00038139469688758254
0: validation loss for t2m : 78078.1796875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 443.12 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_232423-a252yvvb[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_232423-a252yvvb/logs[0m
0: Running global_forecast for 2015-05-13 11:00 ...
0: Wandb run: atmorep-h1alfb8b-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : h1alfb8b
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 11]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.143, max = -0.160, mean = -1.057
0:          sample (first 20): tensor([-0.5744, -0.6301, -0.5956, -0.6658, -0.6085, -0.6353, -0.6743, -0.6634, -0.6236, -0.6145, -0.6273, -0.7136,
0:         -0.5957, -0.6232, -0.6936, -0.6581, -0.7120, -0.6700, -0.6994, -0.7175])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000521213689353317
0: validation loss for velocity_v : 0.0007767296629026532
0: validation loss for specific_humidity : 1.8059829017147422e-05
0: validation loss for velocity_z : 0.0011731021804735065
0: validation loss for temperature : 45612.8984375
0: validation loss for total_precip : 0.0003741754626389593
0: validation loss for t2m : 78078.109375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 401.22 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_233200-h1alfb8b[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_233200-h1alfb8b/logs[0m
0: Running global_forecast for 2015-05-13 12:00 ...
0: Wandb run: atmorep-qxku3fcs-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : qxku3fcs
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 12]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.143, max = -0.160, mean = -1.057
0:          sample (first 20): tensor([-0.5739, -0.6303, -0.5947, -0.6655, -0.6083, -0.6354, -0.6736, -0.6637, -0.6236, -0.6140, -0.6272, -0.7132,
0:         -0.5949, -0.6225, -0.6930, -0.6579, -0.7114, -0.6698, -0.6998, -0.7171])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008018327644094825
0: validation loss for velocity_v : 0.0008204019977711141
0: validation loss for specific_humidity : 1.7117314200731926e-05
0: validation loss for velocity_z : 0.0012085845228284597
0: validation loss for temperature : 45616.85546875
0: validation loss for total_precip : 0.0003955346764996648
0: validation loss for t2m : 78077.9921875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 418.43 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_233849-qxku3fcs[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_233849-qxku3fcs/logs[0m
0: Running global_forecast for 2015-05-13 13:00 ...
0: Wandb run: atmorep-jhucjl7r-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : jhucjl7r
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 13]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.146, max = -0.159, mean = -1.059
0:          sample (first 20): tensor([-0.5742, -0.6305, -0.5955, -0.6659, -0.6085, -0.6356, -0.6741, -0.6639, -0.6239, -0.6144, -0.6275, -0.7136,
0:         -0.5957, -0.6229, -0.6934, -0.6584, -0.7122, -0.6700, -0.6999, -0.7174])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007674210355617106
0: validation loss for velocity_v : 0.0008196118869818747
0: validation loss for specific_humidity : 1.7061609469237737e-05
0: validation loss for velocity_z : 0.0011983966687694192
0: validation loss for temperature : 45610.4609375
0: validation loss for total_precip : 0.0003879060095641762
0: validation loss for t2m : 78077.9453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 431.20 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_234601-jhucjl7r[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_234601-jhucjl7r/logs[0m
0: Running global_forecast for 2015-05-13 14:00 ...
0: Wandb run: atmorep-4inosict-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 4inosict
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 14]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.149, max = -0.157, mean = -1.063
0:          sample (first 20): tensor([-0.5765, -0.6325, -0.5976, -0.6679, -0.6103, -0.6377, -0.6767, -0.6655, -0.6257, -0.6165, -0.6294, -0.7162,
0:         -0.5981, -0.6250, -0.6956, -0.6604, -0.7142, -0.6723, -0.7016, -0.7192])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007355747511610389
0: validation loss for velocity_v : 0.0008198902942240238
0: validation loss for specific_humidity : 1.7018366634147242e-05
0: validation loss for velocity_z : 0.0011885175481438637
0: validation loss for temperature : 45604.0546875
0: validation loss for total_precip : 0.0003804024599958211
0: validation loss for t2m : 78077.890625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 420.90 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250925_235326-4inosict[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250925_235326-4inosict/logs[0m
0: Running global_forecast for 2015-05-13 15:00 ...
0: Wandb run: atmorep-u88g26lm-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : u88g26lm
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 15]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.149, max = -0.160, mean = -1.065
0:          sample (first 20): tensor([-0.5764, -0.6331, -0.5969, -0.6678, -0.6107, -0.6377, -0.6765, -0.6660, -0.6257, -0.6167, -0.6299, -0.7161,
0:         -0.5977, -0.6249, -0.6955, -0.6604, -0.7141, -0.6728, -0.7020, -0.7196])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005547356558963656
0: validation loss for velocity_v : 0.000823302601929754
0: validation loss for specific_humidity : 1.8515056581236422e-05
0: validation loss for velocity_z : 0.0011845770059153438
0: validation loss for temperature : 45603.3359375
0: validation loss for total_precip : 0.0003847999032586813
0: validation loss for t2m : 78077.828125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 409.98 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_000035-u88g26lm[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_000035-u88g26lm/logs[0m
0: Running global_forecast for 2015-05-13 16:00 ...
0: Wandb run: atmorep-hve627x6-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : hve627x6
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 16]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.151, max = -0.159, mean = -1.067
0:          sample (first 20): tensor([-0.5768, -0.6333, -0.5981, -0.6684, -0.6112, -0.6381, -0.6773, -0.6665, -0.6264, -0.6172, -0.6304, -0.7168,
0:         -0.5985, -0.6255, -0.6959, -0.6610, -0.7146, -0.6733, -0.7026, -0.7201])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005316946189850569
0: validation loss for velocity_v : 0.000824833638034761
0: validation loss for specific_humidity : 1.8402077330392785e-05
0: validation loss for velocity_z : 0.0011746573727577925
0: validation loss for temperature : 45597.01953125
0: validation loss for total_precip : 0.0003775688528548926
0: validation loss for t2m : 78077.7734375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 437.62 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_000733-hve627x6[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_000733-hve627x6/logs[0m
0: Running global_forecast for 2015-05-13 17:00 ...
0: Wandb run: atmorep-5xsef96x-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 5xsef96x
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 17]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.152, max = -0.158, mean = -1.069
0:          sample (first 20): tensor([-0.5774, -0.6339, -0.5990, -0.6690, -0.6118, -0.6389, -0.6786, -0.6670, -0.6269, -0.6184, -0.6307, -0.7177,
0:         -0.5997, -0.6264, -0.6969, -0.6620, -0.7156, -0.6741, -0.7029, -0.7206])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005109192570671439
0: validation loss for velocity_v : 0.0008272253326140344
0: validation loss for specific_humidity : 1.8302853277418762e-05
0: validation loss for velocity_z : 0.0011649830266833305
0: validation loss for temperature : 45590.85546875
0: validation loss for total_precip : 0.00037040558527223766
0: validation loss for t2m : 78077.7421875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 431.55 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_001518-5xsef96x[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_001518-5xsef96x/logs[0m
0: Running global_forecast for 2015-05-13 18:00 ...
0: Wandb run: atmorep-zc5whj4a-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : zc5whj4a
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 18]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.154, max = -0.158, mean = -1.072
0:          sample (first 20): tensor([-0.5784, -0.6357, -0.5992, -0.6696, -0.6127, -0.6398, -0.6790, -0.6684, -0.6276, -0.6191, -0.6322, -0.7184,
0:         -0.6002, -0.6273, -0.6975, -0.6628, -0.7166, -0.6756, -0.7045, -0.7217])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005437199724838138
0: validation loss for velocity_v : 0.0008257271838374436
0: validation loss for specific_humidity : 1.8393791833659634e-05
0: validation loss for velocity_z : 0.0011687397491186857
0: validation loss for temperature : 45591.9609375
0: validation loss for total_precip : 0.00038809754187241197
0: validation loss for t2m : 78077.7265625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 440.96 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_002243-zc5whj4a[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_002243-zc5whj4a/logs[0m
0: Running global_forecast for 2015-05-13 19:00 ...
0: Wandb run: atmorep-b65hoonz-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : b65hoonz
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 19]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.156, max = -0.157, mean = -1.074
0:          sample (first 20): tensor([-0.5782, -0.6355, -0.5996, -0.6700, -0.6129, -0.6397, -0.6796, -0.6682, -0.6279, -0.6193, -0.6323, -0.7186,
0:         -0.6006, -0.6278, -0.6976, -0.6632, -0.7169, -0.6757, -0.7046, -0.7219])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005207317881286144
0: validation loss for velocity_v : 0.0008277493179775774
0: validation loss for specific_humidity : 1.829898428695742e-05
0: validation loss for velocity_z : 0.0011587556218728423
0: validation loss for temperature : 45585.74609375
0: validation loss for total_precip : 0.00038071980816312134
0: validation loss for t2m : 78077.703125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 326.38 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_003012-b65hoonz[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_003012-b65hoonz/logs[0m
0: Running global_forecast for 2015-05-13 20:00 ...
0: Wandb run: atmorep-lkgpaavb-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : lkgpaavb
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 20]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.157, max = -0.155, mean = -1.078
0:          sample (first 20): tensor([-0.5805, -0.6375, -0.6022, -0.6723, -0.6147, -0.6416, -0.6825, -0.6701, -0.6300, -0.6212, -0.6345, -0.7210,
0:         -0.6032, -0.6300, -0.7001, -0.6656, -0.7191, -0.6781, -0.7069, -0.7241])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005000010714866221
0: validation loss for velocity_v : 0.0008306942181661725
0: validation loss for specific_humidity : 1.8221926438855007e-05
0: validation loss for velocity_z : 0.0011490521719679236
0: validation loss for temperature : 45579.69921875
0: validation loss for total_precip : 0.0003733060148078948
0: validation loss for t2m : 78077.65625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 441.01 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_003548-lkgpaavb[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_003548-lkgpaavb/logs[0m
0: Running global_forecast for 2015-05-13 21:00 ...
0: Wandb run: atmorep-40jov9x4-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : 40jov9x4
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 21]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.158, max = -0.157, mean = -1.080
0:          sample (first 20): tensor([-0.5795, -0.6371, -0.6008, -0.6715, -0.6141, -0.6409, -0.6809, -0.6699, -0.6289, -0.6206, -0.6337, -0.7204,
0:         -0.6019, -0.6287, -0.6988, -0.6643, -0.7182, -0.6771, -0.7063, -0.7232])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005691929254680872
0: validation loss for velocity_v : 0.0007913936860859394
0: validation loss for specific_humidity : 1.8095237464876845e-05
0: validation loss for velocity_z : 0.0011664433404803276
0: validation loss for temperature : 45580.71875
0: validation loss for total_precip : 0.0003891271771863103
0: validation loss for t2m : 78077.578125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 422.93 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_004323-40jov9x4[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_004323-40jov9x4/logs[0m
0: Running global_forecast for 2015-05-13 22:00 ...
0: Wandb run: atmorep-tlx9hjgp-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : tlx9hjgp
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 22]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.159, max = -0.156, mean = -1.083
0:          sample (first 20): tensor([-0.5807, -0.6387, -0.6027, -0.6726, -0.6155, -0.6421, -0.6829, -0.6707, -0.6302, -0.6216, -0.6349, -0.7217,
0:         -0.6035, -0.6300, -0.7002, -0.6660, -0.7195, -0.6787, -0.7074, -0.7244])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000543981499504298
0: validation loss for velocity_v : 0.0007928475388325751
0: validation loss for specific_humidity : 1.802718179533258e-05
0: validation loss for velocity_z : 0.0011566103203222156
0: validation loss for temperature : 45574.80078125
0: validation loss for total_precip : 0.0003817287215497345
0: validation loss for t2m : 78077.5234375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 409.90 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_005034-tlx9hjgp[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_005034-tlx9hjgp/logs[0m
0: Running global_forecast for 2015-05-13 23:00 ...
0: Wandb run: atmorep-ufx4meso-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : ufx4meso
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 13, 23]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.160, max = -0.156, mean = -1.086
0:          sample (first 20): tensor([-0.5798, -0.6376, -0.6023, -0.6720, -0.6145, -0.6411, -0.6825, -0.6699, -0.6291, -0.6214, -0.6344, -0.7212,
0:         -0.6029, -0.6297, -0.6993, -0.6652, -0.7191, -0.6778, -0.7067, -0.7238])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005212854011915624
0: validation loss for velocity_v : 0.0007951516308821738
0: validation loss for specific_humidity : 1.796449396351818e-05
0: validation loss for velocity_z : 0.001147075672633946
0: validation loss for temperature : 45569.01171875
0: validation loss for total_precip : 0.00037445075577124953
0: validation loss for t2m : 78077.4921875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 425.45 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_005739-ufx4meso[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_005739-ufx4meso/logs[0m
0: Running global_forecast for 2015-05-14 00:00 ...
0: Wandb run: atmorep-exow54bp-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : exow54bp
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 14, 0]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.106, max = -0.164, mean = -1.029
0:          sample (first 20): tensor([-0.5669, -0.6207, -0.5872, -0.6578, -0.6003, -0.6279, -0.6639, -0.6552, -0.6159, -0.6051, -0.6185, -0.7036,
0:         -0.5860, -0.6140, -0.6844, -0.6487, -0.7028, -0.6592, -0.6904, -0.7085])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007694200030528009
0: validation loss for velocity_v : 0.0008159521385096014
0: validation loss for specific_humidity : 1.7893456970341504e-05
0: validation loss for velocity_z : 0.001328492071479559
0: validation loss for temperature : 45667.56640625
0: validation loss for total_precip : 0.0004377232398837805
0: validation loss for t2m : 78078.6171875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 426.42 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_010453-exow54bp[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_010453-exow54bp/logs[0m
0: Running global_forecast for 2015-05-14 01:00 ...
0: Wandb run: atmorep-u4b3z433-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : u4b3z433
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 14, 1]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.110, max = -0.164, mean = -1.031
0:          sample (first 20): tensor([-0.5692, -0.6231, -0.5898, -0.6601, -0.6024, -0.6298, -0.6666, -0.6572, -0.6184, -0.6070, -0.6209, -0.7062,
0:         -0.5884, -0.6166, -0.6868, -0.6511, -0.7054, -0.6615, -0.6926, -0.7109])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007372680120170116
0: validation loss for velocity_v : 0.000814060855191201
0: validation loss for specific_humidity : 1.773582334863022e-05
0: validation loss for velocity_z : 0.0013162164250388741
0: validation loss for temperature : 45660.15625
0: validation loss for total_precip : 0.00042911412310786545
0: validation loss for t2m : 78078.5703125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 452.54 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_011219-u4b3z433[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_011219-u4b3z433/logs[0m
0: Running global_forecast for 2015-05-14 02:00 ...
0: Wandb run: atmorep-c2q8vhyf-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : c2q8vhyf
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 14, 2]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.113, max = -0.162, mean = -1.034
0:          sample (first 20): tensor([-0.5690, -0.6226, -0.5902, -0.6597, -0.6023, -0.6296, -0.6672, -0.6567, -0.6179, -0.6073, -0.6207, -0.7061,
0:         -0.5885, -0.6166, -0.6867, -0.6510, -0.7053, -0.6615, -0.6924, -0.7110])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007071681902743876
0: validation loss for velocity_v : 0.0008130440255627036
0: validation loss for specific_humidity : 1.7609496353543364e-05
0: validation loss for velocity_z : 0.0013038418255746365
0: validation loss for temperature : 45652.98828125
0: validation loss for total_precip : 0.0004205889126751572
0: validation loss for t2m : 78078.5234375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 447.23 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_012006-c2q8vhyf[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_012006-c2q8vhyf/logs[0m
0: Running global_forecast for 2015-05-14 03:00 ...
0: Wandb run: atmorep-dgeg6ug8-19707387
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707387
0: wandb_id : dgeg6ug8
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 14, 3]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.118, max = -0.163, mean = -1.037
0:          sample (first 20): tensor([-0.5693, -0.6244, -0.5901, -0.6606, -0.6031, -0.6308, -0.6672, -0.6582, -0.6187, -0.6082, -0.6216, -0.7076,
0:         -0.5892, -0.6172, -0.6877, -0.6523, -0.7064, -0.6632, -0.6938, -0.7120])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005275417352095246
0: validation loss for velocity_v : 0.0007967425044625998
0: validation loss for specific_humidity : 1.8874885427067056e-05
0: validation loss for velocity_z : 0.0012210907880216837
0: validation loss for temperature : 45651.7109375
0: validation loss for total_precip : 0.00037393890670500696
0: validation loss for t2m : 78078.484375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 341.74 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_012746-dgeg6ug8[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_012746-dgeg6ug8/logs[0m
