0: Evaluating the following times: (2099,)
0: Running global_forecast for 2015-05-17 04:00 ...
0: Wandb run: atmorep-cbz9misj-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : cbz9misj
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 4]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.123, max = -0.162, mean = -1.040
0:          sample (first 20): tensor([-0.5705, -0.6254, -0.5914, -0.6616, -0.6042, -0.6317, -0.6687, -0.6590, -0.6195, -0.6092, -0.6226, -0.7087,
0:         -0.5905, -0.6186, -0.6893, -0.6532, -0.7075, -0.6641, -0.6949, -0.7130])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005072353524155915
0: validation loss for velocity_v : 0.0008000756497494876
0: validation loss for specific_humidity : 1.871115637186449e-05
0: validation loss for velocity_z : 0.0012099870946258307
0: validation loss for temperature : 45644.51171875
0: validation loss for total_precip : 0.00036671158159151673
0: validation loss for t2m : 78078.453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 354.10 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_000812-cbz9misj[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_000812-cbz9misj/logs[0m
0: Running global_forecast for 2015-05-17 05:00 ...
0: Wandb run: atmorep-9q0pygwa-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 9q0pygwa
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 5]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.126, max = -0.162, mean = -1.042
0:          sample (first 20): tensor([-0.5715, -0.6263, -0.5928, -0.6626, -0.6050, -0.6323, -0.6705, -0.6598, -0.6205, -0.6106, -0.6237, -0.7100,
0:         -0.5919, -0.6199, -0.6902, -0.6545, -0.7088, -0.6654, -0.6956, -0.7141])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0004888318944722414
0: validation loss for velocity_v : 0.0008043704438023269
0: validation loss for specific_humidity : 1.8569569874671288e-05
0: validation loss for velocity_z : 0.0011995030799880624
0: validation loss for temperature : 45637.46875
0: validation loss for total_precip : 0.00035942927934229374
0: validation loss for t2m : 78078.375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 350.19 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_001413-9q0pygwa[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_001413-9q0pygwa/logs[0m
0: Running global_forecast for 2015-05-17 06:00 ...
0: Wandb run: atmorep-4dqpul5c-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 4dqpul5c
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 6]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.127, max = -0.161, mean = -1.045
0:          sample (first 20): tensor([-0.5721, -0.6274, -0.5927, -0.6636, -0.6060, -0.6331, -0.6704, -0.6616, -0.6214, -0.6112, -0.6247, -0.7108,
0:         -0.5927, -0.6208, -0.6906, -0.6551, -0.7092, -0.6666, -0.6969, -0.7151])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005265198997221887
0: validation loss for velocity_v : 0.0008018170483410358
0: validation loss for specific_humidity : 1.864182013378013e-05
0: validation loss for velocity_z : 0.0012037104461342096
0: validation loss for temperature : 45638.88671875
0: validation loss for total_precip : 0.00038101390236988664
0: validation loss for t2m : 78078.359375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 353.71 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_002018-4dqpul5c[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_002018-4dqpul5c/logs[0m
0: Running global_forecast for 2015-05-17 07:00 ...
0: Wandb run: atmorep-9wkpfkhy-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 9wkpfkhy
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 7]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.132, max = -0.160, mean = -1.047
0:          sample (first 20): tensor([-0.5731, -0.6285, -0.5940, -0.6645, -0.6071, -0.6344, -0.6724, -0.6624, -0.6225, -0.6124, -0.6259, -0.7119,
0:         -0.5938, -0.6216, -0.6920, -0.6562, -0.7104, -0.6679, -0.6982, -0.7160])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005059291142970324
0: validation loss for velocity_v : 0.0008049843600019813
0: validation loss for specific_humidity : 1.8489270587451756e-05
0: validation loss for velocity_z : 0.0011929651955142617
0: validation loss for temperature : 45632.11328125
0: validation loss for total_precip : 0.00037361381691880524
0: validation loss for t2m : 78078.3046875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 379.74 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_002626-9wkpfkhy[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_002626-9wkpfkhy/logs[0m
0: Running global_forecast for 2015-05-17 08:00 ...
0: Wandb run: atmorep-e853jpqn-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : e853jpqn
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 8]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.135, max = -0.161, mean = -1.049
0:          sample (first 20): tensor([-0.5733, -0.6287, -0.5948, -0.6645, -0.6072, -0.6344, -0.6728, -0.6623, -0.6225, -0.6129, -0.6260, -0.7123,
0:         -0.5943, -0.6224, -0.6923, -0.6565, -0.7110, -0.6682, -0.6981, -0.7162])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0004875540907960385
0: validation loss for velocity_v : 0.0008093135547824204
0: validation loss for specific_humidity : 1.8354718122282065e-05
0: validation loss for velocity_z : 0.0011826467234641314
0: validation loss for temperature : 45625.28515625
0: validation loss for total_precip : 0.0003663773532025516
0: validation loss for t2m : 78078.2734375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 372.67 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_003256-e853jpqn[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_003256-e853jpqn/logs[0m
0: Running global_forecast for 2015-05-17 09:00 ...
0: Wandb run: atmorep-81itsi1l-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 81itsi1l
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 9]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.138, max = -0.161, mean = -1.052
0:          sample (first 20): tensor([-0.5732, -0.6294, -0.5940, -0.6649, -0.6076, -0.6345, -0.6724, -0.6628, -0.6229, -0.6128, -0.6265, -0.7123,
0:         -0.5940, -0.6218, -0.6924, -0.6567, -0.7108, -0.6686, -0.6986, -0.7165])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005678442539647222
0: validation loss for velocity_v : 0.0007713143713772297
0: validation loss for specific_humidity : 1.8282791643287055e-05
0: validation loss for velocity_z : 0.0011935699731111526
0: validation loss for temperature : 45625.96484375
0: validation loss for total_precip : 0.00038876108010299504
0: validation loss for t2m : 78078.2109375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 369.67 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_003915-81itsi1l[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_003915-81itsi1l/logs[0m
0: Running global_forecast for 2015-05-17 10:00 ...
0: Wandb run: atmorep-bbj8t1d0-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : bbj8t1d0
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 10]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.140, max = -0.159, mean = -1.055
0:          sample (first 20): tensor([-0.5743, -0.6303, -0.5951, -0.6659, -0.6084, -0.6355, -0.6737, -0.6634, -0.6237, -0.6141, -0.6272, -0.7134,
0:         -0.5951, -0.6229, -0.6935, -0.6576, -0.7119, -0.6698, -0.6995, -0.7175])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005431972676888108
0: validation loss for velocity_v : 0.0007734624086879194
0: validation loss for specific_humidity : 1.8160761101171374e-05
0: validation loss for velocity_z : 0.0011831336887553334
0: validation loss for temperature : 45619.3046875
0: validation loss for total_precip : 0.00038156393566168845
0: validation loss for t2m : 78078.171875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 375.07 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_004532-bbj8t1d0[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_004532-bbj8t1d0/logs[0m
0: Running global_forecast for 2015-05-17 11:00 ...
0: Wandb run: atmorep-vb09l0zl-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : vb09l0zl
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 11]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.143, max = -0.160, mean = -1.057
0:          sample (first 20): tensor([-0.5748, -0.6305, -0.5962, -0.6663, -0.6088, -0.6361, -0.6747, -0.6638, -0.6241, -0.6147, -0.6278, -0.7140,
0:         -0.5961, -0.6234, -0.6941, -0.6584, -0.7126, -0.6705, -0.6999, -0.7181])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000521330046467483
0: validation loss for velocity_v : 0.0007768924115225673
0: validation loss for specific_humidity : 1.8051161532639526e-05
0: validation loss for velocity_z : 0.0011727605015039444
0: validation loss for temperature : 45612.828125
0: validation loss for total_precip : 0.0003744123678188771
0: validation loss for t2m : 78078.1171875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 274.04 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_005155-vb09l0zl[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_005155-vb09l0zl/logs[0m
0: Running global_forecast for 2015-05-17 12:00 ...
0: Wandb run: atmorep-mz54bnvi-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : mz54bnvi
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 12]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.144, max = -0.160, mean = -1.058
0:          sample (first 20): tensor([-0.5732, -0.6294, -0.5939, -0.6649, -0.6074, -0.6345, -0.6726, -0.6632, -0.6229, -0.6133, -0.6266, -0.7124,
0:         -0.5942, -0.6215, -0.6920, -0.6569, -0.7109, -0.6688, -0.6988, -0.7163])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008017986547201872
0: validation loss for velocity_v : 0.0008204549667425454
0: validation loss for specific_humidity : 1.711127333692275e-05
0: validation loss for velocity_z : 0.001208210946060717
0: validation loss for temperature : 45616.8203125
0: validation loss for total_precip : 0.00039568086504004896
0: validation loss for t2m : 78077.9921875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 383.52 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_005641-mz54bnvi[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_005641-mz54bnvi/logs[0m
0: Running global_forecast for 2015-05-17 13:00 ...
0: Wandb run: atmorep-pc2obs0i-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : pc2obs0i
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 13]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.147, max = -0.159, mean = -1.060
0:          sample (first 20): tensor([-0.5743, -0.6308, -0.5952, -0.6661, -0.6085, -0.6356, -0.6743, -0.6639, -0.6239, -0.6147, -0.6275, -0.7135,
0:         -0.5956, -0.6230, -0.6935, -0.6584, -0.7123, -0.6702, -0.6998, -0.7174])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007674201624467969
0: validation loss for velocity_v : 0.0008197074057534337
0: validation loss for specific_humidity : 1.7055743228411302e-05
0: validation loss for velocity_z : 0.0011980398558080196
0: validation loss for temperature : 45610.37109375
0: validation loss for total_precip : 0.0003880945441778749
0: validation loss for t2m : 78077.9375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 383.34 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_010316-pc2obs0i[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_010316-pc2obs0i/logs[0m
0: Running global_forecast for 2015-05-17 14:00 ...
0: Wandb run: atmorep-c203p659-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : c203p659
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 14]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.150, max = -0.158, mean = -1.062
0:          sample (first 20): tensor([-0.5748, -0.6307, -0.5965, -0.6665, -0.6089, -0.6360, -0.6752, -0.6644, -0.6245, -0.6151, -0.6279, -0.7145,
0:         -0.5967, -0.6235, -0.6940, -0.6590, -0.7129, -0.6708, -0.7002, -0.7180])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007356224814429879
0: validation loss for velocity_v : 0.0008200313313864172
0: validation loss for specific_humidity : 1.7014197510434315e-05
0: validation loss for velocity_z : 0.001188065973110497
0: validation loss for temperature : 45603.953125
0: validation loss for total_precip : 0.00038062158273532987
0: validation loss for t2m : 78077.90625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 365.84 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_010946-c203p659[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_010946-c203p659/logs[0m
0: Running global_forecast for 2015-05-17 15:00 ...
0: Wandb run: atmorep-ek0r3vv1-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : ek0r3vv1
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 15]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.149, max = -0.159, mean = -1.064
0:          sample (first 20): tensor([-0.5756, -0.6324, -0.5963, -0.6673, -0.6101, -0.6372, -0.6758, -0.6656, -0.6251, -0.6161, -0.6293, -0.7156,
0:         -0.5971, -0.6245, -0.6946, -0.6597, -0.7134, -0.6722, -0.7013, -0.7190])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005548002081923187
0: validation loss for velocity_v : 0.0008233003318309784
0: validation loss for specific_humidity : 1.850650915002916e-05
0: validation loss for velocity_z : 0.0011840875959023833
0: validation loss for temperature : 45603.25
0: validation loss for total_precip : 0.00038494972977787256
0: validation loss for t2m : 78077.828125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 367.59 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_011559-ek0r3vv1[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_011559-ek0r3vv1/logs[0m
0: Running global_forecast for 2015-05-17 16:00 ...
0: Wandb run: atmorep-2lrukflz-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 2lrukflz
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 16]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.152, max = -0.159, mean = -1.067
0:          sample (first 20): tensor([-0.5765, -0.6329, -0.5976, -0.6679, -0.6109, -0.6379, -0.6770, -0.6660, -0.6260, -0.6170, -0.6299, -0.7164,
0:         -0.5982, -0.6252, -0.6955, -0.6607, -0.7144, -0.6729, -0.7021, -0.7196])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005317563191056252
0: validation loss for velocity_v : 0.0008248636731877923
0: validation loss for specific_humidity : 1.839717515395023e-05
0: validation loss for velocity_z : 0.0011742282658815384
0: validation loss for temperature : 45596.953125
0: validation loss for total_precip : 0.00037774292286485434
0: validation loss for t2m : 78077.7734375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 403.35 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_012220-2lrukflz[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_012220-2lrukflz/logs[0m
0: Running global_forecast for 2015-05-17 17:00 ...
0: Wandb run: atmorep-0ivvrnic-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 0ivvrnic
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 17]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.153, max = -0.158, mean = -1.070
0:          sample (first 20): tensor([-0.5772, -0.6339, -0.5990, -0.6687, -0.6118, -0.6386, -0.6784, -0.6666, -0.6267, -0.6182, -0.6305, -0.7174,
0:         -0.5994, -0.6260, -0.6964, -0.6615, -0.7155, -0.6739, -0.7025, -0.7203])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000511009304318577
0: validation loss for velocity_v : 0.0008274057763628662
0: validation loss for specific_humidity : 1.8296761481906287e-05
0: validation loss for velocity_z : 0.0011645798804238439
0: validation loss for temperature : 45590.76953125
0: validation loss for total_precip : 0.0003705246781464666
0: validation loss for t2m : 78077.75
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 408.82 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_012916-0ivvrnic[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_012916-0ivvrnic/logs[0m
0: Running global_forecast for 2015-05-17 18:00 ...
0: Wandb run: atmorep-s7myinp3-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : s7myinp3
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 18]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.154, max = -0.158, mean = -1.072
0:          sample (first 20): tensor([-0.5775, -0.6349, -0.5985, -0.6688, -0.6120, -0.6389, -0.6782, -0.6676, -0.6270, -0.6183, -0.6315, -0.7174,
0:         -0.5992, -0.6265, -0.6966, -0.6621, -0.7157, -0.6746, -0.7037, -0.7207])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005437866202555597
0: validation loss for velocity_v : 0.0008258370216935873
0: validation loss for specific_humidity : 1.838446951296646e-05
0: validation loss for velocity_z : 0.001168318442068994
0: validation loss for temperature : 45591.8828125
0: validation loss for total_precip : 0.0003883570898324251
0: validation loss for t2m : 78077.7265625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 402.13 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_013625-s7myinp3[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_013625-s7myinp3/logs[0m
0: Running global_forecast for 2015-05-17 19:00 ...
0: Wandb run: atmorep-2x9gjwsw-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 2x9gjwsw
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 19]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.156, max = -0.157, mean = -1.075
0:          sample (first 20): tensor([-0.5788, -0.6359, -0.6001, -0.6703, -0.6131, -0.6399, -0.6800, -0.6684, -0.6282, -0.6195, -0.6326, -0.7189,
0:         -0.6011, -0.6279, -0.6981, -0.6634, -0.7171, -0.6759, -0.7049, -0.7223])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005207661888562143
0: validation loss for velocity_v : 0.0008277728920802474
0: validation loss for specific_humidity : 1.8290951629751362e-05
0: validation loss for velocity_z : 0.0011583617888391018
0: validation loss for temperature : 45585.7109375
0: validation loss for total_precip : 0.0003809209738392383
0: validation loss for t2m : 78077.6875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 344.30 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_014313-2x9gjwsw[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_014313-2x9gjwsw/logs[0m
0: Running global_forecast for 2015-05-17 20:00 ...
0: Wandb run: atmorep-qpyaczz5-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : qpyaczz5
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 20]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.157, max = -0.156, mean = -1.078
0:          sample (first 20): tensor([-0.5809, -0.6379, -0.6027, -0.6726, -0.6151, -0.6420, -0.6831, -0.6705, -0.6302, -0.6218, -0.6348, -0.7215,
0:         -0.6037, -0.6303, -0.7003, -0.6659, -0.7194, -0.6785, -0.7070, -0.7244])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005000888486392796
0: validation loss for velocity_v : 0.0008307216339744627
0: validation loss for specific_humidity : 1.8214826923212968e-05
0: validation loss for velocity_z : 0.0011487246956676245
0: validation loss for temperature : 45579.66796875
0: validation loss for total_precip : 0.0003734766214620322
0: validation loss for t2m : 78077.640625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 386.48 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_014904-qpyaczz5[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_014904-qpyaczz5/logs[0m
0: Running global_forecast for 2015-05-17 21:00 ...
0: Wandb run: atmorep-6alac3da-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 6alac3da
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 21]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.159, max = -0.157, mean = -1.080
0:          sample (first 20): tensor([-0.5790, -0.6366, -0.6002, -0.6709, -0.6135, -0.6404, -0.6804, -0.6691, -0.6285, -0.6201, -0.6330, -0.7198,
0:         -0.6013, -0.6280, -0.6983, -0.6640, -0.7174, -0.6767, -0.7056, -0.7227])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005693495040759444
0: validation loss for velocity_v : 0.0007915733149275184
0: validation loss for specific_humidity : 1.8088425349560566e-05
0: validation loss for velocity_z : 0.0011660287855193019
0: validation loss for temperature : 45580.64453125
0: validation loss for total_precip : 0.0003893180110026151
0: validation loss for t2m : 78077.578125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 373.09 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_015538-6alac3da[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_015538-6alac3da/logs[0m
0: Running global_forecast for 2015-05-17 22:00 ...
0: Wandb run: atmorep-82pho2qd-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 82pho2qd
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 22]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.159, max = -0.156, mean = -1.083
0:          sample (first 20): tensor([-0.5799, -0.6378, -0.6019, -0.6720, -0.6144, -0.6414, -0.6819, -0.6701, -0.6292, -0.6211, -0.6340, -0.7207,
0:         -0.6026, -0.6294, -0.6992, -0.6651, -0.7187, -0.6777, -0.7065, -0.7236])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005440429667942226
0: validation loss for velocity_v : 0.0007929595303721726
0: validation loss for specific_humidity : 1.8019278286374174e-05
0: validation loss for velocity_z : 0.0011562192812561989
0: validation loss for temperature : 45574.76953125
0: validation loss for total_precip : 0.0003819632111117244
0: validation loss for t2m : 78077.5390625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 385.72 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_020158-82pho2qd[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_020158-82pho2qd/logs[0m
0: Running global_forecast for 2015-05-17 23:00 ...
0: Wandb run: atmorep-1x3cd7gn-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 1x3cd7gn
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 17, 23]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.161, max = -0.155, mean = -1.086
0:          sample (first 20): tensor([-0.5812, -0.6387, -0.6035, -0.6732, -0.6158, -0.6424, -0.6838, -0.6714, -0.6304, -0.6226, -0.6356, -0.7226,
0:         -0.6043, -0.6310, -0.7007, -0.6665, -0.7204, -0.6792, -0.7080, -0.7249])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005213484982959926
0: validation loss for velocity_v : 0.000795208674389869
0: validation loss for specific_humidity : 1.795762000256218e-05
0: validation loss for velocity_z : 0.001146672759205103
0: validation loss for temperature : 45568.88671875
0: validation loss for total_precip : 0.0003745923168025911
0: validation loss for t2m : 78077.5
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 362.97 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_020831-1x3cd7gn[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_020831-1x3cd7gn/logs[0m
0: Running global_forecast for 2015-05-18 00:00 ...
0: Wandb run: atmorep-09395xw5-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 09395xw5
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 0]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.107, max = -0.164, mean = -1.029
0:          sample (first 20): tensor([-0.5677, -0.6218, -0.5880, -0.6586, -0.6010, -0.6283, -0.6648, -0.6561, -0.6167, -0.6058, -0.6195, -0.7046,
0:         -0.5870, -0.6151, -0.6853, -0.6498, -0.7035, -0.6599, -0.6911, -0.7093])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007695106323808432
0: validation loss for velocity_v : 0.0008160449797287583
0: validation loss for specific_humidity : 1.7881329767988063e-05
0: validation loss for velocity_z : 0.0013281265273690224
0: validation loss for temperature : 45667.49609375
0: validation loss for total_precip : 0.0004379640449769795
0: validation loss for t2m : 78078.609375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 392.09 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_021445-09395xw5[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_021445-09395xw5/logs[0m
0: Running global_forecast for 2015-05-18 01:00 ...
0: Wandb run: atmorep-p57vrfks-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : p57vrfks
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 1]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.110, max = -0.164, mean = -1.031
0:          sample (first 20): tensor([-0.5683, -0.6219, -0.5889, -0.6589, -0.6013, -0.6288, -0.6657, -0.6564, -0.6174, -0.6063, -0.6199, -0.7054,
0:         -0.5874, -0.6157, -0.6860, -0.6500, -0.7043, -0.6603, -0.6918, -0.7099])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007373235421255231
0: validation loss for velocity_v : 0.0008142243605107069
0: validation loss for specific_humidity : 1.7727603335515596e-05
0: validation loss for velocity_z : 0.0013156746281310916
0: validation loss for temperature : 45660.078125
0: validation loss for total_precip : 0.00042933147051371634
0: validation loss for t2m : 78078.5625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 403.70 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_022129-p57vrfks[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_022129-p57vrfks/logs[0m
0: Running global_forecast for 2015-05-18 02:00 ...
0: Wandb run: atmorep-iufqz8kw-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : iufqz8kw
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 2]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.113, max = -0.163, mean = -1.034
0:          sample (first 20): tensor([-0.5692, -0.6230, -0.5903, -0.6598, -0.6024, -0.6298, -0.6669, -0.6569, -0.6180, -0.6071, -0.6208, -0.7064,
0:         -0.5888, -0.6167, -0.6868, -0.6512, -0.7055, -0.6615, -0.6925, -0.7109])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007071467116475105
0: validation loss for velocity_v : 0.0008133198716677725
0: validation loss for specific_humidity : 1.7596252291696146e-05
0: validation loss for velocity_z : 0.0013034285511821508
0: validation loss for temperature : 45652.87109375
0: validation loss for total_precip : 0.00042082738946191967
0: validation loss for t2m : 78078.5234375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 395.64 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_022824-iufqz8kw[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_022824-iufqz8kw/logs[0m
0: Running global_forecast for 2015-05-18 03:00 ...
0: Wandb run: atmorep-usdblgcf-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : usdblgcf
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 3]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.118, max = -0.162, mean = -1.037
0:          sample (first 20): tensor([-0.5694, -0.6246, -0.5901, -0.6607, -0.6031, -0.6304, -0.6672, -0.6582, -0.6188, -0.6084, -0.6216, -0.7076,
0:         -0.5893, -0.6172, -0.6877, -0.6524, -0.7062, -0.6630, -0.6936, -0.7118])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000527573807630688
0: validation loss for velocity_v : 0.0007969440775923431
0: validation loss for specific_humidity : 1.8868491679313593e-05
0: validation loss for velocity_z : 0.0012207797262817621
0: validation loss for temperature : 45651.6484375
0: validation loss for total_precip : 0.00037413608515635133
0: validation loss for t2m : 78078.4765625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 331.30 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_023506-usdblgcf[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_023506-usdblgcf/logs[0m
0: Running global_forecast for 2015-05-18 04:00 ...
0: Wandb run: atmorep-8a7qk6mh-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 8a7qk6mh
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 4]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.122, max = -0.162, mean = -1.039
0:          sample (first 20): tensor([-0.5703, -0.6253, -0.5913, -0.6616, -0.6041, -0.6315, -0.6689, -0.6588, -0.6198, -0.6091, -0.6226, -0.7086,
0:         -0.5907, -0.6187, -0.6891, -0.6531, -0.7074, -0.6641, -0.6947, -0.7128])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000507224933244288
0: validation loss for velocity_v : 0.000799943576566875
0: validation loss for specific_humidity : 1.8704726244322956e-05
0: validation loss for velocity_z : 0.001209850306622684
0: validation loss for temperature : 45644.5
0: validation loss for total_precip : 0.0003667761629913002
0: validation loss for t2m : 78078.4375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 363.93 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_024045-8a7qk6mh[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_024045-8a7qk6mh/logs[0m
0: Running global_forecast for 2015-05-18 05:00 ...
0: Wandb run: atmorep-na6505dv-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : na6505dv
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 5]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.125, max = -0.161, mean = -1.043
0:          sample (first 20): tensor([-0.5718, -0.6264, -0.5932, -0.6629, -0.6052, -0.6328, -0.6708, -0.6601, -0.6210, -0.6109, -0.6237, -0.7102,
0:         -0.5921, -0.6198, -0.6905, -0.6548, -0.7090, -0.6657, -0.6959, -0.7143])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0004888357943855226
0: validation loss for velocity_v : 0.0008042998961172998
0: validation loss for specific_humidity : 1.8569773601484485e-05
0: validation loss for velocity_z : 0.0011994236847385764
0: validation loss for temperature : 45637.4375
0: validation loss for total_precip : 0.0003594537265598774
0: validation loss for t2m : 78078.375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 389.74 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_024656-na6505dv[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_024656-na6505dv/logs[0m
0: Running global_forecast for 2015-05-18 06:00 ...
0: Wandb run: atmorep-fota0u2b-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : fota0u2b
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 6]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.128, max = -0.162, mean = -1.045
0:          sample (first 20): tensor([-0.5718, -0.6272, -0.5924, -0.6634, -0.6056, -0.6330, -0.6703, -0.6613, -0.6213, -0.6110, -0.6245, -0.7105,
0:         -0.5922, -0.6204, -0.6905, -0.6549, -0.7090, -0.6665, -0.6968, -0.7147])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000526482705026865
0: validation loss for velocity_v : 0.0008017201325856149
0: validation loss for specific_humidity : 1.8637212633620948e-05
0: validation loss for velocity_z : 0.001203640946187079
0: validation loss for temperature : 45638.90625
0: validation loss for total_precip : 0.00038104524719528854
0: validation loss for t2m : 78078.359375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 386.47 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_025333-fota0u2b[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_025333-fota0u2b/logs[0m
0: Running global_forecast for 2015-05-18 07:00 ...
0: Wandb run: atmorep-75c9gq3j-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 75c9gq3j
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 7]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.133, max = -0.161, mean = -1.047
0:          sample (first 20): tensor([-0.5723, -0.6276, -0.5934, -0.6640, -0.6063, -0.6338, -0.6716, -0.6618, -0.6220, -0.6117, -0.6251, -0.7111,
0:         -0.5933, -0.6209, -0.6916, -0.6557, -0.7100, -0.6672, -0.6975, -0.7153])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000505906471516937
0: validation loss for velocity_v : 0.0008050377946346998
0: validation loss for specific_humidity : 1.8487320630811155e-05
0: validation loss for velocity_z : 0.001192940748296678
0: validation loss for temperature : 45632.06640625
0: validation loss for total_precip : 0.00037364489980973303
0: validation loss for t2m : 78078.3125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 369.32 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_030008-75c9gq3j[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_030008-75c9gq3j/logs[0m
0: Running global_forecast for 2015-05-18 08:00 ...
0: Wandb run: atmorep-kpo8z5us-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : kpo8z5us
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 8]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.135, max = -0.161, mean = -1.049
0:          sample (first 20): tensor([-0.5729, -0.6283, -0.5944, -0.6641, -0.6067, -0.6337, -0.6722, -0.6620, -0.6221, -0.6125, -0.6255, -0.7118,
0:         -0.5940, -0.6217, -0.6915, -0.6559, -0.7104, -0.6675, -0.6979, -0.7157])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.00048756226897239685
0: validation loss for velocity_v : 0.0008091534255072474
0: validation loss for specific_humidity : 1.8349690435570665e-05
0: validation loss for velocity_z : 0.001182577689178288
0: validation loss for temperature : 45625.25390625
0: validation loss for total_precip : 0.0003664339892566204
0: validation loss for t2m : 78078.2578125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 387.78 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_030626-kpo8z5us[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_030626-kpo8z5us/logs[0m
0: Running global_forecast for 2015-05-18 09:00 ...
0: Wandb run: atmorep-yx4j32j4-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : yx4j32j4
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 9]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.138, max = -0.162, mean = -1.052
0:          sample (first 20): tensor([-0.5739, -0.6296, -0.5944, -0.6652, -0.6079, -0.6349, -0.6729, -0.6632, -0.6233, -0.6134, -0.6269, -0.7128,
0:         -0.5944, -0.6221, -0.6926, -0.6572, -0.7111, -0.6693, -0.6989, -0.7168])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005678216111846268
0: validation loss for velocity_v : 0.0007712803781032562
0: validation loss for specific_humidity : 1.828022323024925e-05
0: validation loss for velocity_z : 0.0011933823116123676
0: validation loss for temperature : 45625.8984375
0: validation loss for total_precip : 0.00038882889202795923
0: validation loss for t2m : 78078.21875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 389.95 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_031302-yx4j32j4[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_031302-yx4j32j4/logs[0m
0: Running global_forecast for 2015-05-18 10:00 ...
0: Wandb run: atmorep-g6i2zo6b-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : g6i2zo6b
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 10]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.140, max = -0.160, mean = -1.055
0:          sample (first 20): tensor([-0.5739, -0.6299, -0.5949, -0.6654, -0.6079, -0.6350, -0.6735, -0.6632, -0.6234, -0.6137, -0.6267, -0.7131,
0:         -0.5950, -0.6225, -0.6930, -0.6577, -0.7114, -0.6693, -0.6989, -0.7171])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005432185134850442
0: validation loss for velocity_v : 0.0007734520477242768
0: validation loss for specific_humidity : 1.8158230886911042e-05
0: validation loss for velocity_z : 0.0011829932918772101
0: validation loss for temperature : 45619.25390625
0: validation loss for total_precip : 0.00038163832505233586
0: validation loss for t2m : 78078.171875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 382.06 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_031939-g6i2zo6b[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_031939-g6i2zo6b/logs[0m
0: Running global_forecast for 2015-05-18 11:00 ...
0: Wandb run: atmorep-0z9zixwi-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 0z9zixwi
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 11]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.143, max = -0.159, mean = -1.057
0:          sample (first 20): tensor([-0.5745, -0.6301, -0.5959, -0.6662, -0.6086, -0.6353, -0.6744, -0.6636, -0.6238, -0.6145, -0.6275, -0.7139,
0:         -0.5962, -0.6233, -0.6937, -0.6582, -0.7122, -0.6701, -0.6997, -0.7177])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005213671247474849
0: validation loss for velocity_v : 0.0007768464274704456
0: validation loss for specific_humidity : 1.8049426216748543e-05
0: validation loss for velocity_z : 0.0011726878583431244
0: validation loss for temperature : 45612.7890625
0: validation loss for total_precip : 0.0003744528512470424
0: validation loss for t2m : 78078.125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 287.48 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_032609-0z9zixwi[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_032609-0z9zixwi/logs[0m
0: Running global_forecast for 2015-05-18 12:00 ...
0: Wandb run: atmorep-yuy8rudl-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : yuy8rudl
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 12]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.145, max = -0.160, mean = -1.057
0:          sample (first 20): tensor([-0.5736, -0.6298, -0.5943, -0.6652, -0.6077, -0.6349, -0.6729, -0.6635, -0.6233, -0.6136, -0.6268, -0.7128,
0:         -0.5946, -0.6220, -0.6924, -0.6576, -0.7112, -0.6694, -0.6991, -0.7165])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008018430671654642
0: validation loss for velocity_v : 0.0008206248749047518
0: validation loss for specific_humidity : 1.7108404790633358e-05
0: validation loss for velocity_z : 0.00120811746455729
0: validation loss for temperature : 45616.8203125
0: validation loss for total_precip : 0.0003957492590416223
0: validation loss for t2m : 78077.9921875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 369.77 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_033104-yuy8rudl[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_033104-yuy8rudl/logs[0m
0: Running global_forecast for 2015-05-18 13:00 ...
0: Wandb run: atmorep-9psc4tmb-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 9psc4tmb
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 13]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.146, max = -0.159, mean = -1.060
0:          sample (first 20): tensor([-0.5747, -0.6309, -0.5957, -0.6665, -0.6088, -0.6360, -0.6747, -0.6643, -0.6242, -0.6148, -0.6278, -0.7140,
0:         -0.5959, -0.6234, -0.6938, -0.6589, -0.7126, -0.6706, -0.7003, -0.7179])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007675247034057975
0: validation loss for velocity_v : 0.0008195411064662039
0: validation loss for specific_humidity : 1.7052103430614807e-05
0: validation loss for velocity_z : 0.001197948819026351
0: validation loss for temperature : 45610.36328125
0: validation loss for total_precip : 0.0003881444572471082
0: validation loss for t2m : 78077.9453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 387.54 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_033721-9psc4tmb[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_033721-9psc4tmb/logs[0m
0: Running global_forecast for 2015-05-18 14:00 ...
0: Wandb run: atmorep-zzf3aljg-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : zzf3aljg
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 14]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.149, max = -0.158, mean = -1.062
0:          sample (first 20): tensor([-0.5753, -0.6315, -0.5969, -0.6670, -0.6094, -0.6366, -0.6758, -0.6650, -0.6249, -0.6156, -0.6285, -0.7150,
0:         -0.5971, -0.6242, -0.6945, -0.6595, -0.7135, -0.6714, -0.7009, -0.7185])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000735662819352001
0: validation loss for velocity_v : 0.0008200762094929814
0: validation loss for specific_humidity : 1.7009704606607556e-05
0: validation loss for velocity_z : 0.0011880317470058799
0: validation loss for temperature : 45603.9296875
0: validation loss for total_precip : 0.000380648416467011
0: validation loss for t2m : 78077.890625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 363.39 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_034356-zzf3aljg[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_034356-zzf3aljg/logs[0m
0: Running global_forecast for 2015-05-18 15:00 ...
0: Wandb run: atmorep-ffi77xdq-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : ffi77xdq
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 15]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.149, max = -0.159, mean = -1.064
0:          sample (first 20): tensor([-0.5757, -0.6322, -0.5964, -0.6674, -0.6102, -0.6372, -0.6756, -0.6653, -0.6253, -0.6163, -0.6291, -0.7154,
0:         -0.5970, -0.6244, -0.6946, -0.6598, -0.7137, -0.6721, -0.7014, -0.7188])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005548438639380038
0: validation loss for velocity_v : 0.0008233445696532726
0: validation loss for specific_humidity : 1.8503988030715846e-05
0: validation loss for velocity_z : 0.0011840382358059287
0: validation loss for temperature : 45603.18359375
0: validation loss for total_precip : 0.00038499542279168963
0: validation loss for t2m : 78077.828125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 375.41 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_035007-ffi77xdq[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_035007-ffi77xdq/logs[0m
0: Running global_forecast for 2015-05-18 16:00 ...
0: Wandb run: atmorep-kxcn5ct2-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : kxcn5ct2
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 16]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.151, max = -0.160, mean = -1.067
0:          sample (first 20): tensor([-0.5765, -0.6327, -0.5975, -0.6676, -0.6105, -0.6376, -0.6768, -0.6656, -0.6256, -0.6169, -0.6296, -0.7162,
0:         -0.5978, -0.6251, -0.6952, -0.6604, -0.7140, -0.6728, -0.7018, -0.7196])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005317624309100211
0: validation loss for velocity_v : 0.0008250639657489955
0: validation loss for specific_humidity : 1.8397820895188488e-05
0: validation loss for velocity_z : 0.0011741318739950657
0: validation loss for temperature : 45596.9296875
0: validation loss for total_precip : 0.00037775980308651924
0: validation loss for t2m : 78077.7734375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 408.24 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_035634-kxcn5ct2[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_035634-kxcn5ct2/logs[0m
0: Running global_forecast for 2015-05-18 17:00 ...
0: Wandb run: atmorep-ukszj5ko-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : ukszj5ko
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 17]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.153, max = -0.158, mean = -1.070
0:          sample (first 20): tensor([-0.5774, -0.6338, -0.5988, -0.6687, -0.6117, -0.6387, -0.6786, -0.6666, -0.6267, -0.6182, -0.6307, -0.7174,
0:         -0.5996, -0.6261, -0.6966, -0.6618, -0.7154, -0.6740, -0.7027, -0.7205])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005109682097099721
0: validation loss for velocity_v : 0.0008274679421447217
0: validation loss for specific_humidity : 1.8289687432115898e-05
0: validation loss for velocity_z : 0.0011645371560007334
0: validation loss for temperature : 45590.74609375
0: validation loss for total_precip : 0.0003705877752508968
0: validation loss for t2m : 78077.7421875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 399.90 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_040341-ukszj5ko[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_040341-ukszj5ko/logs[0m
0: Running global_forecast for 2015-05-18 18:00 ...
0: Wandb run: atmorep-r9s2imbj-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : r9s2imbj
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 18]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.154, max = -0.158, mean = -1.072
0:          sample (first 20): tensor([-0.5776, -0.6350, -0.5987, -0.6692, -0.6120, -0.6391, -0.6782, -0.6679, -0.6273, -0.6186, -0.6316, -0.7176,
0:         -0.5995, -0.6268, -0.6970, -0.6624, -0.7160, -0.6746, -0.7039, -0.7211])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005438023945316672
0: validation loss for velocity_v : 0.000825839932076633
0: validation loss for specific_humidity : 1.8382552298135124e-05
0: validation loss for velocity_z : 0.00116819201502949
0: validation loss for temperature : 45591.81640625
0: validation loss for total_precip : 0.00038835228770039976
0: validation loss for t2m : 78077.7265625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 381.16 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_041027-r9s2imbj[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_041027-r9s2imbj/logs[0m
0: Running global_forecast for 2015-05-18 19:00 ...
0: Wandb run: atmorep-h0w0tqb6-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : h0w0tqb6
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 19]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.156, max = -0.158, mean = -1.074
0:          sample (first 20): tensor([-0.5790, -0.6362, -0.6004, -0.6706, -0.6134, -0.6402, -0.6806, -0.6688, -0.6284, -0.6199, -0.6327, -0.7193,
0:         -0.6013, -0.6282, -0.6982, -0.6639, -0.7177, -0.6761, -0.7050, -0.7226])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005207792273722589
0: validation loss for velocity_v : 0.0008277337183244526
0: validation loss for specific_humidity : 1.8290347725269385e-05
0: validation loss for velocity_z : 0.0011582847218960524
0: validation loss for temperature : 45585.671875
0: validation loss for total_precip : 0.0003809529298450798
0: validation loss for t2m : 78077.6875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 318.37 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_041655-h0w0tqb6[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_041655-h0w0tqb6/logs[0m
0: Running global_forecast for 2015-05-18 20:00 ...
0: Wandb run: atmorep-zt215z0f-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : zt215z0f
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 20]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.157, max = -0.156, mean = -1.078
0:          sample (first 20): tensor([-0.5805, -0.6374, -0.6024, -0.6722, -0.6148, -0.6417, -0.6828, -0.6701, -0.6300, -0.6214, -0.6346, -0.7212,
0:         -0.6033, -0.6302, -0.7000, -0.6657, -0.7190, -0.6781, -0.7070, -0.7240])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005001014214940369
0: validation loss for velocity_v : 0.0008307501557283103
0: validation loss for specific_humidity : 1.821132354962174e-05
0: validation loss for velocity_z : 0.0011486278381198645
0: validation loss for temperature : 45579.6015625
0: validation loss for total_precip : 0.0003735336067620665
0: validation loss for t2m : 78077.640625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 387.52 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_042220-zt215z0f[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_042220-zt215z0f/logs[0m
0: Running global_forecast for 2015-05-18 21:00 ...
0: Wandb run: atmorep-cbau505y-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : cbau505y
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 21]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.159, max = -0.157, mean = -1.080
0:          sample (first 20): tensor([-0.5797, -0.6375, -0.6011, -0.6716, -0.6143, -0.6413, -0.6811, -0.6700, -0.6289, -0.6209, -0.6338, -0.7205,
0:         -0.6021, -0.6289, -0.6989, -0.6646, -0.7181, -0.6772, -0.7065, -0.7233])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005693511920981109
0: validation loss for velocity_v : 0.0007915585301816463
0: validation loss for specific_humidity : 1.8087916032527573e-05
0: validation loss for velocity_z : 0.0011659546289592981
0: validation loss for temperature : 45580.65234375
0: validation loss for total_precip : 0.00038939996738918126
0: validation loss for t2m : 78077.578125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 388.24 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_042901-cbau505y[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_042901-cbau505y/logs[0m
0: Running global_forecast for 2015-05-18 22:00 ...
0: Wandb run: atmorep-ylkcuy67-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : ylkcuy67
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 22]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.160, max = -0.155, mean = -1.083
0:          sample (first 20): tensor([-0.5807, -0.6387, -0.6026, -0.6729, -0.6155, -0.6425, -0.6829, -0.6708, -0.6303, -0.6221, -0.6351, -0.7220,
0:         -0.6036, -0.6303, -0.7004, -0.6662, -0.7196, -0.6788, -0.7076, -0.7246])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005440555978566408
0: validation loss for velocity_v : 0.000792967970483005
0: validation loss for specific_humidity : 1.801837788661942e-05
0: validation loss for velocity_z : 0.0011561468709260225
0: validation loss for temperature : 45574.75390625
0: validation loss for total_precip : 0.0003819862031377852
0: validation loss for t2m : 78077.5390625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 378.94 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_043542-ylkcuy67[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_043542-ylkcuy67/logs[0m
0: Running global_forecast for 2015-05-18 23:00 ...
0: Wandb run: atmorep-uf4vtuee-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : uf4vtuee
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 18, 23]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.161, max = -0.155, mean = -1.086
0:          sample (first 20): tensor([-0.5805, -0.6384, -0.6031, -0.6725, -0.6152, -0.6421, -0.6835, -0.6708, -0.6301, -0.6223, -0.6351, -0.7220,
0:         -0.6039, -0.6303, -0.7003, -0.6662, -0.7200, -0.6786, -0.7074, -0.7247])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005214335396885872
0: validation loss for velocity_v : 0.0007952681044116616
0: validation loss for specific_humidity : 1.7957798263523728e-05
0: validation loss for velocity_z : 0.0011466059368103743
0: validation loss for temperature : 45568.90625
0: validation loss for total_precip : 0.0003746414731722325
0: validation loss for t2m : 78077.4921875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 356.39 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_044212-uf4vtuee[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_044212-uf4vtuee/logs[0m
0: Running global_forecast for 2015-05-19 00:00 ...
0: Wandb run: atmorep-v7ilaulc-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : v7ilaulc
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 0]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.106, max = -0.164, mean = -1.029
0:          sample (first 20): tensor([-0.5676, -0.6216, -0.5880, -0.6585, -0.6008, -0.6284, -0.6644, -0.6558, -0.6165, -0.6058, -0.6192, -0.7045,
0:         -0.5867, -0.6148, -0.6848, -0.6495, -0.7037, -0.6600, -0.6909, -0.7094])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007694931700825691
0: validation loss for velocity_v : 0.0008161720470525324
0: validation loss for specific_humidity : 1.7878764992929064e-05
0: validation loss for velocity_z : 0.0013279224513098598
0: validation loss for temperature : 45667.4453125
0: validation loss for total_precip : 0.00043801774154417217
0: validation loss for t2m : 78078.609375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 387.58 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_044819-v7ilaulc[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_044819-v7ilaulc/logs[0m
0: Running global_forecast for 2015-05-19 01:00 ...
0: Wandb run: atmorep-kutiw18u-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : kutiw18u
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 1]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.112, max = -0.164, mean = -1.031
0:          sample (first 20): tensor([-0.5690, -0.6227, -0.5897, -0.6597, -0.6022, -0.6295, -0.6665, -0.6570, -0.6180, -0.6071, -0.6207, -0.7058,
0:         -0.5881, -0.6167, -0.6866, -0.6506, -0.7050, -0.6613, -0.6926, -0.7106])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007372690015472472
0: validation loss for velocity_v : 0.0008141688886098564
0: validation loss for specific_humidity : 1.771986353560351e-05
0: validation loss for velocity_z : 0.0013156365603208542
0: validation loss for temperature : 45660.06640625
0: validation loss for total_precip : 0.00042937882244586945
0: validation loss for t2m : 78078.5703125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 366.16 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_045453-kutiw18u[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_045453-kutiw18u/logs[0m
0: Running global_forecast for 2015-05-19 02:00 ...
0: Wandb run: atmorep-geuzv0kh-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : geuzv0kh
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 2]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.115, max = -0.163, mean = -1.034
0:          sample (first 20): tensor([-0.5690, -0.6225, -0.5900, -0.6598, -0.6020, -0.6296, -0.6669, -0.6566, -0.6180, -0.6069, -0.6206, -0.7062,
0:         -0.5887, -0.6165, -0.6865, -0.6512, -0.7052, -0.6613, -0.6923, -0.7107])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007071822765283287
0: validation loss for velocity_v : 0.0008132720831781626
0: validation loss for specific_humidity : 1.7592321455595084e-05
0: validation loss for velocity_z : 0.001303287805058062
0: validation loss for temperature : 45652.87890625
0: validation loss for total_precip : 0.0004209411272313446
0: validation loss for t2m : 78078.53125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 372.63 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_050106-geuzv0kh[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_050106-geuzv0kh/logs[0m
0: Running global_forecast for 2015-05-19 03:00 ...
0: Wandb run: atmorep-1oncwa48-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 1oncwa48
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 3]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.117, max = -0.163, mean = -1.037
0:          sample (first 20): tensor([-0.5699, -0.6249, -0.5905, -0.6612, -0.6036, -0.6312, -0.6678, -0.6587, -0.6191, -0.6087, -0.6221, -0.7080,
0:         -0.5898, -0.6178, -0.6882, -0.6527, -0.7066, -0.6633, -0.6942, -0.7122])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000527549593243748
0: validation loss for velocity_v : 0.0007967444835230708
0: validation loss for specific_humidity : 1.886418067442719e-05
0: validation loss for velocity_z : 0.0012206563260406256
0: validation loss for temperature : 45651.63671875
0: validation loss for total_precip : 0.0003741694090422243
0: validation loss for t2m : 78078.4921875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 272.70 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_050732-1oncwa48[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_050732-1oncwa48/logs[0m
0: Running global_forecast for 2015-05-19 04:00 ...
0: Wandb run: atmorep-5ykocfwk-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 5ykocfwk
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 4]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.124, max = -0.162, mean = -1.040
0:          sample (first 20): tensor([-0.5704, -0.6252, -0.5912, -0.6616, -0.6040, -0.6315, -0.6688, -0.6589, -0.6195, -0.6092, -0.6225, -0.7087,
0:         -0.5906, -0.6184, -0.6888, -0.6531, -0.7074, -0.6642, -0.6947, -0.7130])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000507292163092643
0: validation loss for velocity_v : 0.0007999615627340972
0: validation loss for specific_humidity : 1.8705028196563944e-05
0: validation loss for velocity_z : 0.0012098306324332952
0: validation loss for temperature : 45644.48046875
0: validation loss for total_precip : 0.0003668677236419171
0: validation loss for t2m : 78078.4453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 363.36 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_051211-5ykocfwk[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_051211-5ykocfwk/logs[0m
0: Running global_forecast for 2015-05-19 05:00 ...
0: Wandb run: atmorep-nkzrhvqa-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : nkzrhvqa
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 5]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.125, max = -0.161, mean = -1.042
0:          sample (first 20): tensor([-0.5723, -0.6271, -0.5938, -0.6635, -0.6059, -0.6331, -0.6713, -0.6608, -0.6215, -0.6114, -0.6243, -0.7110,
0:         -0.5928, -0.6205, -0.6910, -0.6550, -0.7092, -0.6662, -0.6963, -0.7150])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0004888582625426352
0: validation loss for velocity_v : 0.0008044521091505885
0: validation loss for specific_humidity : 1.856481503637042e-05
0: validation loss for velocity_z : 0.0011993431253358722
0: validation loss for temperature : 45637.453125
0: validation loss for total_precip : 0.00035956871579401195
0: validation loss for t2m : 78078.3828125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 390.18 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_051829-nkzrhvqa[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_051829-nkzrhvqa/logs[0m
0: Running global_forecast for 2015-05-19 06:00 ...
0: Wandb run: atmorep-cnkjmere-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : cnkjmere
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 6]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.127, max = -0.161, mean = -1.045
0:          sample (first 20): tensor([-0.5716, -0.6269, -0.5923, -0.6634, -0.6052, -0.6330, -0.6700, -0.6611, -0.6208, -0.6106, -0.6242, -0.7103,
0:         -0.5919, -0.6204, -0.6903, -0.6547, -0.7088, -0.6661, -0.6964, -0.7145])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005265171639621258
0: validation loss for velocity_v : 0.0008018974913284183
0: validation loss for specific_humidity : 1.863317083916627e-05
0: validation loss for velocity_z : 0.0012034656247124076
0: validation loss for temperature : 45638.8984375
0: validation loss for total_precip : 0.0003811046190094203
0: validation loss for t2m : 78078.34375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 360.69 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_052511-cnkjmere[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_052511-cnkjmere/logs[0m
0: Running global_forecast for 2015-05-19 07:00 ...
0: Wandb run: atmorep-k4vny2h4-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : k4vny2h4
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 7]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.131, max = -0.161, mean = -1.047
0:          sample (first 20): tensor([-0.5725, -0.6280, -0.5936, -0.6639, -0.6065, -0.6337, -0.6715, -0.6619, -0.6221, -0.6118, -0.6251, -0.7112,
0:         -0.5934, -0.6210, -0.6917, -0.6557, -0.7099, -0.6673, -0.6975, -0.7155])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005059741088189185
0: validation loss for velocity_v : 0.0008049574098549783
0: validation loss for specific_humidity : 1.8485416148905642e-05
0: validation loss for velocity_z : 0.001192705356515944
0: validation loss for temperature : 45632.11328125
0: validation loss for total_precip : 0.00037370785139501095
0: validation loss for t2m : 78078.3046875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 345.63 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_053119-k4vny2h4[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_053119-k4vny2h4/logs[0m
0: Running global_forecast for 2015-05-19 08:00 ...
0: Wandb run: atmorep-tsjzzqur-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : tsjzzqur
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 8]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.135, max = -0.160, mean = -1.049
0:          sample (first 20): tensor([-0.5732, -0.6284, -0.5945, -0.6643, -0.6067, -0.6342, -0.6725, -0.6624, -0.6225, -0.6125, -0.6257, -0.7120,
0:         -0.5942, -0.6219, -0.6920, -0.6563, -0.7108, -0.6678, -0.6979, -0.7161])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0004875783051829785
0: validation loss for velocity_v : 0.0008093451033346355
0: validation loss for specific_humidity : 1.834997055993881e-05
0: validation loss for velocity_z : 0.0011824072571471334
0: validation loss for temperature : 45625.23828125
0: validation loss for total_precip : 0.0003664919931907207
0: validation loss for t2m : 78078.2578125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 377.41 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_053720-tsjzzqur[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_053720-tsjzzqur/logs[0m
0: Running global_forecast for 2015-05-19 09:00 ...
0: Wandb run: atmorep-wo9ghq6j-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : wo9ghq6j
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 9]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.137, max = -0.161, mean = -1.053
0:          sample (first 20): tensor([-0.5735, -0.6295, -0.5938, -0.6649, -0.6075, -0.6347, -0.6723, -0.6630, -0.6228, -0.6129, -0.6263, -0.7125,
0:         -0.5939, -0.6220, -0.6925, -0.6567, -0.7108, -0.6686, -0.6983, -0.7166])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005678856978192925
0: validation loss for velocity_v : 0.0007713056984357536
0: validation loss for specific_humidity : 1.8278549759997986e-05
0: validation loss for velocity_z : 0.001193238771520555
0: validation loss for temperature : 45625.93359375
0: validation loss for total_precip : 0.00038886218681000173
0: validation loss for t2m : 78078.2109375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 386.57 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_054356-wo9ghq6j[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_054356-wo9ghq6j/logs[0m
0: Running global_forecast for 2015-05-19 10:00 ...
0: Wandb run: atmorep-dk2pcaha-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : dk2pcaha
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 10]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.140, max = -0.160, mean = -1.055
0:          sample (first 20): tensor([-0.5740, -0.6296, -0.5948, -0.6655, -0.6080, -0.6351, -0.6734, -0.6631, -0.6235, -0.6137, -0.6270, -0.7131,
0:         -0.5949, -0.6225, -0.6929, -0.6575, -0.7113, -0.6693, -0.6991, -0.7172])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005432710167951882
0: validation loss for velocity_v : 0.0007735703838989139
0: validation loss for specific_humidity : 1.815581344999373e-05
0: validation loss for velocity_z : 0.001182872918434441
0: validation loss for temperature : 45619.26953125
0: validation loss for total_precip : 0.0003816476964857429
0: validation loss for t2m : 78078.171875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 371.33 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_055032-dk2pcaha[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_055032-dk2pcaha/logs[0m
0: Running global_forecast for 2015-05-19 11:00 ...
0: Wandb run: atmorep-jxnrxe52-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : jxnrxe52
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 11]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.144, max = -0.159, mean = -1.058
0:          sample (first 20): tensor([-0.5754, -0.6309, -0.5966, -0.6669, -0.6094, -0.6363, -0.6752, -0.6642, -0.6245, -0.6153, -0.6283, -0.7145,
0:         -0.5968, -0.6241, -0.6946, -0.6589, -0.7131, -0.6710, -0.7003, -0.7186])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005213326076045632
0: validation loss for velocity_v : 0.000776885892264545
0: validation loss for specific_humidity : 1.804447492759209e-05
0: validation loss for velocity_z : 0.0011725834337994456
0: validation loss for temperature : 45612.828125
0: validation loss for total_precip : 0.00037444758345372975
0: validation loss for t2m : 78078.125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 280.81 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_055655-jxnrxe52[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_055655-jxnrxe52/logs[0m
0: Running global_forecast for 2015-05-19 12:00 ...
0: Wandb run: atmorep-6egzlzan-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 6egzlzan
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 12]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.144, max = -0.160, mean = -1.057
0:          sample (first 20): tensor([-0.5732, -0.6295, -0.5940, -0.6650, -0.6071, -0.6343, -0.6725, -0.6631, -0.6227, -0.6134, -0.6263, -0.7124,
0:         -0.5942, -0.6216, -0.6920, -0.6570, -0.7109, -0.6688, -0.6989, -0.7163])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0008018670487217605
0: validation loss for velocity_v : 0.0008205376798287034
0: validation loss for specific_humidity : 1.7106669474742375e-05
0: validation loss for velocity_z : 0.001208070432767272
0: validation loss for temperature : 45616.76953125
0: validation loss for total_precip : 0.00039578767609782517
0: validation loss for t2m : 78077.9921875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 375.26 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_060149-6egzlzan[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_060149-6egzlzan/logs[0m
0: Running global_forecast for 2015-05-19 13:00 ...
0: Wandb run: atmorep-bksb2xg5-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : bksb2xg5
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 13]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.147, max = -0.159, mean = -1.061
0:          sample (first 20): tensor([-0.5750, -0.6311, -0.5962, -0.6669, -0.6092, -0.6363, -0.6750, -0.6645, -0.6245, -0.6153, -0.6281, -0.7144,
0:         -0.5964, -0.6236, -0.6942, -0.6592, -0.7129, -0.6710, -0.7007, -0.7183])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007674652151763439
0: validation loss for velocity_v : 0.0008197702118195593
0: validation loss for specific_humidity : 1.7051552276825532e-05
0: validation loss for velocity_z : 0.0011978173861280084
0: validation loss for temperature : 45610.34765625
0: validation loss for total_precip : 0.0003881766169797629
0: validation loss for t2m : 78077.9453125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 362.41 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_060829-bksb2xg5[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_060829-bksb2xg5/logs[0m
0: Running global_forecast for 2015-05-19 14:00 ...
0: Wandb run: atmorep-vnvjsmd0-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : vnvjsmd0
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 14]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.149, max = -0.158, mean = -1.062
0:          sample (first 20): tensor([-0.5754, -0.6313, -0.5970, -0.6672, -0.6097, -0.6369, -0.6760, -0.6652, -0.6253, -0.6158, -0.6288, -0.7154,
0:         -0.5973, -0.6244, -0.6949, -0.6596, -0.7136, -0.6715, -0.7010, -0.7186])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007356562418863177
0: validation loss for velocity_v : 0.0008200265001505613
0: validation loss for specific_humidity : 1.7006379493977875e-05
0: validation loss for velocity_z : 0.0011879662051796913
0: validation loss for temperature : 45603.9140625
0: validation loss for total_precip : 0.0003807223401963711
0: validation loss for t2m : 78077.90625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 380.28 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_061444-vnvjsmd0[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_061444-vnvjsmd0/logs[0m
0: Running global_forecast for 2015-05-19 15:00 ...
0: Wandb run: atmorep-d7eaplzu-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : d7eaplzu
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 15]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.149, max = -0.160, mean = -1.064
0:          sample (first 20): tensor([-0.5752, -0.6319, -0.5960, -0.6669, -0.6095, -0.6365, -0.6752, -0.6650, -0.6247, -0.6158, -0.6285, -0.7149,
0:         -0.5964, -0.6237, -0.6943, -0.6591, -0.7130, -0.6715, -0.7006, -0.7183])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005548132467083633
0: validation loss for velocity_v : 0.0008233565022237599
0: validation loss for specific_humidity : 1.85009375854861e-05
0: validation loss for velocity_z : 0.001184001099318266
0: validation loss for temperature : 45603.2109375
0: validation loss for total_precip : 0.0003850563371088356
0: validation loss for t2m : 78077.8125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 365.00 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_062119-d7eaplzu[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_062119-d7eaplzu/logs[0m
0: Running global_forecast for 2015-05-19 16:00 ...
0: Wandb run: atmorep-uop6df5l-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : uop6df5l
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 16]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.151, max = -0.159, mean = -1.067
0:          sample (first 20): tensor([-0.5762, -0.6325, -0.5973, -0.6675, -0.6104, -0.6374, -0.6766, -0.6657, -0.6255, -0.6167, -0.6295, -0.7161,
0:         -0.5979, -0.6249, -0.6951, -0.6605, -0.7139, -0.6725, -0.7016, -0.7194])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005318198236636817
0: validation loss for velocity_v : 0.0008248619269579649
0: validation loss for specific_humidity : 1.839125616243109e-05
0: validation loss for velocity_z : 0.0011740275658667088
0: validation loss for temperature : 45596.9453125
0: validation loss for total_precip : 0.00037782901199534535
0: validation loss for t2m : 78077.7734375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 356.53 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_062730-uop6df5l[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_062730-uop6df5l/logs[0m
0: Running global_forecast for 2015-05-19 17:00 ...
0: Wandb run: atmorep-rgbo3a0k-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : rgbo3a0k
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 17]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.153, max = -0.158, mean = -1.070
0:          sample (first 20): tensor([-0.5782, -0.6346, -0.5996, -0.6695, -0.6124, -0.6394, -0.6793, -0.6676, -0.6273, -0.6192, -0.6313, -0.7182,
0:         -0.6000, -0.6270, -0.6974, -0.6627, -0.7161, -0.6748, -0.7034, -0.7210])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005110055790282786
0: validation loss for velocity_v : 0.0008274299325421453
0: validation loss for specific_humidity : 1.829167376854457e-05
0: validation loss for velocity_z : 0.0011644557816907763
0: validation loss for temperature : 45590.72265625
0: validation loss for total_precip : 0.0003706263960339129
0: validation loss for t2m : 78077.7421875
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 360.42 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_063334-rgbo3a0k[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_063334-rgbo3a0k/logs[0m
0: Running global_forecast for 2015-05-19 18:00 ...
0: Wandb run: atmorep-3tco54u3-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 3tco54u3
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 18]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.155, max = -0.157, mean = -1.072
0:          sample (first 20): tensor([-0.5781, -0.6353, -0.5990, -0.6696, -0.6126, -0.6395, -0.6788, -0.6683, -0.6276, -0.6189, -0.6320, -0.7182,
0:         -0.5998, -0.6272, -0.6974, -0.6627, -0.7163, -0.6752, -0.7045, -0.7217])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.000543867819942534
0: validation loss for velocity_v : 0.0008259832393378019
0: validation loss for specific_humidity : 1.838194475567434e-05
0: validation loss for velocity_z : 0.0011680835159495473
0: validation loss for temperature : 45591.8125
0: validation loss for total_precip : 0.0003884253092110157
0: validation loss for t2m : 78077.7265625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 391.37 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_063951-3tco54u3[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_063951-3tco54u3/logs[0m
0: Running global_forecast for 2015-05-19 19:00 ...
0: Wandb run: atmorep-nqn8nctp-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : nqn8nctp
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 19]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.156, max = -0.157, mean = -1.074
0:          sample (first 20): tensor([-0.5792, -0.6365, -0.6005, -0.6710, -0.6138, -0.6405, -0.6806, -0.6691, -0.6287, -0.6201, -0.6332, -0.7196,
0:         -0.6016, -0.6286, -0.6987, -0.6641, -0.7177, -0.6768, -0.7055, -0.7228])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005208018701523542
0: validation loss for velocity_v : 0.0008277946035377681
0: validation loss for specific_humidity : 1.8287495549884625e-05
0: validation loss for velocity_z : 0.0011581871658563614
0: validation loss for temperature : 45585.6875
0: validation loss for total_precip : 0.0003810098860412836
0: validation loss for t2m : 78077.6953125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 286.29 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_064635-nqn8nctp[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_064635-nqn8nctp/logs[0m
0: Running global_forecast for 2015-05-19 20:00 ...
0: Wandb run: atmorep-fedi88v7-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : fedi88v7
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 20]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.157, max = -0.156, mean = -1.078
0:          sample (first 20): tensor([-0.5808, -0.6378, -0.6026, -0.6725, -0.6152, -0.6418, -0.6826, -0.6703, -0.6301, -0.6215, -0.6344, -0.7214,
0:         -0.6036, -0.6302, -0.7002, -0.6658, -0.7191, -0.6784, -0.7068, -0.7243])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005000864039175212
0: validation loss for velocity_v : 0.0008307531825266778
0: validation loss for specific_humidity : 1.821065234253183e-05
0: validation loss for velocity_z : 0.0011484930291771889
0: validation loss for temperature : 45579.59375
0: validation loss for total_precip : 0.00037357525434345007
0: validation loss for t2m : 78077.640625
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 374.96 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_065128-fedi88v7[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_065128-fedi88v7/logs[0m
0: Running global_forecast for 2015-05-19 21:00 ...
0: Wandb run: atmorep-0hxchife-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 0hxchife
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 21]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.158, max = -0.157, mean = -1.081
0:          sample (first 20): tensor([-0.5796, -0.6373, -0.6010, -0.6717, -0.6143, -0.6411, -0.6811, -0.6700, -0.6289, -0.6208, -0.6338, -0.7207,
0:         -0.6020, -0.6288, -0.6988, -0.6647, -0.7183, -0.6773, -0.7061, -0.7234])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005693690618500113
0: validation loss for velocity_v : 0.0007917029433883727
0: validation loss for specific_humidity : 1.808306114980951e-05
0: validation loss for velocity_z : 0.0011658333241939545
0: validation loss for temperature : 45580.68359375
0: validation loss for total_precip : 0.00038943294202908874
0: validation loss for t2m : 78077.5859375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 345.89 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_065749-0hxchife[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_065749-0hxchife/logs[0m
0: Running global_forecast for 2015-05-19 22:00 ...
0: Wandb run: atmorep-r5neey0s-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : r5neey0s
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 22]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.160, max = -0.156, mean = -1.084
0:          sample (first 20): tensor([-0.5812, -0.6390, -0.6031, -0.6733, -0.6160, -0.6428, -0.6836, -0.6714, -0.6306, -0.6224, -0.6356, -0.7224,
0:         -0.6043, -0.6308, -0.7011, -0.6666, -0.7201, -0.6795, -0.7082, -0.7252])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005440933164209127
0: validation loss for velocity_v : 0.0007930678548291326
0: validation loss for specific_humidity : 1.8015651221503504e-05
0: validation loss for velocity_z : 0.0011560146231204271
0: validation loss for temperature : 45574.76171875
0: validation loss for total_precip : 0.0003820464189630002
0: validation loss for t2m : 78077.53125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 363.04 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_070352-r5neey0s[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_070352-r5neey0s/logs[0m
0: Running global_forecast for 2015-05-19 23:00 ...
0: Wandb run: atmorep-n6ax6dd4-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : n6ax6dd4
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 19, 23]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.161, max = -0.155, mean = -1.086
0:          sample (first 20): tensor([-0.5806, -0.6384, -0.6032, -0.6726, -0.6152, -0.6421, -0.6834, -0.6706, -0.6301, -0.6223, -0.6350, -0.7222,
0:         -0.6039, -0.6303, -0.7003, -0.6660, -0.7199, -0.6787, -0.7076, -0.7246])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005214104312472045
0: validation loss for velocity_v : 0.0007953163585625589
0: validation loss for specific_humidity : 1.7955257135326974e-05
0: validation loss for velocity_z : 0.0011465377174317837
0: validation loss for temperature : 45568.8828125
0: validation loss for total_precip : 0.0003746856236830354
0: validation loss for t2m : 78077.484375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 378.28 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_071015-n6ax6dd4[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_071015-n6ax6dd4/logs[0m
0: Running global_forecast for 2015-05-20 00:00 ...
0: Wandb run: atmorep-9qj9f89q-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 9qj9f89q
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 20, 0]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.106, max = -0.165, mean = -1.029
0:          sample (first 20): tensor([-0.5674, -0.6215, -0.5879, -0.6580, -0.6006, -0.6280, -0.6642, -0.6556, -0.6164, -0.6054, -0.6190, -0.7042,
0:         -0.5864, -0.6145, -0.6850, -0.6493, -0.7033, -0.6596, -0.6906, -0.7091])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007694618543609977
0: validation loss for velocity_v : 0.0008160147117450833
0: validation loss for specific_humidity : 1.7876016499940306e-05
0: validation loss for velocity_z : 0.0013278088299557567
0: validation loss for temperature : 45667.47265625
0: validation loss for total_precip : 0.0004380911123007536
0: validation loss for t2m : 78078.609375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 378.64 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_071649-9qj9f89q[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_071649-9qj9f89q/logs[0m
0: Running global_forecast for 2015-05-20 01:00 ...
0: Wandb run: atmorep-pf28mcgn-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : pf28mcgn
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 20, 1]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.111, max = -0.164, mean = -1.031
0:          sample (first 20): tensor([-0.5679, -0.6217, -0.5887, -0.6588, -0.6011, -0.6284, -0.6654, -0.6562, -0.6171, -0.6062, -0.6196, -0.7051,
0:         -0.5872, -0.6155, -0.6855, -0.6497, -0.7038, -0.6601, -0.6917, -0.7096])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007372453692369163
0: validation loss for velocity_v : 0.0008142014848999679
0: validation loss for specific_humidity : 1.7719390598358586e-05
0: validation loss for velocity_z : 0.001315488014370203
0: validation loss for temperature : 45660.10546875
0: validation loss for total_precip : 0.0004294489626772702
0: validation loss for t2m : 78078.578125
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 395.36 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_072319-pf28mcgn[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_072319-pf28mcgn/logs[0m
0: Running global_forecast for 2015-05-20 02:00 ...
0: Wandb run: atmorep-davogc5p-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : davogc5p
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 20, 2]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.114, max = -0.163, mean = -1.034
0:          sample (first 20): tensor([-0.5691, -0.6227, -0.5903, -0.6599, -0.6023, -0.6296, -0.6671, -0.6566, -0.6181, -0.6072, -0.6209, -0.7063,
0:         -0.5887, -0.6167, -0.6867, -0.6510, -0.7053, -0.6615, -0.6923, -0.7110])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0007072541047818959
0: validation loss for velocity_v : 0.0008133418159559369
0: validation loss for specific_humidity : 1.7591286450624466e-05
0: validation loss for velocity_z : 0.0013031999114900827
0: validation loss for temperature : 45652.8203125
0: validation loss for total_precip : 0.0004209777689538896
0: validation loss for t2m : 78078.5234375
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 370.87 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_073007-davogc5p[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_073007-davogc5p/logs[0m
0: Running global_forecast for 2015-05-20 03:00 ...
0: Wandb run: atmorep-23es5mi4-19707389
0: Running Evaluate.evaluate with mode = global_forecast
0: With config:
0: model_id = iuw3ce3v_single_gpu
0: time_pos = N/A
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: ['cuda:0'] 0
0: Loaded model id = iuw3ce3v_single_gpu.
0: Number of batches per global forecast: 14
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 1
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity', 'temperature'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['corrected_t2m', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity', 't2m'], 0], [0], [12, 2, 4], [3, 27, 27], [0.1, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.2], ['corrected_t2m', 0.38]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : None
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 1
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : global_forecast
0: forecast_num_tokens : 1
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 1
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 19707389
0: wandb_id : 23es5mi4
0: file_path : /scratch/a/a270277/atmorep/era5_y2010_2020_res25_corrected_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : dhap4i9v
0: years_test : [2021]
0: with_pytest : False
0: batch_size_test : 24
0: dates : [[2015, 5, 20, 3]]
0: token_overlap : [0, 0]
0: 
0: [DEBUG] Log Validate Forecast Denormalized values for corrected_t2m:
0: Source values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: Target values (first 20):
0: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
0: it == 0 and starting val norms printouts
0: [DEBUG] PREDICTIONS VALIDATION BATCH
0: Normalised validation prediction values for 'corrected_t2m' with shape: torch.Size([8, 2187])
0:          min = -3.119, max = -0.163, mean = -1.037
0:          sample (first 20): tensor([-0.5692, -0.6243, -0.5899, -0.6604, -0.6030, -0.6304, -0.6673, -0.6582, -0.6186, -0.6083, -0.6213, -0.7075,
0:         -0.5892, -0.6172, -0.6877, -0.6521, -0.7062, -0.6629, -0.6936, -0.7120])
0: validation loss for strategy=global_forecast at epoch 0 : nan
0: validation loss for velocity_u : 0.0005275922012515366
0: validation loss for velocity_v : 0.0007968925056047738
0: validation loss for specific_humidity : 1.8863045625039376e-05
0: validation loss for velocity_z : 0.001220500678755343
0: validation loss for temperature : 45651.5859375
0: validation loss for total_precip : 0.0003742105036508292
0: validation loss for t2m : 78078.5
0: validation loss for corrected_t2m : nan
0: Evaluation completed in 281.34 seconds.
0: [1;34mwandb[0m:
0: [1;34mwandb[0m: You can sync this run to the cloud by running:
0: [1;34mwandb[0m: [1mwandb sync /work/ab1412/atmorep/wandb/offline-run-20250926_073629-23es5mi4[0m
0: [1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250926_073629-23es5mi4/logs[0m
