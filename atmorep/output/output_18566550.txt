0: Wandb run: atmorep-d8pg8z6q-18566550
0: l50112:3633303:3633303 [0] NCCL INFO Bootstrap : Using ib0:10.128.11.170<0>
0: l50112:3633303:3633303 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
0: l50112:3633303:3633303 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
0: l50112:3633303:3633303 [0] NCCL INFO NET/Plugin: Using internal network plugin.
0: l50112:3633303:3633303 [0] NCCL INFO cudaDriverVersion 12060
0: NCCL version 2.21.5+cuda12.4
1: l50145:2760187:2760187 [0] NCCL INFO cudaDriverVersion 12060
1: l50145:2760187:2760187 [0] NCCL INFO Bootstrap : Using ib0:10.128.11.192<0>
1: l50145:2760187:2760187 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
1: l50145:2760187:2760187 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
1: l50145:2760187:2760187 [0] NCCL INFO NET/Plugin: Using internal network plugin.
0: l50112:3633303:3633818 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib0:10.128.11.170<0>
0: l50112:3633303:3633818 [0] NCCL INFO Using non-device net plugin version 0
0: l50112:3633303:3633818 [0] NCCL INFO Using network IB
0: l50112:3633303:3633818 [0] NCCL INFO DMA-BUF is available on GPU device 0
1: l50145:2760187:2760426 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib0:10.128.11.192<0>
1: l50145:2760187:2760426 [0] NCCL INFO Using non-device net plugin version 0
1: l50145:2760187:2760426 [0] NCCL INFO Using network IB
1: l50145:2760187:2760426 [0] NCCL INFO DMA-BUF is available on GPU device 0
0: l50112:3633303:3633818 [0] NCCL INFO ncclCommInitRank comm 0x55555f0e7700 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0x6da1b54506a0fb95 - Init START
1: l50145:2760187:2760426 [0] NCCL INFO ncclCommInitRank comm 0x55555ec9c560 rank 1 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0x6da1b54506a0fb95 - Init START
0: l50112:3633303:3633818 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
1: l50145:2760187:2760426 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
1: l50145:2760187:2760426 [0] NCCL INFO comm 0x55555ec9c560 rank 1 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
1: l50145:2760187:2760426 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] 0/-1/-1->1->-1 [3] 0/-1/-1->1->-1
1: l50145:2760187:2760426 [0] NCCL INFO P2P Chunksize set to 131072
0: l50112:3633303:3633818 [0] NCCL INFO comm 0x55555f0e7700 rank 0 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
0: l50112:3633303:3633818 [0] NCCL INFO Channel 00/04 :    0   1
0: l50112:3633303:3633818 [0] NCCL INFO Channel 01/04 :    0   1
0: l50112:3633303:3633818 [0] NCCL INFO Channel 02/04 :    0   1
0: l50112:3633303:3633818 [0] NCCL INFO Channel 03/04 :    0   1
0: l50112:3633303:3633818 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] -1/-1/-1->0->1 [3] -1/-1/-1->0->1
0: l50112:3633303:3633818 [0] NCCL INFO P2P Chunksize set to 131072
0: l50112:3633303:3633818 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [receive] via NET/IB/0
0: l50112:3633303:3633818 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [receive] via NET/IB/1
0: l50112:3633303:3633818 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [receive] via NET/IB/0
0: l50112:3633303:3633818 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [receive] via NET/IB/1
0: l50112:3633303:3633818 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [send] via NET/IB/0
0: l50112:3633303:3633818 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [send] via NET/IB/1
0: l50112:3633303:3633818 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [send] via NET/IB/0
0: l50112:3633303:3633818 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [send] via NET/IB/1
1: l50145:2760187:2760426 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [receive] via NET/IB/0
1: l50145:2760187:2760426 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [receive] via NET/IB/1
1: l50145:2760187:2760426 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [receive] via NET/IB/0
1: l50145:2760187:2760426 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [receive] via NET/IB/1
1: l50145:2760187:2760426 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [send] via NET/IB/0
1: l50145:2760187:2760426 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [send] via NET/IB/1
1: l50145:2760187:2760426 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [send] via NET/IB/0
1: l50145:2760187:2760426 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [send] via NET/IB/1
1: l50145:2760187:2760429 [0] NCCL INFO NCCL_IB_TIMEOUT set by environment to 250.
1: l50145:2760187:2760429 [0] NCCL INFO NCCL_IB_RETRY_CNT set by environment to 50.
0: l50112:3633303:3633821 [0] NCCL INFO NCCL_IB_TIMEOUT set by environment to 250.
0: l50112:3633303:3633821 [0] NCCL INFO NCCL_IB_RETRY_CNT set by environment to 50.
0: l50112:3633303:3633818 [0] NCCL INFO Connected all rings
0: l50112:3633303:3633818 [0] NCCL INFO Connected all trees
1: l50145:2760187:2760426 [0] NCCL INFO Connected all rings
1: l50145:2760187:2760426 [0] NCCL INFO Connected all trees
0: l50112:3633303:3633818 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
0: l50112:3633303:3633818 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
1: l50145:2760187:2760426 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
1: l50145:2760187:2760426 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
0: l50112:3633303:3633818 [0] NCCL INFO TUNER/Plugin: Plugin load returned 11 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
0: l50112:3633303:3633818 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
0: l50112:3633303:3633818 [0] NCCL INFO ncclCommInitRank comm 0x55555f0e7700 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0x6da1b54506a0fb95 - Init COMPLETE
1: l50145:2760187:2760426 [0] NCCL INFO TUNER/Plugin: Plugin load returned 11 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
1: l50145:2760187:2760426 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
1: l50145:2760187:2760426 [0] NCCL INFO ncclCommInitRank comm 0x55555ec9c560 rank 1 nranks 2 cudaDev 0 nvmlDev 0 busId 3000 commId 0x6da1b54506a0fb95 - Init COMPLETE
0: with_ddp : True
0: num_accs_per_task : 1
0: par_rank : 0
0: par_size : 2
0: fields : [['velocity_u', [1, 1024, ['velocity_v', 'temperature'], 0, ['j8dwr5qj', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_v', [1, 1024, ['velocity_u', 'temperature'], 0, ['0tlnm5up', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['specific_humidity', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['v63l01zu', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['velocity_z', [1, 1024, ['velocity_u', 'velocity_v', 'temperature'], 0, ['9l1errbo', -2]], [96, 105, 114, 123, 137], [12, 3, 6], [3, 18, 18], [0.5, 0.9, 0.2, 0.05]], ['temperature', [1, 1024, ['velocity_u', 'velocity_v', 'specific_humidity'], 0, ['7ojls62c', -2]], [96, 105, 114, 123, 137], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local'], ['total_precip', [1, 1024, ['velocity_u', 'velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 6, 12], [3, 9, 9], [0.25, 0.9, 0.1, 0.05]], ['t2m', [1, 1024, ['velocity_u', '
0: velocity_v', 'velocity_z', 'specific_humidity'], 0], [0], [12, 2, 4], [3, 27, 27], [0.5, 0.9, 0.2, 0.05], 'Local']]
0: fields_prediction : [['velocity_u', 0.125], ['velocity_v', 0.125], ['specific_humidity', 0.05], ['velocity_z', 0.01], ['temperature', 0.1], ['total_precip', 0.01], ['t2m', 0.58]]
0: fields_targets : []
0: years_train : [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
0: years_val : [2021]
0: month : None
0: geo_range_sampling : [[0.0, 360.0], [0.0, 360.0]]
0: time_sampling : 1
0: torch_seed : 5521420987310380410
0: batch_size_validation : 1
0: batch_size : 96
0: num_epochs : 128
0: num_samples_per_epoch : 480
0: num_samples_validate : 128
0: num_loader_workers : 5
0: size_token_info : 8
0: size_token_info_net : 16
0: grad_checkpointing : True
0: with_cls : False
0: with_mixed_precision : True
0: with_layernorm : True
0: coupling_num_heads_per_field : 1
0: dropout_rate : 0.05
0: with_qk_lnorm : True
0: encoder_num_layers : 6
0: encoder_num_heads : 16
0: encoder_num_mlp_layers : 2
0: encoder_att_type : dense
0: decoder_num_layers : 6
0: decoder_num_heads : 16
0: decoder_num_mlp_layers : 2
0: decoder_self_att : False
0: decoder_cross_att_ratio : 0.5
0: decoder_cross_att_rate : 1.0
0: decoder_att_type : dense
0: net_tail_num_nets : 16
0: net_tail_num_layers : 0
0: losses : ['mse_ensemble', 'stats']
0: optimizer_zero : False
0: lr_start : 1e-05
0: lr_max : 2e-05
0: lr_min : 1e-05
0: weight_decay : 0.025
0: lr_decay_rate : 1.025
0: lr_start_epochs : 3
0: model_log_frequency : 256
0: BERT_strategy : BERT
0: forecast_num_tokens : 2
0: BERT_fields_synced : False
0: BERT_mr_max : 2
0: log_test_num_ranks : 0
0: save_grads : False
0: profile : False
0: test_initial : False
0: attention : False
0: rng_seed : None
0: with_wandb : True
0: slurm_job_id : 18566550
0: wandb_id : d8pg8z6q
0: file_path : /work/ab1412/atmorep/data/era5_y2010_2020_res25_with_t2m.zarr
0: n_size : [36, 13.5, 27.0]
0: model_id : hjbmsjft
0: years_test : [2021]
1: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
1: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
1: self.lats : (721,)
1: self.lons : (1440,)
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
0: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
1: Available keys in the Zarr dataset: ['data', 'data_sfc', 'lats', 'lons', 'time']
0: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
0: self.lats : (721,)
0: self.lons : (1440,)
1: self.ds['data'] : (105192, 7, 5, 721, 1440) :: (105192,)
1: self.lats : (721,)
1: self.lons : (1440,)
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
1: ['cuda:0', 'cuda:1', 'cuda:2', 'cuda:3'] 0
0: Loaded model id = hjbmsjft.
0: Loaded run 'hjbmsjft' at epoch -2.
1: Loaded model id = hjbmsjft.
1: Loaded run 'hjbmsjft' at epoch -2.
1: -1 : 17:21:16 :: batch_size = 96, lr = 1e-05
0: Number of trainable parameters: 886,234,640
0: -1 : 17:21:16 :: batch_size = 96, lr = 1e-05
0: [DEBUG] TRAIN INPUT BATCH
0: Epoch -1, first input batch shapes / sample data:
0:   └─ Field: 'velocity_u' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
0:      first 25 values: tensor([ 2.1071e-02,  4.4909e-02,  5.0461e-02,  4.2460e-02,  2.3683e-02, -1.1095e-02, -6.7098e-02, -1.4025e-01,
0:         -2.2041e-01, -2.9764e-01, -3.6655e-01, -4.2614e-01, -4.7480e-01, -5.0680e-01, -5.1937e-01, -5.2117e-01,
0:         -5.3293e-01, -5.7032e-01, -2.1871e-02,  1.8043e-03,  7.1924e-03, -4.8162e-04, -2.0238e-02, -5.8608e-02,
0:         -1.1804e-01], device='cuda:0')
0:   └─ Field: 'velocity_v' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
0:      first 25 values: tensor([ 1.1904,  1.0709,  0.9406,  0.8053,  0.6729,  0.5452,  0.4231,  0.3114,  0.2171,  0.1433,  0.0917,  0.0615,
0:          0.0466,  0.0363,  0.0247,  0.0109, -0.0081, -0.0432,  1.1205,  0.9965,  0.8637,  0.7295,  0.5997,  0.4745,
0:          0.3544], device='cuda:0')
0:   └─ Field: 'specific_humidity' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
0:      first 25 values: tensor([ 0.0730, -0.0495,  0.0553, -0.0816, -0.0118, -0.1269,  0.1907, -0.0281,  0.2633,  0.0381, -0.0767, -0.0857,
0:          0.0350,  0.1442, -0.1453, -0.3086, -0.2025,  0.0561,  0.0751, -0.1367, -0.1329,  0.0479,  0.0936,  0.2244,
0:          0.0144], device='cuda:0')
0:   └─ Field: 'velocity_z' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
0:      first 25 values: tensor([0., 0., 0., 0., 0., 0., 0., -0., -0., 0., -0., -0., -0., 0., 0., -0., -0., 0., 0., 0., 0., 0., 0., 0., 0.],
0:        device='cuda:0')
0:   └─ Field: 'temperature' shape: torch.Size([96, 5, 12, 2, 4, 3, 27, 27])
0:      first 25 values: tensor([1.1297, 1.1671, 1.1888, 1.1992, 1.2064, 1.2146, 1.2231, 1.2314, 1.2423, 1.2560, 1.2698, 1.2834, 1.3006, 1.3245,
0:         1.3537, 1.3822, 1.4062, 1.4259, 1.4441, 1.4630, 1.4806, 1.4934, 1.4994, 1.5001, 1.4984], device='cuda:0')
0:   └─ Field: 'total_precip' shape: torch.Size([96, 1, 12, 6, 12, 3, 9, 9])
0:      first 25 values: tensor([-0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484,
0:         -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484,
0:         -0.2484], device='cuda:0')
0:   └─ Field: 't2m' shape: torch.Size([96, 1, 12, 2, 4, 3, 27, 27])
0:      first 25 values: tensor([1.9260, 1.8981, 1.8570, 1.8249, 1.7636, 1.7060, 1.6438, 1.6158, 1.5792, 1.6039, 1.6500, 1.6947, 1.7217, 1.7367,
0:         1.7823, 1.7672, 1.7867, 1.8326, 1.9227, 1.9481, 1.9595, 2.0020, 2.0288, 2.0664, 2.1082], device='cuda:0')
0: [DEBUG] TRAIN TARGET BATCH
0: Epoch -1, batch 0 - Sparse-masked 't2m' shape target data: torch.Size([2208, 2187])
0:     First 25 batch values:
0: tensor([0.7721, 0.8555, 1.0168, 1.1662, 1.1888, 1.2185, 1.1438, 1.1308, 1.0536, 0.9651, 0.8665, 0.8388, 0.8540, 0.8420,
0:         1.0252, 0.9920, 0.7578, 0.8556, 1.0415, 1.1153, 1.0574, 0.8962, 0.8884, 0.8451, 0.7224])
0: [DEBUG] TRAIN PREDICTIONS BATCH
0: Epoch -1, first predictions sample:
0:   └─ Predictions for 'velocity_u' shape: torch.Size([26784, 972])
0:      first 25 pred values: tensor([-1.2229, -1.1860, -1.1335, -1.0641, -0.9718, -0.8573, -0.7256, -0.5835, -0.4412, -0.3100, -0.1958, -0.0946,
0:         -0.0081,  0.0747,  0.1618,  0.2433,  0.3135,  0.3408, -1.2304, -1.1720, -1.0998, -1.0166, -0.9185, -0.8077,
0:         -0.6814], device='cuda:0', grad_fn=<SliceBackward0>)
0:   └─ Predictions for 'velocity_v' shape: torch.Size([25831, 972])
0:      first 25 pred values: tensor([-0.1553, -0.1394, -0.1428, -0.1601, -0.1851, -0.2109, -0.2317, -0.2482, -0.2584, -0.2643, -0.2653, -0.2606,
0:         -0.2473, -0.2274, -0.2004, -0.1712, -0.1430, -0.1179, -0.2639, -0.2215, -0.1984, -0.1917, -0.1972, -0.2118,
0:         -0.2259], device='cuda:0', grad_fn=<SliceBackward0>)
0:   └─ Predictions for 'specific_humidity' shape: torch.Size([26402, 972])
0:      first 25 pred values: tensor([-0.3035, -0.3103, -0.3134, -0.3172, -0.3182, -0.3187, -0.3187, -0.3198, -0.3256, -0.3362, -0.3548, -0.3834,
0:         -0.4182, -0.4607, -0.5033, -0.5436, -0.5799, -0.6075, -0.3066, -0.3179, -0.3291, -0.3375, -0.3452, -0.3519,
0:         -0.3575], device='cuda:0', grad_fn=<SliceBackward0>)
0:   └─ Predictions for 'velocity_z' shape: torch.Size([26811, 972])
0:      first 25 pred values: tensor([ 0.1045,  0.8828,  1.2325,  1.3296,  1.2966,  1.0502,  0.6546,  0.1525, -0.1046,  0.0021,  0.2257,  0.2708,
0:         -0.0560, -0.2099,  0.2493,  0.4349,  0.0715,  0.0306, -0.2104,  0.6792,  1.1037,  1.1501,  1.0311,  0.6909,
0:         -0.1170], device='cuda:0', grad_fn=<SliceBackward0>)
0:   └─ Predictions for 'temperature' shape: torch.Size([11580, 2187])
0:      first 25 pred values: tensor([1.0804, 1.0792, 1.0807, 1.0848, 1.0902, 1.0979, 1.1079, 1.1170, 1.1243, 1.1296, 1.1337, 1.1390, 1.1475, 1.1580,
0:         1.1636, 1.1627, 1.1535, 1.1375, 1.1205, 1.1058, 1.0942, 1.0862, 1.0789, 1.0699, 1.0594], device='cuda:0',
0:        grad_fn=<SliceBackward0>)
0:   └─ Predictions for 'total_precip' shape: torch.Size([10587, 243])
0:      first 25 pred values: tensor([-0.2426, -0.2362, -0.2250, -0.2041, -0.1600, -0.1003, -0.0155,  0.0550,  0.1221, -0.2356, -0.2321, -0.2299,
0:         -0.2007, -0.1565, -0.0860,  0.0119,  0.0956,  0.1609, -0.2467, -0.2391, -0.2281, -0.2022, -0.1491, -0.0795,
0:          0.0093], device='cuda:0', grad_fn=<SliceBackward0>)
0:   └─ Predictions for 't2m' shape: torch.Size([2208, 2187])
0:      first 25 pred values: tensor([0.7231, 0.7261, 0.7076, 0.7182, 0.7093, 0.6952, 0.6829, 0.7252, 0.7258, 0.7136, 0.7774, 0.7378, 0.7532, 0.7417,
0:         0.7190, 0.7206, 0.7234, 0.7657, 0.7777, 0.6229, 0.7394, 0.7554, 0.7366, 0.6847, 0.7423], device='cuda:0',
0:        grad_fn=<SliceBackward0>)
1: [DEBUG] TRAIN INPUT BATCH
1: Epoch -1, first input batch shapes / sample data:
1:   └─ Field: 'velocity_u' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
1:      first 25 values: tensor([ 0.0523,  0.0643,  0.0793, -0.0028, -0.0668, -0.0409, -0.0539, -0.1341, -0.0262,  0.0090,  0.0228, -0.0063,
1:         -0.1216, -0.1464, -0.1668, -0.0144,  0.2009,  0.1015, -0.1603,  0.0594, -0.1596,  0.0008,  0.0696,  0.0538,
1:         -0.0767], device='cuda:0')
1:   └─ Field: 'velocity_v' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
1:      first 25 values: tensor([ 0.5547,  0.1902,  0.4280,  0.2063,  0.1164,  0.1669, -0.0027,  0.0574,  0.0894,  0.1146, -0.0532, -0.0589,
1:          0.0435,  0.2072,  0.0489, -0.0014,  0.0168, -0.0161,  0.2508,  0.3655,  0.2836,  0.1978,  0.3523,  0.1459,
1:          0.2214], device='cuda:0')
1:   └─ Field: 'specific_humidity' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
1:      first 25 values: tensor([-0.0364,  0.1671, -0.2959, -0.0654,  0.0327, -0.0813,  0.0532,  0.1019,  0.1068,  0.0344,  0.2494, -0.0336,
1:         -0.0706,  0.0423, -0.0073, -0.0780, -0.1194, -0.0518, -0.0291,  0.0152, -0.0140, -0.2015,  0.0535, -0.0249,
1:         -0.0156], device='cuda:0')
1:   └─ Field: 'velocity_z' shape: torch.Size([96, 5, 12, 3, 6, 3, 18, 18])
1:      first 25 values: tensor([-1.3503, -1.0843, -0.8842, -0.6292, -0.2643,  0.1556,  0.5140,  0.7074,  0.6832,  0.4634,  0.1380, -0.1763,
1:         -0.3676, -0.3500, -0.1346,  0.1336,  0.2699,  0.1974, -1.3459, -1.0689, -0.8557, -0.5875, -0.2049,  0.2194,
1:          0.5579], device='cuda:0')
1:   └─ Field: 'temperature' shape: torch.Size([96, 5, 12, 2, 4, 3, 27, 27])
1:      first 25 values: tensor([1.1297, 1.1671, 1.1888, 1.1992, 1.2064, 1.2146, 1.2231, 1.2314, 1.2423, 1.2560, 1.2698, 1.2834, 1.3006, 1.3245,
1:         1.3537, 1.3822, 1.4062, 1.4259, 1.4441, 1.4630, 1.4806, 1.4934, 1.4994, 1.5001, 1.4984], device='cuda:0')
1:   └─ Field: 'total_precip' shape: torch.Size([96, 1, 12, 6, 12, 3, 9, 9])
1:      first 25 values: tensor([-0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484,
1:         -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484, -0.2484,
1:         -0.2484], device='cuda:0')
1:   └─ Field: 't2m' shape: torch.Size([96, 1, 12, 2, 4, 3, 27, 27])
1:      first 25 values: tensor([ 0.2085, -0.1808,  0.0882,  0.0331,  0.1252,  0.0875,  0.1210,  0.0812,  0.2535,  0.0388,  0.0911,  0.0552,
1:         -0.2288,  0.0175, -0.1781,  0.0029,  0.0081, -0.1590, -0.0049, -0.0360,  0.1388,  0.0443, -0.0276,  0.0483,
1:          0.0696], device='cuda:0')
1: [DEBUG] TRAIN TARGET BATCH
1: Epoch -1, batch 0 - Sparse-masked 't2m' shape target data: torch.Size([2204, 2187])
1:     First 25 batch values:
1: tensor([0.9931, 1.0702, 1.1738, 1.0104, 1.0259, 1.0381, 1.1448, 1.1907, 1.1890, 1.1481, 1.0346, 1.0953, 1.1202, 1.1112,
1:         0.9982, 1.0068, 1.3680, 1.5019, 1.6042, 1.6124, 1.5673, 1.4924, 1.4085, 1.3110, 1.2283])
1: [DEBUG] TRAIN PREDICTIONS BATCH
1: Epoch -1, first predictions sample:
1:   └─ Predictions for 'velocity_u' shape: torch.Size([26157, 972])
1:      first 25 pred values: tensor([-1.2008, -1.1588, -1.1150, -1.0900, -1.0790, -1.0797, -1.0909, -1.1079, -1.1314, -1.1641, -1.2039, -1.2457,
1:         -1.2876, -1.3270, -1.3731, -1.4309, -1.4944, -1.5607, -1.1777, -1.1377, -1.0962, -1.0741, -1.0670, -1.0748,
1:         -1.0887], device='cuda:0', grad_fn=<SliceBackward0>)
1:   └─ Predictions for 'velocity_v' shape: torch.Size([25616, 972])
1:      first 25 pred values: tensor([1.0928, 1.0144, 0.9428, 0.8801, 0.8221, 0.7693, 0.7267, 0.6917, 0.6632, 0.6339, 0.6063, 0.5713, 0.5394, 0.5148,
1:         0.5008, 0.4990, 0.5001, 0.5027, 1.0279, 0.9547, 0.8894, 0.8324, 0.7755, 0.7251, 0.6821], device='cuda:0',
1:        grad_fn=<SliceBackward0>)
1:   └─ Predictions for 'specific_humidity' shape: torch.Size([26510, 972])
1:      first 25 pred values: tensor([-0.3302, -0.3400, -0.3525, -0.3653, -0.3779, -0.3898, -0.4026, -0.4152, -0.4294, -0.4442, -0.4588, -0.4701,
1:         -0.4785, -0.4880, -0.4992, -0.5136, -0.5278, -0.5325, -0.2736, -0.2777, -0.2862, -0.2995, -0.3169, -0.3379,
1:         -0.3575], device='cuda:0', grad_fn=<SliceBackward0>)
1:   └─ Predictions for 'velocity_z' shape: torch.Size([26142, 972])
1:      first 25 pred values: tensor([-0.7692, -0.8696, -0.8176, -0.6105, -0.5141, -0.5228, -0.5188, -0.5229, -0.4432, -0.3500, -0.2825, -0.1294,
1:          0.0097,  0.0414,  0.1072,  0.1642,  0.0940, -0.0302, -0.3619, -0.3737, -0.2711, -0.1602, -0.0995, -0.0314,
1:          0.0128], device='cuda:0', grad_fn=<SliceBackward0>)
1:   └─ Predictions for 'temperature' shape: torch.Size([11521, 2187])
1:      first 25 pred values: tensor([ 0.2195,  0.2005,  0.1633,  0.1088,  0.0460, -0.0119, -0.0589, -0.0946, -0.1273, -0.1643, -0.2092, -0.2592,
1:         -0.3080, -0.3503, -0.3808, -0.4000, -0.4071, -0.4028, -0.3899, -0.3722, -0.3540, -0.3373, -0.3253, -0.3183,
1:         -0.3149], device='cuda:0', grad_fn=<SliceBackward0>)
1:   └─ Predictions for 'total_precip' shape: torch.Size([10381, 243])
1:      first 25 pred values: tensor([ 1.1350,  1.1232,  1.0595,  0.9725,  0.8951,  0.8020,  0.7087,  0.6110,  0.5382,  0.6049,  0.5678,  0.5109,
1:          0.4522,  0.3831,  0.3236,  0.2734,  0.2487,  0.2310,  0.0682,  0.0461,  0.0358, -0.0039, -0.0312, -0.0573,
1:         -0.0631], device='cuda:0', grad_fn=<SliceBackward0>)
1:   └─ Predictions for 't2m' shape: torch.Size([2204, 2187])
1:      first 25 pred values: tensor([0.8134, 0.8348, 0.7634, 0.8561, 0.8237, 0.8133, 0.8499, 0.8479, 0.7637, 0.8373, 0.8643, 0.8464, 0.8469, 0.8382,
1:         0.8224, 0.8215, 0.8145, 0.8599, 0.8310, 0.7757, 0.8174, 0.8566, 0.7760, 0.7783, 0.7372], device='cuda:0',
1:        grad_fn=<SliceBackward0>)
0: epoch: -1 [1/5 (20%)]	Loss: 0.51399 : 0.12506 :: 0.07423 (1.39 s/sec)
0: epoch: -1 [2/5 (40%)]	Loss: 0.54962 : 0.12282 :: 0.07006 (8.15 s/sec)
0: epoch: -1 [3/5 (60%)]	Loss: 0.53936 : 0.14835 :: 0.07366 (8.14 s/sec)
1: > /work/ab1412/atmorep/pyenv/lib/python3.10/site-packages/torch/autograd/graph.py(825)_engine_run_backward()
1: -> return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
1: (Pdb) 
1: l50145:2760187:2760429 [0] NCCL INFO [Service thread] Connection closed by localRank 0
1: l50145:2760187:2760887 [0] NCCL INFO comm 0x55555ec9c560 rank 1 nranks 2 cudaDev 0 busId 3000 - Abort COMPLETE
